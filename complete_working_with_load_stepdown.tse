version = 4.2

//
// Saved by sw version: 2023.2
//

model "complete_working_with_load_stepdown" {
    configuration {
        hil_device = "VHIL+"
        hil_configuration_id = 1
        simulation_method = exact
        simulation_time_step = 1e-6
        simulation_discret_scaling = 1.0
        dsp_timer_periods = 100e-6, 50e-3
        ss_calc_method = "systematic elimination"
        enb_pole_shift = True
        enb_gds_oversampling = True
        show_modes = False
        device_ao_limit_enable = False
        reset_analog_outputs_on_sim_stop = True
        reset_digital_outputs_on_sim_stop = True
        vhil_adio_loopback = False
        cpl_stb = True
        enb_dep_sw_detect = False
        code_section = "internal memory"
        data_section = "internal memory"
        sys_sp_rate_1 = 0.0001
        sys_sp_rate_2 = 0.05
        sys_real_type_precision = "default"
        user_real_type_precision = "default"
        sys_cpu_optimization = "high"
        user_cpu_optimization = "high"
        user_cpu_part_option = "default"
        matrix_based_reduction = True
        cpl_dynamics_analysis = False
        export_ss_to_pickle = False
        ground_scope_core = False
        dss_num_tol = 1e-15
        cce_platform = "generic"
        cce_use_relative_names = False
        cce_type_mapping_real = "double"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_directory = ""
        cce_custom_type_int = ""
        cce_custom_type_uint = ""
        cce_custom_type_real = ""
        tunable_params = "component defined"
        sp_compiler_type = "C compiler"
        sig_stim = "off"
        export_resource_list = ""
        export_dependency_list = ""
        excluded_resource_list = ""
        export_out_file = ""
        export_lock_top_level = True
        export_encrypt_library = True
        export_encrypt_resources = True
    }

    component Subsystem Root {
        component "core/Three Phase Two Winding Transformer" Tr3 {
            Sn = "1e6"
            V1 = "339"
            V2 = "5000"
            core_model = "Lm/Rm neglected"
            input = "pu"
            l1 = "0.48e-3"
            l2 = "0.48e-3"
            lm = "156.68213162985495"
            r1 = "1e-5"
            r2 = "1e-5"
            rm = "347.82608695652175"
            winding_1_connection = "D"
            winding_2_connection = "D"
        }
        [
            position = 8016, 6496
            size = 126, 256
        ]

        component "core/Ground" gnd17 {
        }
        [
            position = 9336, 6624
        ]

        component "core/Ground" gnd18 {
        }
        [
            position = 8464, 6632
        ]

        component "core/Transmission Line" "Transmission Line2" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "25"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 8464, 6496
            size = 256, 72
        ]

        component "core/Transmission Line" "Transmission Line3" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "10"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 9344, 6496
            size = 256, 72
        ]

        component "core/Three-phase Meter" "Three-phase at load 7 (area 1)" {
            I_rms = "True"
            P_meas = "True"
            P_method = "RMS based"
            VAB = "True"
            VBC = "True"
            VCA = "True"
            VLL_rms = "True"
            VLn_rms = "True"
            freq = "True"
        }
        [
            position = 9704, 6496
            size = 56, 240
        ]

        component "core/Ground" gnd24 {
        }
        [
            position = 9704, 6704
        ]

        component "core/Parallel RLC Branch" "Parallel RLC Branch1" {
            capacitance = "C_fil1"
            inductance = "L_fil1"
            resistance = "5"
        }
        [
            position = 10104, 6744
            rotation = right
            size = 128, 256
        ]

        component "core/Ground" gnd26 {
        }
        [
            position = 10104, 6928
        ]

        component "core/Voltage Measurement" Vabat6 {
        }
        [
            position = 8672, 6400
            size = 64, 32
        ]

        component "core/Three-phase Meter" "Voltage gen 1" {
            VAB = "True"
            VBC = "True"
            VCA = "True"
        }
        [
            position = 7728, 6496
            scale = -1, 1
            size = 56, 240
        ]

        component "core/Ground" gnd1 {
        }
        [
            position = 7728, 6696
        ]

        component Subsystem DG_in {
            layout = dynamic
            component "core/SCADA Input" pf_ref {
                execution_rate = "Ts"
                unit = ""
            }
            [
                position = 8120, 8112
            ]

            component "core/SCADA Input" Gen_OP_mode {
                def_value = "1"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8144
            ]

            component "core/SCADA Input" Gen_On {
                addr = "1427111952"
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 7992
            ]

            component "core/SCADA Input" Load_share {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8112, 8312
            ]

            component "core/SCADA Input" wref {
                addr = "1427111952"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8120, 8056
            ]

            component "core/Bus Join" "Bus Join2" {
                inputs = "9"
            }
            [
                position = 8272, 8392
                rotation = right
                hide_name = True
            ]

            component "core/SCADA Input" Vref {
                addr = "1427111940"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = "pu"
            }
            [
                position = 8160, 8016
            ]

            component "core/SCADA Input" Gen_Control_Mode {
                addr = "1427111944"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 8200
            ]

            component "core/SCADA Input" Pref {
                addr = "1427111936"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8160, 8080
            ]

            component "core/SCADA Input" Load_share_on {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8256
            ]

            port inputs {
                position = right:1
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8272, 8464
                rotation = right
                hide_name = True
            ]

            connect "Bus Join2.out" inputs as Connection828
            connect Gen_Control_Mode.out "Bus Join2.in6" as Connection235
            connect Gen_OP_mode.out "Bus Join2.in5" as Connection565
            connect Gen_On.out "Bus Join2.in" as Connection230
            connect Load_share.out "Bus Join2.in8" as Connection826
            connect Load_share_on.out "Bus Join2.in7" as Connection825
            connect Pref.out "Bus Join2.in3" as Connection233
            connect Vref.out "Bus Join2.in1" as Connection231
            connect pf_ref.out "Bus Join2.in4" as Connection827
            connect wref.out "Bus Join2.in2" as Connection232

            Ts = "Ts"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Scada inputs for the Diesel Genset from the Microgrid Library.</p></body></html>"

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 7216, 6304
            rotation = right
            scale = -1, 1
            size = 48, 48
        ]

        component Subsystem Diesel_Gen1 {
            layout = static
            component "core/Signal Controlled Voltage Source" Vfd {
            }
            [
                position = 8672, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" If {
            }
            [
                position = 8736, 8240
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vfield {
            }
            [
                position = 8800, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Triple Pole Single Throw Contactor" MCB {
                ctrl_src = "Model"
            }
            [
                position = 9448, 8320
                scale = -1, 1
                size = 64, 256
            ]

            component "core/Three Phase Wound Rotor Synchronous Machine" Gen {
                Jm = "J"
                Llfd = "Llfd_prime"
                Llkd = "Llkd"
                Llkq = "Llkq"
                Lls = "Lls"
                Lmd = "Lmd"
                Lmq = "Lmq"
                Ns_div_Nfd = "Ns_Nfd"
                Ns_div_Nkd = "Ns_Nkd"
                Ns_div_Nkq = "Ns_Nkq"
                Rf = "Rf_prime"
                Rkd = "Rkd"
                Rkq = "Rkq"
                Rs = "Rs"
                el_torque_out_addr = "8200"
                el_trq_out = "True"
                execution_rate = "Ts"
                friction_coeff = "F"
                load_src = "Model"
                me_speed_out_addr = "8202"
                mech_speed_out = "True"
                pms = "pms"
                res_int_carr_f = "5000.0"
            }
            [
                position = 8984, 8320
                scale = -1, 1
                size = 176, 160
            ]

            component Subsystem Control {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "5"
                }
                [
                    position = 8456, 8192
                    rotation = left
                    hide_name = True
                ]

                component "core/Unit Delay" "Unit Delay2" {
                    execution_rate = "Ts"
                }
                [
                    position = 7920, 8104
                    hide_name = True
                ]

                component "core/Digital Probe" Exciter_on {
                }
                [
                    position = 7800, 7664
                    rotation = left
                ]

                component "core/Unit Delay" "Unit Delay1" {
                }
                [
                    position = 7208, 7696
                    hide_name = True
                ]

                component "core/Probe" Vf {
                    addr = "8978"
                    execution_rate = "Ts"
                }
                [
                    position = 8224, 7768
                    rotation = left
                ]

                component "core/Termination" Termination1 {
                }
                [
                    position = 7384, 8280
                    hide_name = True
                ]

                component "core/Digital Probe" StandBy {
                }
                [
                    position = 7416, 7888
                ]

                component "core/Digital Probe" GridForming {
                }
                [
                    position = 7416, 7952
                ]

                component "core/Unit Delay" "Unit Delay3" {
                    execution_rate = "Ts"
                }
                [
                    position = 8024, 7664
                    hide_name = True
                ]

                component "core/Round" Round1 {
                    round_fn = "round"
                }
                [
                    position = 7208, 7656
                    hide_name = True
                ]

                component "core/Bus Split" "Bus Split2" {
                    outputs = "3"
                }
                [
                    position = 6952, 7856
                    hide_name = True
                ]

                component "core/Digital Probe" GridFollowing {
                }
                [
                    position = 7504, 7928
                ]

                component "core/Bus Split" "Bus Split3" {
                    outputs = "9"
                }
                [
                    position = 6952, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" T {
                }
                [
                    position = 8128, 8184
                    rotation = left
                ]

                component "core/Digital Probe" Gen_On {
                }
                [
                    position = 7120, 8064
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "4"
                }
                [
                    position = 7296, 8104
                    rotation = right
                    hide_name = True
                ]

                component Subsystem check_steady_state_w {
                    layout = dynamic
                    component "core/Gain" speed_diff {
                        gain = "delta_wn/100.0"
                    }
                    [
                        position = 8232, 8208
                    ]

                    component "core/Abs" Abs1 {
                    }
                    [
                        position = 8280, 8160
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator3 {
                    }
                    [
                        position = 8360, 8200
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 8208, 8160
                        hide_name = True
                    ]

                    component "core/Constant" Constant3 {
                        execution_rate = "Ts"
                        value = "2.0*np.pi*f/pms"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    port ss_speed {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8424, 8200
                    ]

                    port w_meas {
                        position = left:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8096, 8152
                    ]

                    junction Junction9 sp
                    [
                        position = 8168, 8208
                    ]

                    connect Abs1.in Sum3.out as Connection5
                    connect Comparator3.in2 Abs1.out as Connection13
                    connect Comparator3.out ss_speed as Connection58
                    connect Constant3.out Junction9 as Connection16
                    connect Junction9 speed_diff.in as Connection39
                    connect Sum3.in1 Junction9 as Connection54
                    connect speed_diff.out Comparator3.in1 as Connection57
                    connect w_meas Sum3.in as Connection59
                }
                [
                    position = 7968, 8440
                    size = 96, 48
                ]

                component Subsystem Governor_and_Engine {
                    layout = dynamic
                    component "core/Signal switch" w_switch1 {
                    }
                    [
                        position = 7832, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum4 {
                        signs = "+--"
                    }
                    [
                        position = 7920, 8000
                        hide_name = True
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "inner_w_fall"
                        rising_limit = "inner_w_rise"
                    }
                    [
                        position = 7568, 7944
                        hide_name = True
                    ]

                    component "core/Probe" wmeas {
                        addr = "8977"
                    }
                    [
                        position = 7832, 8080
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 7352, 7960
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1/Sb"
                    }
                    [
                        position = 7576, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum5 {
                        signs = "3"
                    }
                    [
                        position = 7704, 7984
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7728, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 7496, 7944
                        hide_name = True
                    ]

                    component "core/Gain" "Tpu to T" {
                        execution_rate = "Ts"
                        gain = "-Sb*pms/(2*np.pi*f)"
                    }
                    [
                        position = 8200, 8000
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 7672, 8200
                        hide_name = True
                    ]

                    component "core/Probe" Inner_droop_dw {
                        addr = "8977"
                    }
                    [
                        position = 7936, 8080
                    ]

                    component "core/Probe" wref {
                        addr = "8977"
                    }
                    [
                        position = 7768, 7936
                        rotation = left
                    ]

                    component "core/Constant" Inner_w_droop {
                        execution_rate = "Ts"
                        value = "inner_w_droop"
                    }
                    [
                        position = 7528, 8232
                    ]

                    component Subsystem DEGOV {
                        layout = dynamic
                        component "core/Gain" Kp {
                            gain = "gov_Kp"
                        }
                        [
                            position = 8040, 8160
                        ]

                        component "core/Gain" K {
                            gain = "K"
                        }
                        [
                            position = 8112, 8160
                        ]

                        component "core/Transport Delay" "Transport Delay1" {
                            init_value = "Pm0"
                            time_delay = "Td"
                        }
                        [
                            position = 8392, 8160
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[T5*T6,T5+T6,1]"
                            b_coeff = "[T4,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8176, 8160
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[T1*T2,T1,1]"
                            b_coeff = "[T3,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7960, 8160
                        ]

                        component Subsystem Integrator {
                            layout = dynamic
                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8304
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Tmin"
                                upper_limit = "Tmax"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8216
                                hide_name = True
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "Pm0"
                                limit_lower = "phase_lowLim"
                                limit_upper = "phase_upLim"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                                gain = "1000"
                            }
                            [
                                position = 8216, 8304
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8256
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7968, 8208
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 8368, 8224
                            ]

                            connect In Sum7.in as Connection58
                            connect Integrator1.reset Reset as Connection2
                            connect Junction3 Out as Connection48
                            connect Junction4 Integrator1.out as Connection65
                            connect Junction4 Sum6.in as Connection56
                            connect Kb.in Sum6.out as Connection50
                            connect Limit1.out Junction3 as Connection66
                            connect Limit1.in Junction4 as Connection55
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8264, 8160
                            size = 64, 48
                        ]

                        port T {
                            label = "T"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8488, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8208, 8104
                        ]

                        port w_bias {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7832, 8160
                        ]

                        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Engine</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8368, 8192
                        ]

                        comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Actuator:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">          K (1 + sT4)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">   s(1 + sT5)(1 + sT6)</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8128, 8208
                        ]

                        comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Electric Control Box:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">           (1 + sT3)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">  1 + sT1 + (s^2)T1T2</span></p></body></html> ENDCOMMENT 
                        [
                            position = 7872, 8208
                        ]

                        connect Integrator.In TF2.out as Connection31
                        connect Integrator.Out "Transport Delay1.in" as Connection32
                        connect Kp.out K.in as Connection35
                        connect TF1.out Kp.in as Connection36
                        connect TF2.in K.out as Connection27
                        connect "Transport Delay1.out" T as Connection28
                        connect reset Integrator.Reset as Connection33
                        connect w_bias TF1.in as Connection34
                    }
                    [
                        position = 8072, 8000
                        size = 120, 64
                    ]

                    port w_meas_in {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7656, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    port T_out {
                        label = "T_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8264, 8000
                    ]

                    port "Gen On" {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7448, 7872
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_meas {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7504, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_bias {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7592, 7984
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7784, 8160
                        rotation = down
                        scale = -1, 1
                    ]

                    port dw_synch {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7632, 8000
                    ]

                    port w_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7432, 7928
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7752, 8232
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7440, 7984
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction9 sp
                    [
                        position = 7496, 7872
                    ]

                    junction Junction10 sp
                    [
                        position = 7768, 7984
                    ]

                    junction Junction12 sp
                    [
                        position = 7392, 7960
                    ]

                    junction Junction13 sp
                    [
                        position = 7784, 8080
                    ]

                    junction Junction14 sp
                    [
                        position = 7880, 8080
                    ]

                    connect DEGOV.T "Tpu to T.in" as Connection720
                    connect From1 w_switch1.in1 as Connection695
                    connect GCB_status w_switch1.in2 as Connection691
                    connect "Gen On" Junction9 as Connection678
                    connect Inner_w_droop.out Product1.in1 as Connection764
                    connect Junction10 Sum4.in as Connection684
                    connect Junction12 Goto1 as Connection699
                    connect Junction12 w_switch.in1 as Connection693
                    connect Junction13 wmeas.in as Connection755
                    connect Junction14 Inner_droop_dw.in as Connection758
                    connect Junction9 DEGOV.reset as Connection679
                    connect Product1.in to_pu.out as Connection618
                    connect Product1.out w_switch1.in as Connection712
                    connect Sum4.out DEGOV.w_bias as Connection742
                    connect Sum4.in1 Junction13 as Connection756
                    connect Sum4.in2 Junction14 as Connection759
                    connect Sum5.out Junction10 as Connection683
                    connect "Tpu to T.out" T_out as Connection30
                    connect dw_synch Sum5.in2 as Connection701
                    connect to_pu.in P_meas as Connection619
                    connect "w to wpu.out" Junction13 as Connection754
                    connect "w to wpu.in" w_meas_in as Connection166
                    connect w_bias Sum5.in1 as Connection700
                    connect w_ramp.out Sum5.in as Connection762
                    connect w_ramp.in w_switch.out as Connection761
                    connect w_ref w_switch.in as Connection763
                    connect w_switch.in2 Junction9 as Connection680
                    connect w_switch1.out Junction14 as Connection757
                    connect wref.in Junction10 as Connection685
                    connect zero.out Junction12 as Connection692
                }
                [
                    position = 8016, 8232
                    size = 184, 208
                ]

                component Subsystem Read_Control_mode {
                    layout = dynamic
                    component "core/Digital Probe" PV_mode {
                    }
                    [
                        position = 8264, 8192
                    ]

                    component "core/C function" State {
                        init_fnc = "/*Begin code section*/
Vf = 0;
PV = 0;
PQ = 0;
/*End code section*/"
                        input_terminals = "real enable;inherit P;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;False;"
                        output_fnc = "/*Begin code section*/
if(enable && P && Q){
    Vf = 0;
    PV = 0;
    PQ = 1;
}
else{
    if(enable && P){
        Vf = 0;
        PV = 1;
        PQ = 0;
    }
    else{
        Vf = 1;
        PV = 0;
        PQ = 0;
    }
}
/*End code section*/"
                        output_terminals = "real Vf;inherit PV;inherit PQ;"
                        output_terminals_dimensions = "inherit;inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;False;"
                    }
                    [
                        position = 8144, 8192
                        size = 56, 168
                    ]

                    component "core/Digital Probe" Vf_mode {
                    }
                    [
                        position = 8264, 8128
                    ]

                    component "core/Digital Probe" PQ_mode {
                    }
                    [
                        position = 8264, 8256
                    ]

                    port Enable_outer_loop {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8128
                    ]

                    port P_control_mode {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8192
                    ]

                    port Q_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8256
                    ]

                    connect Enable_outer_loop State.enable as Connection1
                    connect PV_mode.in State.PV as Connection4
                    connect State.PQ PQ_mode.in as Connection6
                    connect State.P P_control_mode as Connection2
                    connect State.Q Q_control_mode as Connection3
                    connect State.Vf Vf_mode.in as Connection5
                }
                [
                    position = 7728, 8448
                    size = 96, 96
                ]

                component Subsystem Start_Exciter {
                    layout = dynamic
                    component "core/Gain" Exciter_start_speed {
                        gain = "exc_dwn/100.0"
                    }
                    [
                        position = 8152, 8248
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8312, 8144
                        hide_name = True
                    ]

                    component "core/Constant" steadyState_w {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8032, 8248
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1.0/(2*np.pi*f/pms)"
                    }
                    [
                        position = 8152, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8224, 8200
                        hide_name = True
                    ]

                    port w_meas {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8192
                    ]

                    port Gen_On {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8136
                    ]

                    port Start {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8144
                    ]

                    connect Comparator1.out and.in1 as Connection73
                    connect Comparator1.in1 "w to wpu.out" as Connection2
                    connect Exciter_start_speed.out Comparator1.in2 as Connection5
                    connect and.in Gen_On as Connection74
                    connect and.out Start as Connection76
                    connect steadyState_w.out Exciter_start_speed.in as Connection56
                    connect "w to wpu.in" w_meas as Connection75
                }
                [
                    position = 7704, 7704
                    size = 104, 64
                ]

                component Subsystem Exciter {
                    layout = dynamic
                    component "core/Gain" one_ov_sqrt_3 {
                        execution_rate = "Ts"
                        gain = "1.0/(3.0**0.5)"
                    }
                    [
                        position = 8032, 8432
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" Vt_to_Vtpu {
                        execution_rate = "Ts"
                        gain = "1.0/(Vn*((2.0/3.0)**0.5))"
                    }
                    [
                        position = 8304, 8248
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8568, 8200
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 8032, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum2 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8184, 8208
                        hide_name = True
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                        value = "1.0"
                    }
                    [
                        position = 8448, 8104
                    ]

                    component "core/Gain" Vfpu_to_Vf {
                        execution_rate = "Ts"
                        gain = "Vn*((2.0/3.0)**0.5)/Ns_Nfd"
                    }
                    [
                        position = 8648, 8200
                    ]

                    component "core/Sum" Sum1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8264, 8104
                        hide_name = True
                    ]

                    component "core/Probe" Vt {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8304
                        rotation = right
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8112, 8272
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Constant" Zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 7680, 8168
                        hide_name = True
                    ]

                    component "core/Probe" V_ref {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8072, 8160
                        rotation = left
                    ]

                    component "core/Signal switch" switch {
                    }
                    [
                        position = 7752, 8184
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" Vpss {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8176, 8128
                    ]

                    component "core/Sum" Sum {
                        execution_rate = "Ts"
                        signs = "3"
                    }
                    [
                        position = 8016, 8200
                        hide_name = True
                    ]

                    component "core/Constant" Const {
                        execution_rate = "Ts"
                        value = "Vf0/Ka"
                    }
                    [
                        position = 8176, 8072
                    ]

                    component "core/Constant" V_inner_droop {
                        execution_rate = "Ts"
                        value = "V_inner_droop"
                    }
                    [
                        position = 7928, 8432
                    ]

                    component "core/Rate Limiter" "Rate Limit" {
                        falling_limit = "V_fall"
                        rising_limit = "V_rise"
                    }
                    [
                        position = 7816, 8184
                        hide_name = True
                    ]

                    component Subsystem DC4B {
                        layout = dynamic
                        component "core/Signal switch" switch {
                        }
                        [
                            position = 8000, 8256
                            hide_name = True
                            scale = 1, -1
                        ]

                        component "core/Product" Product1 {
                        }
                        [
                            position = 8200, 8160
                            hide_name = True
                        ]

                        component "core/Gain" Kf {
                            gain = "Kf"
                        }
                        [
                            position = 8424, 8032
                            scale = -1, 1
                        ]

                        component "core/Discrete Transfer Function" TF4 {
                            a_coeff = "[Tf,1]"
                            b_coeff = "[1,0]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8032
                            scale = -1, 1
                        ]

                        component "core/Gain" KA {
                            gain = "Ka"
                        }
                        [
                            position = 8304, 8160
                        ]

                        component "core/Sum" Sum2 {
                            signs = "-+"
                        }
                        [
                            position = 8000, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF3 {
                            a_coeff = "[Te,Ke]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8552, 8168
                        ]

                        component "core/Constant" One {
                            execution_rate = "Ts"
                        }
                        [
                            position = 7872, 8272
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[Ta,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 8160
                        ]

                        component "core/C function" "Variable Limit" {
                            init_fnc = "/*Begin code section*/
LimitChange = 0;
out = 0;
/*End code section*/"
                            input_terminals = "inherit in;inherit LimitChange;"
                            input_terminals_dimensions = "inherit;inherit"
                            input_terminals_feedthrough = "[u\'\']"
                            input_terminals_show_labels = "True;True;"
                            output_fnc = "/*Begin code section*/
if(LimitChange == 0.0){
    LimitChange = 0.01;
}

if(in>=Vrmax*LimitChange){
    out = Vrmax*LimitChange;
}
else{
    if(in<=Vrmin*LimitChange){
        out = Vrmin*LimitChange;
    }
    else{
        out = in;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[u\'\']"
                            output_terminals_show_labels = "True;"
                            parameters = "real Vrmax;real Vrmin;"
                        }
                        [
                            position = 8464, 8168
                            size = 0, 0
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[Tr,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7768, 8216
                        ]

                        component "core/Sum" Sum1 {
                            signs = "++-"
                        }
                        [
                            position = 7896, 8160
                            hide_name = True
                        ]

                        component "core/Probe" Va {
                        }
                        [
                            position = 8288, 8096
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8312
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Integrator" Integrator1 {
                                limit_lower = "[\'-inf\']"
                                limit_upper = "[\'inf\']"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8232
                                hide_name = True
                            ]

                            component "core/Gain" Kp {
                                gain = "exc_Kp"
                            }
                            [
                                position = 7992, 8152
                            ]

                            component "core/Gain" Ki {
                                gain = "exc_Ki"
                            }
                            [
                                position = 7992, 8216
                            ]

                            component "core/Sum" Sum5 {
                            }
                            [
                                position = 8320, 8224
                                hide_name = True
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Vrmin/Ka"
                                upper_limit = "Vrmax/Ka"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8216, 8312
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8264
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7824, 8184
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8368, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 7928, 8184
                            ]

                            connect Integrator1.reset Reset as Connection2
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction4 In as Connection57
                            connect Kb.in Sum6.out as Connection50
                            connect Ki.in Junction4 as Connection56
                            connect Ki.out Sum7.in as Connection54
                            connect Kp.in Junction4 as Connection58
                            connect Kp.out Sum5.in as Connection59
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.in1 Integrator1.out as Connection5
                            connect Sum5.out Junction2 as Connection44
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8104, 8152
                            size = 64, 48
                        ]

                        port Vfd {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8672, 8168
                        ]

                        port Vref {
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8048, 8088
                        ]

                        port Vpss {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8104
                        ]

                        port Vt {
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8216
                        ]

                        port Linearize {
                            position = top:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8320
                        ]

                        junction Junction6 sp
                        [
                            position = 8248, 8160
                        ]

                        junction Junction10 sp
                        [
                            position = 8160, 8256
                        ]

                        junction Junction13 sp
                        [
                            position = 7816, 8216
                        ]

                        junction Junction14 sp
                        [
                            position = 8608, 8168
                        ]

                        connect Junction10 Product1.in1 as Connection102
                        connect Junction13 Sum1.in2 as Connection114
                        connect Junction14 Vfd as Connection126
                        connect Junction6 KA.in as Connection77
                        connect Kf.in Junction14 as Connection128
                        connect Linearize switch.in2 as Connection74
                        connect One.out switch.in as Connection75
                        connect PI.In Sum2.out as Connection48
                        connect Product1.out Junction6 as Connection76
                        connect Product1.in PI.Out as Connection49
                        connect Sum2.in1 Sum1.out as Connection5
                        connect TF1.out Junction13 as Connection113
                        connect TF2.in KA.out as Connection10
                        connect TF3.out Junction14 as Connection125
                        connect TF3.in "Variable Limit.out" as Connection118
                        connect TF4.in Kf.out as Connection127
                        connect TF4.out Sum2.in as Connection123
                        connect Va.in Junction6 as Connection78
                        connect "Variable Limit.LimitChange" Junction10 as Connection103
                        connect "Variable Limit.in" TF2.out as Connection89
                        connect Vpss Sum1.in as Connection45
                        connect Vref Sum1.in1 as Connection46
                        connect Vt TF1.in as Connection112
                        connect reset PI.Reset as Connection117
                        connect switch.out Junction10 as Connection101
                        connect switch.in1 Junction13 as Connection115

                        Ka = "Ka"
                        Ke = "Ke"
                        Kf = "Kf"
                        Ta = "Ta"
                        Te = "Te"
                        Tf = "Tf"
                        Tr = "Tr"
                        Vf0 = "Vf0"
                        Vfmax = "Efmax"
                        Vfmin = "Efmin"
                        Vrmax = "Vrmax"
                        Vrmin = "Vrmin"
                        exc_Ki = "exc_Ki"
                        exc_Kp = "exc_Kp"

                        mask {
                            description = "IEEE DC1A exciter model."

                            Tr {
                                label = "Time constant Tr"
                                widget = edit
                                type = generic
                                default_value = "2e-6"
                                group = "General"
                            }

                            exc_Kp {
                                label = "Exciter PI proportional gain"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            exc_Ki {
                                label = "Exciter PI integral gain"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Ka {
                                label = "Major regulator gain Ka"
                                widget = edit
                                type = generic
                                default_value = "200"
                                group = "General"
                            }

                            Ta {
                                label = "Major regulator time constant  Ta"
                                widget = edit
                                type = generic
                                default_value = "2e-3"
                                group = "General"
                            }

                            Vrmax {
                                label = "Saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                group = "General"
                            }

                            Vrmin {
                                label = "Saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                group = "General"
                            }

                            Te {
                                label = "Exciter time constant Te"
                                widget = edit
                                type = generic
                                default_value = "1e-8"
                                group = "General"
                            }

                            Ke {
                                label = "Exciter gain Ke"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            Kf {
                                label = "Stabilization feedback gain Kf"
                                widget = edit
                                type = generic
                                default_value = "0.0"
                                group = "General"
                            }

                            Tf {
                                label = "Stabilization feedback time constant Tf"
                                widget = edit
                                type = generic
                                default_value = "1.0e-12"
                                group = "General"
                            }

                            Vf0 {
                                label = "Initial field voltage"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Vfmax {
                                label = "Exciter saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "[\'inf\']"
                                group = "General"
                            }

                            Vfmin {
                                label = "Exciter saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "[\'-inf\']"
                                group = "General"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                                group = "General"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8448, 8208
                        size = 112, 120
                    ]

                    port Delta_V_in {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8200
                    ]

                    port Vf_out {
                        label = "Vf_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8200
                    ]

                    port Vt_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8248
                    ]

                    port Vref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8200
                    ]

                    port dV {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7944, 8216
                    ]

                    port Start {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7696, 8256
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8336
                        rotation = down
                        scale = -1, 1
                    ]

                    port Q_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8072
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7816, 8256
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction112 sp
                    [
                        position = 7752, 8256
                    ]

                    junction Junction116 sp
                    [
                        position = 8072, 8200
                    ]

                    junction Junction117 sp
                    [
                        position = 8416, 8072
                    ]

                    junction Junction118 sp
                    [
                        position = 8360, 8248
                    ]

                    connect Const.out Sum1.in as Connection3
                    connect DC4B.reset Junction117 as Connection743
                    connect DC4B.Vt Junction118 as Connection748
                    connect DC4B.Vfd Product1.in1 as Connection739
                    connect DC4B.Vref Sum2.out as Connection745
                    connect GCB_status Product2.in as Connection709
                    connect Goto1 Junction112 as Connection121
                    connect Junction112 switch.in2 as Connection120
                    connect Junction116 Sum.out as Connection720
                    connect Junction117 From1 as Connection742
                    connect Junction118 Vt.in as Connection747
                    connect One.out DC4B.Linearize as Connection740
                    connect Product1.in Junction117 as Connection741
                    connect Product2.out Sum2.in1 as Connection717
                    connect Product2.in1 to_pu.out as Connection710
                    connect "Rate Limit.out" Sum.in as Connection59
                    connect "Rate Limit.in" switch.out as Connection58
                    connect Start Junction112 as Connection119
                    connect Sum.in1 Delta_V_in as Connection25
                    connect Sum1.out DC4B.Vpss as Connection744
                    connect Sum2.in Junction116 as Connection721
                    connect V_inner_droop.out one_ov_sqrt_3.in as Connection749
                    connect V_ref.in Junction116 as Connection719
                    connect Vf_out Vfpu_to_Vf.out as Connection126
                    connect Vfpu_to_Vf.in Product1.out as Connection125
                    connect Vpss.out Sum1.in1 as Connection32
                    connect Vref switch.in as Connection87
                    connect Vt_to_Vtpu.out Junction118 as Connection746
                    connect Vt_to_Vtpu.in Vt_in as Connection36
                    connect Zero.out switch.in1 as Connection45
                    connect dV Sum.in2 as Connection88
                    connect one_ov_sqrt_3.out Product2.in2 as Connection724
                    connect to_pu.in Q_meas as Connection619
                }
                [
                    position = 8088, 7816
                    size = 192, 200
                ]

                component Subsystem "pf Control" {
                    layout = dynamic
                    component "core/Signal switch" "Signal switch2" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7872, 8192
                        hide_name = True
                    ]

                    component "core/Probe" delta_V {
                        addr = "8972"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8392, 8160
                    ]

                    component "core/Probe" pf_r {
                    }
                    [
                        position = 7808, 8208
                    ]

                    component "core/C function" norm_pf_ref {
                        global_variables = "real u;"
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
/*End code section*/"
                        input_terminals = "real pf;inherit P;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(P>=0){
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7712, 8176
                        size = 48, 48
                    ]

                    component "core/Probe" pf_m {
                    }
                    [
                        position = 7912, 8304
                    ]

                    component "core/Logical operator" "Logical operator5" {
                        inputs = "4"
                    }
                    [
                        position = 7904, 8016
                        rotation = right
                        hide_name = True
                    ]

                    component "core/C function" norm_pf_meas {
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
Q = 0.0;
/*End code section*/"
                        input_terminals = "real pf;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(pf>=0){
    if(Q>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(Q>=0){
        pf_norm = 2+pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7760, 8304
                        size = 48, 48
                    ]

                    component "core/Rate Limiter" "Rate Limiter1" {
                        falling_limit = "pf_fall"
                        rising_limit = "pf_rise"
                    }
                    [
                        position = 7936, 8192
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "0.1/Sb"
                    }
                    [
                        position = 7720, 7992
                        hide_name = True
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7824, 7944
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch4" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8304, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8032, 8200
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8240, 8232
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Ki {
                            gain = "pf_Ki"
                        }
                        [
                            position = 7992, 8216
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "pf_lowLim"
                            upper_limit = "pf_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "pf_Kp"
                        }
                        [
                            position = 7992, 8136
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7824, 8176
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7920, 8176
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection60
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection61
                        connect Kp.in Junction4 as Connection59
                        connect Kp.out Sum5.in as Connection57
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                        connect Sum7.in Ki.out as Connection54
                    }
                    [
                        position = 8144, 8200
                        size = 64, 48
                    ]

                    port Q_meas_in {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8344
                    ]

                    port Q_control_mode {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7792, 7840
                    ]

                    port enable {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7832, 7800
                    ]

                    port dV_out {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8392, 8216
                    ]

                    port P_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7880
                    ]

                    port pf_ref {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8128
                    ]

                    port pf_meas {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8280
                    ]

                    port Pref {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7936
                    ]

                    port P_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8184
                    ]

                    port Q_active {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8000
                    ]

                    tag Goto1 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8072, 8064
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7808, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction75 sp
                    [
                        position = 8344, 8216
                    ]

                    junction Junction81 sp
                    [
                        position = 7872, 8120
                    ]

                    junction Junction84 sp
                    [
                        position = 8144, 8120
                    ]

                    junction Junction85 sp
                    [
                        position = 7840, 8248
                    ]

                    junction Junction86 sp
                    [
                        position = 7840, 8304
                    ]

                    junction Junction87 sp
                    [
                        position = 7768, 8176
                    ]

                    junction Junction88 sp
                    [
                        position = 7984, 8064
                    ]

                    connect Constant1.out greater_equal.in1 as Connection125
                    connect From2 Junction81 as Connection52
                    connect Goto1 Junction88 as Connection128
                    connect Junction75 dV_out as Connection2
                    connect Junction81 Junction84 as Connection79
                    connect Junction81 "Signal switch2.in2" as Connection53
                    connect Junction84 "Signal switch4.in2" as Connection80
                    connect Junction85 "Signal switch2.in1" as Connection99
                    connect Junction86 Junction85 as Connection102
                    connect Junction87 "Signal switch2.in" as Connection108
                    connect Junction88 "Logical operator5.out" as Connection129
                    connect PI.Reset Junction84 as Connection81
                    connect PI.Out "Signal switch4.in" as Connection77
                    connect P_control_mode "Logical operator5.in2" as Connection84
                    connect P_meas norm_pf_ref.P as Connection127
                    connect Q_active Junction88 as Connection130
                    connect Q_control_mode "Logical operator5.in1" as Connection135
                    connect Q_meas_in norm_pf_meas.Q as Connection96
                    connect "Rate Limiter1.out" Sum6.in as Connection134
                    connect "Signal switch2.out" "Rate Limiter1.in" as Connection133
                    connect "Signal switch4.out" Junction75 as Connection17
                    connect Sum6.in1 Junction85 as Connection98
                    connect Sum6.out PI.In as Connection123
                    connect delta_V.in Junction75 as Connection20
                    connect enable "Logical operator5.in" as Connection136
                    connect greater_equal.out "Logical operator5.in3" as Connection126
                    connect greater_equal.in Pref as Connection124
                    connect norm_pf_meas.pf_norm Junction86 as Connection101
                    connect norm_pf_ref.pf_norm Junction87 as Connection107
                    connect norm_pf_ref.pf pf_ref as Connection132
                    connect pf_m.in Junction86 as Connection103
                    connect pf_meas norm_pf_meas.pf as Connection104
                    connect pf_r.in Junction87 as Connection109
                    connect zero1.out "Signal switch4.in1" as Connection75
                }
                [
                    position = 7736, 7912
                    size = 144, 272
                ]

                component Subsystem Output {
                    layout = dynamic

                    port w_meas {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8216
                    ]

                    port Gen_On {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "Gen_On"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto8 {
                        value = "w_meas"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8216
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Gen_On Goto7 as Connection632
                    connect Goto8 w_meas as Connection631
                }
                [
                    position = 8448, 8416
                    size = 56, 72
                ]

                component Subsystem Freq_setpoint_control {
                    layout = dynamic
                    component "core/Gain" P_3ph_to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 7960, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Constant" P_Droop {
                        execution_rate = "Ts"
                        value = "P_droop"
                    }
                    [
                        position = 7864, 7864
                    ]

                    component "core/Sum" Sum5 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8168, 7944
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" w_Droop {
                        execution_rate = "Ts"
                        value = "w_droop"
                    }
                    [
                        position = 8120, 8296
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 9184, 8352
                    ]

                    component "core/Signal switch" load_share_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8888, 8232
                        hide_name = True
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8208, 8344
                        hide_name = True
                    ]

                    component "core/Probe" w_Psp {
                    }
                    [
                        position = 8360, 7904
                        rotation = left
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 8400, 8512
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 8280, 8528
                        hide_name = True
                    ]

                    component "core/Probe" w_Pm {
                    }
                    [
                        position = 8360, 8016
                        rotation = left
                    ]

                    component "core/Signal switch" mode_switch1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 9408, 8368
                        hide_name = True
                    ]

                    component "core/Product" Product3 {
                        signs = "3"
                    }
                    [
                        position = 8152, 8056
                        hide_name = True
                    ]

                    component "core/Signal switch" mode_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8776, 8352
                        hide_name = True
                    ]

                    component "core/Limit" P_limit {
                        lower_limit = "0.0"
                        upper_limit = "1.0/1.25"
                    }
                    [
                        position = 7872, 7936
                        hide_name = True
                    ]

                    component "core/Sum" Sum8 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8608, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" f_droop_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8360
                        hide_name = True
                    ]

                    component "core/Probe" delta_w {
                        addr = "8975"
                        execution_rate = "Ts"
                    }
                    [
                        position = 9056, 8288
                        rotation = left
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8032, 7936
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7880, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum7 {
                    }
                    [
                        position = 8976, 8344
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8616, 7952
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Probe" w_sp {
                    }
                    [
                        position = 8712, 7992
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "w_fall"
                        rising_limit = "w_rise"
                    }
                    [
                        position = 8472, 8512
                        hide_name = True
                    ]

                    component "core/Rate Limiter" P_ramp {
                        falling_limit = "P_fall"
                        rising_limit = "P_rise"
                    }
                    [
                        position = 7936, 7936
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "w_sp_Kp"
                        }
                        [
                            position = 8008, 8152
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Ki {
                            gain = "w_sp_Ki"
                        }
                        [
                            position = 8008, 8216
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "w_sp_lowLim"
                            upper_limit = "w_sp_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7872, 8184
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7928, 8184
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.in Junction4 as Connection57
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 9296, 8352
                        size = 64, 48
                    ]

                    port Pmeas_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7864, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 7936
                    ]

                    port enable {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8280
                    ]

                    port w_meas {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_ref {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8496
                        rotation = down
                        scale = -1, 1
                    ]

                    port Load_Share {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8800, 8200
                    ]

                    port w_bias {
                        position = auto:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 9480, 8368
                    ]

                    port Load_Share_on {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8824, 8136
                    ]

                    port P_mode {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8288
                    ]

                    tag Goto2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8416, 8568
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From5 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9216, 8272
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8280, 8376
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From4 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9096, 8360
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto4 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8440, 8280
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8064, 7864
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto3 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7968, 8040
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From7 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9320, 8416
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8064, 8056
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From6 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From3 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8800, 8248
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction4 sp
                    [
                        position = 8072, 8016
                    ]

                    junction Junction6 sp
                    [
                        position = 8056, 8352
                    ]

                    junction Junction7 sp
                    [
                        position = 8344, 8528
                    ]

                    junction Junction8 sp
                    [
                        position = 7992, 8016
                    ]

                    junction Junction9 sp
                    [
                        position = 8360, 7944
                    ]

                    junction Junction10 sp
                    [
                        position = 8360, 8056
                    ]

                    junction Junction11 sp
                    [
                        position = 8656, 7992
                    ]

                    junction Junction12 sp
                    [
                        position = 9056, 8344
                    ]

                    junction Junction13 sp
                    [
                        position = 7920, 8016
                    ]

                    junction Junction14 sp
                    [
                        position = 8360, 8280
                    ]

                    junction Junction15 sp
                    [
                        position = 9296, 8272
                    ]

                    junction Junction16 sp
                    [
                        position = 7992, 7864
                    ]

                    comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8384, 8328
                    ]

                    comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_P_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8208, 7912
                    ]

                    comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8640, 8376
                    ]

                    comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8512, 8384
                    ]

                    comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Power setpoint loop</span></p></body></html> ENDCOMMENT 
                    [
                        position = 7904, 7816
                    ]

                    comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8656, 8056
                        rotation = right
                    ]

                    comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Frequency setpoint loop</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp = f_rated*Droop*Ppu</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Ppu = Pmeas/Prated</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">f_rated = 1pu</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8008, 8392
                    ]

                    connect From1 Product3.in1 as Connection631
                    connect From2 f_droop_switch.in1 as Connection655
                    connect From3 load_share_switch.in1 as Connection656
                    connect From5 Junction15 as Connection714
                    connect From6 w_switch.in2 as Connection711
                    connect From7 mode_switch1.in1 as Connection717
                    connect Goto2 Junction7 as Connection654
                    connect Goto3 Junction13 as Connection698
                    connect Goto4 Junction14 as Connection710
                    connect Junction10 Sum6.in as Connection682
                    connect Junction11 Sum6.out as Connection685
                    connect Junction12 Sum7.out as Connection693
                    connect Junction13 Junction8 as Connection697
                    connect Junction14 f_droop_switch.in2 as Connection709
                    connect Junction15 PI.Reset as Connection715
                    connect Junction16 Goto1 as Connection725
                    connect Junction4 Junction8 as Connection674
                    connect Junction6 Product1.in1 as Connection648
                    connect Junction7 w_switch.in1 as Connection653
                    connect Junction8 Product2.in2 as Connection675
                    connect Junction9 Sum5.out as Connection679
                    connect Load_Share load_share_switch.in as Connection659
                    connect Load_Share_on load_share_switch.in2 as Connection718
                    connect P_3ph_to_pu.out Junction6 as Connection647
                    connect P_Droop.out Junction16 as Connection726
                    connect P_limit.in P_ref as Connection721
                    connect P_mode mode_switch.in2 as Connection719
                    connect P_ramp.in P_limit.out as Connection720
                    connect Pmeas_in P_3ph_to_pu.in as Connection58
                    connect Product2.in Junction16 as Connection724
                    connect Product2.in1 P_ramp.out as Connection645
                    connect Product3.out Junction10 as Connection681
                    connect Product3.in Junction4 as Connection626
                    connect Product3.in2 Junction6 as Connection649
                    connect Sum3.in1 From4 as Connection707
                    connect Sum3.in Junction12 as Connection694
                    connect Sum3.out PI.In as Connection687
                    connect Sum5.in Junction4 as Connection624
                    connect Sum5.in1 Product2.out as Connection611
                    connect Sum6.in1 Junction9 as Connection678
                    connect Sum8.in f_droop_switch.out as Connection637
                    connect Sum8.in1 w_ramp.out as Connection638
                    connect delta_w.in Junction12 as Connection692
                    connect enable Junction14 as Connection708
                    connect f_droop_switch.in Product1.out as Connection634
                    connect load_share_switch.out Sum7.in as Connection650
                    connect mode_switch.in Junction11 as Connection684
                    connect mode_switch.out Sum7.in1 as Connection644
                    connect mode_switch.in1 Sum8.out as Connection643
                    connect mode_switch1.in2 Junction15 as Connection716
                    connect mode_switch1.in PI.Out as Connection712
                    connect "w to wpu.out" Junction13 as Connection696
                    connect w_Droop.out Product1.in as Connection722
                    connect w_Pm.in Junction10 as Connection683
                    connect w_Psp.in Junction9 as Connection680
                    connect w_bias mode_switch1.out as Connection713
                    connect w_meas "w to wpu.in" as Connection677
                    connect w_ramp.in w_switch.out as Connection103
                    connect w_ref w_switch.in as Connection180
                    connect w_sp.in Junction11 as Connection686
                    connect zero1.out Junction7 as Connection652
                }
                [
                    position = 7696, 8224
                    size = 120, 264
                ]

                component Subsystem Define_control_mode {
                    layout = dynamic
                    component "core/C function" Control_mode {
                        init_fnc = "/*Begin code section*/
P_control = 0;
Q_control = 0;
/*End code section*/"
                        input_terminals = "real Control_mode;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        output_fnc = "/*Begin code section*/
if(Control_mode == 1){
    //PV mode
    P_control = 1;
    Q_control = 0;
}
else{
    if(Control_mode == 2){
        //PQ mode
        P_control = 1;
        Q_control = 1;
    }
    else{
        P_control = 0;
        Q_control = 0;
    }
}
/*End code section*/"
                        output_terminals = "real P_control;inherit Q_control;"
                        output_terminals_dimensions = "inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;"
                    }
                    [
                        position = 8224, 8184
                        size = 176, 96
                    ]

                    port Gen_Control_Mode {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8184
                    ]

                    port P_Control {
                        position = right:11
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8152
                    ]

                    port Q_Control {
                        position = right:12
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8216
                    ]

                    connect Control_mode.Control_mode Gen_Control_Mode as Connection3
                    connect Control_mode.P_control P_Control as Connection2
                    connect Control_mode.Q_control Q_Control as Connection1
                }
                [
                    position = 7328, 8432
                    size = 144, 64
                ]

                component "core/C function" read_OP_mode {
                    init_fnc = "/*Begin code section*/
OP_mode =0;
enable = 0;
StandBy = 1;
GridFollowing = 0;
GridForming = 0;
/*End code section*/"
                    input_terminals = "real OP_mode;inherit GCB_status;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[u\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
if(OP_mode==0){
    StandBy= 1;
    GridFollowing = 0;
    GridForming = 0;
    enable = 0;
}
else{
    if(OP_mode == 1){
        StandBy = 0;
        GridFollowing = 1;
        GridForming = 0;
        if(GCB_status == 0){
            enable = 0;
        }
        else{
            enable = 1;
        }
    }
    else{
        StandBy = 0;
        GridFollowing = 0;
        GridForming = 1;
        enable = 0;
    }
}
/*End code section*/"
                    output_terminals = "real StandBy;inherit GridFollowing;inherit GridForming;inherit enable;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[u\'\']"
                    output_terminals_show_labels = "False;False;False;False;"
                }
                [
                    position = 7288, 7800
                    rotation = right
                    size = 128, 96
                ]

                port wmeas {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7840, 8320
                ]

                port T_in {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7272, 8280
                ]

                port Meas_feedback {
                    position = left:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7208, 8024
                ]

                port From_synch_check {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7856
                ]

                port To_synch_check {
                    position = left:12
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8456, 8112
                    rotation = left
                ]

                port T_out {
                    position = right:14
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8176, 8240
                ]

                port Inputs {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7960
                ]

                port Vf_out {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8272, 7816
                ]

                tag Goto38 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8088, 8440
                    hide_name = True
                    size = 60, 20
                ]

                tag From3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag From12 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From54 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8168
                    hide_name = True
                    size = 60, 20
                ]

                tag From59 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8104
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8256
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto39 {
                    value = "Exciter_on"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7864, 7728
                    hide_name = True
                    size = 60, 20
                ]

                tag From15 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8112
                    hide_name = True
                    size = 60, 20
                ]

                tag From62 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8272
                    hide_name = True
                    size = 60, 20
                ]

                tag From66 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto44 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7952, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag From70 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7928
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7504, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From13 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto45 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7872, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From67 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7192, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From68 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto16 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag From63 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8304
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7800
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto40 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8152
                    hide_name = True
                    size = 60, 20
                ]

                tag From2 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto15 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From61 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto43 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8416
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From65 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7688
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8176
                    hide_name = True
                    size = 58, 20
                ]

                tag Goto11 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8120
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From51 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 8008
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8160
                    hide_name = True
                    size = 60, 20
                ]

                tag From71 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8400
                    hide_name = True
                    size = 60, 20
                ]

                tag From60 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 7664
                    hide_name = True
                    size = 60, 20
                ]

                tag From1 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From64 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto42 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag From69 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7960
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto35 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From16 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8208
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto46 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8224
                    hide_name = True
                    size = 58, 20
                ]

                tag From4 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8176
                    hide_name = True
                    size = 60, 20
                ]

                tag From72 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From58 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto37 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8200
                    hide_name = True
                    size = 58, 20
                ]

                junction Junction13 sp
                [
                    position = 7800, 7704
                ]

                junction Junction14 sp
                [
                    position = 7888, 8392
                ]

                junction Junction15 sp
                [
                    position = 7800, 7704
                ]

                junction Junction18 sp
                [
                    position = 8224, 7816
                ]

                junction Junction22 sp
                [
                    position = 7056, 8120
                ]

                junction Junction23 sp
                [
                    position = 7888, 8320
                ]

                junction Junction24 sp
                [
                    position = 8128, 8240
                ]

                junction Junction25 sp
                [
                    position = 7368, 7888
                ]

                junction Junction26 sp
                [
                    position = 7456, 7928
                ]

                junction Junction27 sp
                [
                    position = 7368, 7952
                ]

                connect "Bus Join1.out" To_synch_check as Connection608
                connect "Bus Split2.in" From_synch_check as Connection205
                connect "Bus Split2.out1" Goto4 as Connection543
                connect "Bus Split3.out2" Goto13 as Connection677
                connect "Bus Split3.out4" Goto15 as Connection679
                connect "Bus Split3.out7" Goto40 as Connection687
                connect "Bus Split3.in" Inputs as Connection672
                connect "Bus Split3.out" Junction22 as Connection675
                connect Exciter_on.in Junction15 as Connection604
                connect Freq_setpoint_control.P_ref From14 as Connection648
                connect Freq_setpoint_control.Pmeas_in From2 as Connection651
                connect Freq_setpoint_control.enable From4 as Connection649
                connect Freq_setpoint_control.w_bias Governor_and_Engine.w_bias as Connection706
                connect From10 "Governor_and_Engine.Gen On" as Connection700
                connect From13 Exciter.Vref as Connection226
                connect From15 Freq_setpoint_control.w_ref as Connection647
                connect From16 "Bus Join1.in" as Connection576
                connect From27 "pf Control.pf_meas" as Connection693
                connect From3 Exciter.Vt_in as Connection179
                connect From45 Round1.in as Connection570
                connect From46 "Unit Delay1.in" as Connection581
                connect From49 "Bus Join1.in1" as Connection609
                connect From5 Read_Control_mode.Enable_outer_loop as Connection187
                connect From50 "Bus Join1.in3" as Connection611
                connect From51 "Bus Join1.in2" as Connection610
                connect From52 Exciter.dV as Connection585
                connect From54 "Bus Join1.in4" as Connection612
                connect From56 Freq_setpoint_control.w_meas as Connection650
                connect From58 Governor_and_Engine.P_meas as Connection697
                connect From59 "Unit Delay2.in" as Connection622
                connect From6 Read_Control_mode.P_control_mode as Connection188
                connect From60 "Unit Delay3.in" as Connection632
                connect From61 Exciter.Q_meas as Connection634
                connect From62 Freq_setpoint_control.P_mode as Connection653
                connect From63 Freq_setpoint_control.Load_Share_on as Connection654
                connect From64 Freq_setpoint_control.Load_Share as Connection655
                connect From65 Read_Control_mode.Q_control_mode as Connection685
                connect From66 "pf Control.P_control_mode" as Connection686
                connect From67 Define_control_mode.Gen_Control_Mode as Connection691
                connect From68 Governor_and_Engine.w_ref as Connection701
                connect From69 "pf Control.P_meas" as Connection709
                connect From7 Start_Exciter.Gen_On as Connection589
                connect From70 "pf Control.pf_ref" as Connection708
                connect From71 Output.Gen_On as Connection713
                connect From72 Output.w_meas as Connection714
                connect From8 Start_Exciter.w_meas as Connection590
                connect From9 Governor_and_Engine.dw_synch as Connection698
                connect Gen_On.in Junction22 as Connection673
                connect Goto1 "Bus Split1.out" as Connection174
                connect Goto10 "Bus Split2.out" as Connection531
                connect Goto12 "Bus Split3.out1" as Connection676
                connect Goto14 "Bus Split3.out3" as Connection678
                connect Goto16 "Bus Split3.out6" as Connection681
                connect Goto2 "Bus Split1.out1" as Connection175
                connect Goto3 "Bus Split1.out2" as Connection176
                connect Goto32 "Bus Split3.out5" as Connection680
                connect Goto37 "Bus Split2.out2" as Connection584
                connect Goto38 check_steady_state_w.ss_speed as Connection602
                connect Goto39 Junction15 as Connection606
                connect Goto42 "Bus Split3.out8" as Connection688
                connect Goto43 Define_control_mode.P_Control as Connection690
                connect Goto44 Define_control_mode.Q_Control as Connection689
                connect Goto45 "pf Control.Q_active" as Connection707
                connect Goto46 "Bus Split1.out3" as Connection711
                connect Goto9 Junction14 as Connection599
                connect Governor_and_Engine.w_meas_in Junction23 as Connection696
                connect Governor_and_Engine.T_out Junction24 as Connection705
                connect Junction13 Exciter.Start as Connection596
                connect Junction15 Junction13 as Connection605
                connect Junction18 Exciter.Vf_out as Connection645
                connect Junction22 Goto11 as Connection674
                connect Junction23 Junction14 as Connection695
                connect Junction24 T.in as Connection704
                connect Meas_feedback "Bus Split1.in" as Connection712
                connect Start_Exciter.Start Junction13 as Connection595
                connect T_in Termination1.in as Connection166
                connect T_out Junction24 as Connection703
                connect "Unit Delay2.out" Governor_and_Engine.GCB_status as Connection702
                connect "Unit Delay3.out" Exciter.GCB_status as Connection633
                connect Vf.in Junction18 as Connection644
                connect Vf_out Junction18 as Connection646
                connect check_steady_state_w.w_meas Junction14 as Connection601
                connect "pf Control.dV_out" Exciter.Delta_V_in as Connection710
                connect "pf Control.Q_meas_in" From1 as Connection552
                connect "pf Control.Q_control_mode" From11 as Connection549
                connect "pf Control.Pref" From12 as Connection551
                connect "pf Control.enable" From47 as Connection550
                connect wmeas Junction23 as Connection694
                connect Goto35 Junction25 as Connection718
                connect Junction25 StandBy.in as Connection719
                connect read_OP_mode.StandBy Junction25 as Connection720
                connect Goto36 Junction26 as Connection721
                connect Junction26 GridFollowing.in as Connection722
                connect read_OP_mode.GridFollowing Junction26 as Connection723
                connect GridForming.in Junction27 as Connection724
                connect Junction27 Goto34 as Connection725
                connect read_OP_mode.GridForming Junction27 as Connection726
                connect read_OP_mode.enable Goto33 as Connection727
                connect read_OP_mode.GCB_status "Unit Delay1.out" as Connection728
                connect Round1.out read_OP_mode.OP_mode as Connection729
            }
            [
                position = 9088, 8056
                scale = -1, 1
                size = 208, 200
            ]

            component Subsystem Sync_Check {
                layout = dynamic
                component "core/Logical operator" not {
                    operator = "NOT"
                }
                [
                    position = 9032, 8632
                    hide_name = True
                ]

                component "core/Probe" dw_f {
                }
                [
                    position = 8744, 8096
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join2" {
                    inputs = "3"
                }
                [
                    position = 8704, 8664
                    hide_name = True
                ]

                component "core/Digital Probe" V_match {
                }
                [
                    position = 8728, 7968
                    rotation = left
                ]

                component "core/Digital Probe" Speed_ss {
                }
                [
                    position = 9160, 8280
                    rotation = left
                ]

                component "core/Digital Probe" Phase_match {
                }
                [
                    position = 8720, 8400
                    rotation = right
                ]

                component "core/Digital Probe" dw_synch_ON {
                }
                [
                    position = 9248, 8536
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "5"
                }
                [
                    position = 8632, 8560
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dV {
                }
                [
                    position = 8608, 7928
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join" {
                    inputs = "3"
                }
                [
                    position = 9192, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dw_phase {
                }
                [
                    position = 8744, 8256
                    rotation = left
                ]

                component "core/Digital Probe" f_match {
                }
                [
                    position = 8624, 8176
                    rotation = left
                ]

                component "core/Digital Probe" Check_phase_ON {
                }
                [
                    position = 8592, 8440
                ]

                component "core/Logical operator" and1 {
                }
                [
                    position = 8464, 8440
                    hide_name = True
                ]

                component "core/Probe" dw_synch {
                }
                [
                    position = 9056, 8168
                    rotation = left
                ]

                component "core/Logical operator" and2 {
                    inputs = "5"
                }
                [
                    position = 9120, 8576
                    rotation = left
                    hide_name = True
                ]

                component Subsystem check_V_diff {
                    layout = dynamic
                    component "core/Abs" Abs4 {
                    }
                    [
                        position = 7816, 8176
                        hide_name = True
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8144
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8264, 8216
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8432, 8160
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8048, 8248
                        hide_name = True
                    ]

                    component "core/Gain" Volt_diff {
                        gain = "delta_V/100.0"
                    }
                    [
                        position = 8264, 8256
                    ]

                    component "core/Gain" Vgrid_lowLim {
                        gain = "0.9"
                    }
                    [
                        position = 7864, 8280
                    ]

                    component "core/Probe" V_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    component "core/Gain" Vgrid_upLim {
                        gain = "1.1"
                    }
                    [
                        position = 7864, 8224
                    ]

                    component "core/Constant" one1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7776, 8224
                    ]

                    component "core/Constant" one {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8200, 8256
                    ]

                    component "core/Gain" pu {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 8128, 8144
                    ]

                    component "core/Gain" pu1 {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 7880, 8176
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8360, 8176
                        hide_name = True
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8144, 8064
                        hide_name = True
                    ]

                    component "core/Relational operator" less_equal {
                        relational_op = "<="
                    }
                    [
                        position = 7960, 8216
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8336, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7960, 8272
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "-1"
                            limit_upper = "1"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "V_lowLim"
                            upper_limit = "V_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Kp {
                            gain = "V_Kp"
                        }
                        [
                            position = 8024, 8168
                        ]

                        component "core/Gain" Ki {
                            gain = "V_Ki"
                        }
                        [
                            position = 7976, 8216
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7888, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7944, 8168
                        ]

                        connect In Junction4 as Connection58
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection59
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection60
                        connect Ki.out Sum7.in as Connection56
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8272, 8144
                        size = 64, 48
                    ]

                    port Vgrid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8136
                    ]

                    port Vgen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8152
                    ]

                    port dV {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8160
                    ]

                    port Activate {
                        position = top:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8064
                    ]

                    port V_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8400, 8224
                    ]

                    port Grid_On {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8128, 8248
                    ]

                    junction Junction2 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction3 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction4 sp
                    [
                        position = 8272, 8064
                    ]

                    junction Junction5 sp
                    [
                        position = 7776, 8136
                    ]

                    junction Junction6 sp
                    [
                        position = 7912, 8208
                    ]

                    junction Junction7 sp
                    [
                        position = 7816, 8224
                    ]

                    connect Abs3.in Junction2 as Connection202
                    connect Abs4.in Junction5 as Connection227
                    connect Abs4.out pu1.in as Connection235
                    connect Activate "Unit Delay1.in" as Connection208
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Grid_On and.out as Connection241
                    connect Junction2 pu.out as Connection201
                    connect Junction3 Junction2 as Connection216
                    connect Junction4 "Unit Delay1.out" as Connection219
                    connect Junction5 Vgrid as Connection226
                    connect Junction6 less_equal.in as Connection232
                    connect Junction7 Vgrid_upLim.in as Connection239
                    connect PI.In Junction3 as Connection217
                    connect PI.Reset Junction4 as Connection220
                    connect PI.Out "Signal switch1.in" as Connection214
                    connect "Signal switch1.in2" Junction4 as Connection218
                    connect Sum1.in Junction5 as Connection225
                    connect Sum1.in1 Vgen as Connection60
                    connect V_diff.in Junction3 as Connection215
                    connect V_match Comparator1.out as Connection187
                    connect Vgrid_lowLim.in Junction7 as Connection240
                    connect Vgrid_lowLim.out greater_equal.in1 as Connection237
                    connect Vgrid_upLim.out less_equal.in1 as Connection234
                    connect Volt_diff.out Comparator1.in1 as Connection17
                    connect dV "Signal switch1.out" as Connection181
                    connect greater_equal.in Junction6 as Connection233
                    connect greater_equal.out and.in1 as Connection229
                    connect less_equal.out and.in as Connection228
                    connect one.out Volt_diff.in as Connection14
                    connect one1.out Junction7 as Connection238
                    connect pu.in Sum1.out as Connection198
                    connect pu1.out Junction6 as Connection236
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8520, 8016
                    size = 144, 120
                ]

                component Subsystem PLLs {
                    layout = dynamic
                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8464, 8216
                        hide_name = True
                    ]

                    component "core/Probe" V_grid {
                    }
                    [
                        position = 8296, 8096
                    ]

                    component "core/Probe" wt_grid {
                    }
                    [
                        position = 8464, 8144
                    ]

                    component "core/Bus Split" split1 {
                        outputs = "3"
                    }
                    [
                        position = 8072, 8360
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Probe" wt_gen {
                    }
                    [
                        position = 8464, 8280
                    ]

                    component "core/Bus Split" split {
                        outputs = "3"
                    }
                    [
                        position = 8096, 7936
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" V_gen {
                    }
                    [
                        position = 8216, 8352
                    ]

                    component "core/Gain" Gain1 {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    component Subsystem PLL_Grid {
                        layout = dynamic
                        component "core/Termination" Term1 {
                        }
                        [
                            position = 8128, 8152
                            rotation = left
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_Vt {
                            a_coeff = "[1.0/(2*np.pi*fc_vt),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8224
                        ]

                        component "core/Discrete Transfer Function" LPF_f {
                            a_coeff = "[1.0/(2*np.pi*fc_f),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8216, 8248
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 8104, 8112
                            rotation = left
                            hide_name = True
                        ]

                        component Subsystem PLL {
                            layout = dynamic
                            component "core/Gain" rads_to_Hz {
                                gain = "1/(2*np.pi)"
                            }
                            [
                                position = 8360, 8056
                            ]

                            component "core/Termination" Term {
                            }
                            [
                                position = 8008, 8216
                                rotation = right
                            ]

                            component "core/Unit Delay" "Unit Delay1" {
                            }
                            [
                                position = 8480, 8272
                                rotation = right
                            ]

                            component "core/C function" integrator {
                                global_variables = "real out;"
                                init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                                input_terminals_dimensions = "inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                output_fnc = "/*Begin code section*/
output = out+0.0;
/*End code section*/"
                                output_terminals = "inherit output;"
                                output_terminals_dimensions = "inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                parameters = "real Ts;"
                                update_fnc = "/*Begin code section*/
out += Ts*in;

if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            }
                            [
                                position = 8424, 8136
                                size = 0, 0
                            ]

                            component Subsystem Normalize {
                                layout = dynamic
                                component "core/C function" V_terminal {
                                    init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                    input_terminals = "real d;inherit q;"
                                    input_terminals_dimensions = "inherit;inherit"
                                    input_terminals_feedthrough = "[u\'\']"
                                    input_terminals_show_labels = "False;False;"
                                    output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                    output_terminals = "real t;inherit q_pu;"
                                    output_terminals_dimensions = "inherit;inherit"
                                    output_terminals_feedthrough = "[u\'\']"
                                    output_terminals_show_labels = "False;False;"
                                }
                                [
                                    position = 8192, 8192
                                    size = 0, 0
                                ]

                                port d {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8152
                                ]

                                port q {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8216
                                ]

                                port q_pu {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8352, 8200
                                ]

                                port Vt {
                                    position = top:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8280, 8104
                                    rotation = left
                                ]

                                connect V_terminal.t Vt as Connection8
                                connect V_terminal.d d as Connection1
                                connect V_terminal.q q as Connection3
                                connect q_pu V_terminal.q_pu as Connection9
                            }
                            [
                                position = 8128, 8136
                                size = 64, 64
                            ]

                            component Subsystem PI {
                                layout = dynamic
                                component "core/Sum" Sum6 {
                                    signs = "-+"
                                }
                                [
                                    position = 8304, 8304
                                    hide_name = True
                                    scale = -1, 1
                                ]

                                component "core/Gain" Ki {
                                    gain = "Ki"
                                }
                                [
                                    position = 7960, 8208
                                ]

                                component "core/Limit" Limit1 {
                                    lower_limit = "0.7*2*np.pi*f"
                                    upper_limit = "1.4*2*np.pi*f"
                                }
                                [
                                    position = 8416, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum8 {
                                }
                                [
                                    position = 8272, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum7 {
                                }
                                [
                                    position = 8072, 8216
                                    hide_name = True
                                ]

                                component "core/Gain" Kp {
                                    gain = "Kp"
                                }
                                [
                                    position = 8088, 8144
                                ]

                                component "core/Gain" Kb {
                                    gain = "1000"
                                }
                                [
                                    position = 8200, 8304
                                    scale = -1, 1
                                ]

                                component "core/Integrator" Integrator1 {
                                    init_value = "[2*np.pi*f]"
                                }
                                [
                                    position = 8176, 8216
                                    hide_name = True
                                ]

                                port In {
                                    position = right:auto
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7840, 8144
                                    rotation = down
                                    scale = -1, 1
                                ]

                                port Out {
                                    position = left:auto
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8544, 8176
                                    rotation = down
                                    scale = -1, 1
                                ]

                                junction Junction161 sp
                                [
                                    position = 7904, 8144
                                ]

                                junction Junction162 sp
                                [
                                    position = 8368, 8176
                                ]

                                junction Junction163 sp
                                [
                                    position = 8456, 8176
                                ]

                                connect Integrator1.out Sum8.in1 as Connection352
                                connect Junction161 In as Connection360
                                connect Junction161 Ki.in as Connection359
                                connect Junction161 Kp.in as Connection358
                                connect Junction162 Limit1.in as Connection369
                                connect Junction163 Out as Connection372
                                connect Kb.in Sum6.out as Connection50
                                connect Kp.out Sum8.in as Connection350
                                connect Limit1.out Junction163 as Connection371
                                connect Sum6.in Junction162 as Connection370
                                connect Sum6.in1 Junction163 as Connection373
                                connect Sum7.out Integrator1.in as Connection365
                                connect Sum7.in1 Kb.out as Connection53
                                connect Sum7.in Ki.out as Connection364
                                connect Sum8.out Junction162 as Connection368
                            }
                            [
                                position = 8256, 8136
                                scale = -1, -1
                                size = 48, 48
                            ]

                            component Subsystem ABC_dqz {
                                layout = dynamic
                                component "core/alpha beta to dq" "alpha beta to dq" {
                                }
                                [
                                    position = 8248, 8192
                                ]

                                component "core/abc to alpha beta" "abc to alpha beta" {
                                }
                                [
                                    position = 8024, 8192
                                ]

                                port A {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7952, 8104
                                    rotation = right
                                ]

                                port B {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7904, 8104
                                    rotation = right
                                ]

                                port C {
                                    position = left:3
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7856, 8104
                                    rotation = right
                                ]

                                port wt {
                                    position = left:4
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8176, 8288
                                    rotation = left
                                ]

                                port d {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8320, 8136
                                    rotation = left
                                ]

                                port q {
                                    position = right:2
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8368, 8136
                                    rotation = left
                                ]

                                port z {
                                    position = right:3
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8096, 8288
                                    rotation = right
                                ]

                                connect "abc to alpha beta.A" A as Connection2685
                                connect "abc to alpha beta.B" B as Connection2686
                                connect "abc to alpha beta.C" C as Connection2687
                                connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                                connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                                connect "alpha beta to dq.wt" wt as Connection2690
                                connect d "alpha beta to dq.d" as Connection2692
                                connect q "alpha beta to dq.q" as Connection2693
                                connect z "abc to alpha beta.gamma" as Connection2691
                            }
                            [
                                position = 7912, 8152
                                size = 48, 104
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7736, 8152
                                rotation = left
                            ]

                            port B {
                                label = "B"
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7776, 8176
                                rotation = left
                            ]

                            port C {
                                label = "C"
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7816, 8200
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8008
                            ]

                            port q {
                                label = "q"
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8056
                            ]

                            port Vt {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8192, 8064
                            ]

                            port wt {
                                position = right:5
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8528, 8136
                            ]

                            port f {
                                position = right:4
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8424, 8056
                            ]

                            junction Junction4 sp
                            [
                                position = 8480, 8136
                            ]

                            junction Junction5 sp
                            [
                                position = 8320, 8136
                            ]

                            junction Junction6 sp
                            [
                                position = 8008, 8120
                            ]

                            junction Junction7 sp
                            [
                                position = 8024, 8152
                            ]

                            connect ABC_dqz.A A as Connection233
                            connect ABC_dqz.C C as Connection231
                            connect ABC_dqz.d Junction6 as Connection225
                            connect ABC_dqz.q Junction7 as Connection228
                            connect ABC_dqz.z Term.in as Connection229
                            connect B ABC_dqz.B as Connection232
                            connect Junction4 "Unit Delay1.in" as Connection213
                            connect Junction5 integrator.in as Connection218
                            connect Junction6 d as Connection224
                            [
                                position = 0, 0
                            ]
                            connect Junction7 Normalize.q as Connection227
                            [
                                position = 0, 0
                            ]
                            connect Normalize.d Junction6 as Connection223
                            connect PI.Out Junction5 as Connection219
                            connect PI.In Normalize.q_pu as Connection220
                            connect "Unit Delay1.out" ABC_dqz.wt as Connection230
                            connect Vt Normalize.Vt as Connection184
                            connect f rads_to_Hz.out as Connection199
                            connect integrator.output Junction4 as Connection214
                            connect q Junction7 as Connection226
                            connect rads_to_Hz.in Junction5 as Connection217
                            connect wt Junction4 as Connection212

                            f = "f"

                            mask {
                                description = "Simple PLL with wrapped wt"

                                Kp {
                                    label = "Proportional gain"
                                    widget = edit
                                    type = generic
                                    default_value = "100"
                                }

                                Ki {
                                    label = "Integral gain"
                                    widget = edit
                                    type = generic
                                    default_value = "3200"
                                }

                                f {
                                    label = "Target frequency"
                                    widget = edit
                                    type = generic
                                    default_value = "60"
                                    unit = "Hz"
                                }

                                Ts {
                                    label = "Execution rate"
                                    widget = edit
                                    type = generic
                                    default_value = "Ts"
                                }

                                CODE open
                                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                                
                                    dialog = RegularComponentPropertiesDialog(
                                        component=component,
                                        property_container=component.masks[-1],
                                        current_diagram=current_diagram
                                    )
                                    dialog.exec_()
                                
                                ENDCODE
                            }
                        }
                        [
                            position = 8048, 8224
                            rotation = down
                            scale = -1, -1
                            size = 64, 136
                        ]

                        port f {
                            label = "f"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8280, 8248
                        ]

                        port wt {
                            label = "wt"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8152, 8272
                        ]

                        port Va {
                            label = "Va"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8176
                        ]

                        port Vb {
                            label = "Vb"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8224
                        ]

                        port Vc {
                            label = "Vc"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8272
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8392, 8224
                        ]

                        connect LPF_Vt.in PLL.Vt as Connection12
                        connect LPF_f.in PLL.f as Connection10
                        connect PLL.A Va as Connection1
                        connect PLL.C Vc as Connection3
                        connect Term.in PLL.d as Connection7
                        connect Term1.in PLL.q as Connection8
                        connect Vb PLL.B as Connection2
                        connect Vt LPF_Vt.out as Connection11
                        connect f LPF_f.out as Connection9
                        connect wt PLL.wt as Connection6

                        fc_f = "10.0"
                        fc_vt = "10.0"

                        mask {
                            fc_vt {
                                label = "Vt channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            fc_f {
                                label = "f channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8184, 8024
                        size = 72, 120
                    ]

                    port f_Gen {
                        label = "f_Gen"
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8208
                    ]

                    port f_Grid {
                        label = "f_Grid"
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 7984
                    ]

                    port Vgrid {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8064
                    ]

                    port Vgen {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8288
                    ]

                    port V_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7888
                    ]

                    port V_Gen {
                        label = "V_Gen"
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8416
                    ]

                    port "Phase diff" {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8544, 8216
                    ]

                    tag From2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8352, 8208
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8288, 8024
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction15 sp
                    [
                        position = 8400, 8208
                    ]

                    junction Junction23 sp
                    [
                        position = 8264, 8064
                    ]

                    junction Junction27 sp
                    [
                        position = 8400, 8248
                    ]

                    junction Junction28 sp
                    [
                        position = 8160, 8288
                    ]

                    connect From2 Junction15 as Connection270
                    connect Gain1.out f_Gen as Connection342
                    connect Gain1.in split1.out as Connection349
                    connect Junction15 Sum1.in as Connection271
                    connect Junction23 V_grid.in as Connection329
                    connect Junction27 Sum1.in1 as Connection352
                    connect Junction28 V_gen.in as Connection356
                    connect PLL_Grid.wt Goto2 as Connection294
                    connect PLL_Grid.Vt Junction23 as Connection328
                    connect PLL_Grid.Vb split.out1 as Connection324
                    connect "Phase diff" Sum1.out as Connection336
                    connect V_Grid split.in as Connection134
                    connect Vgen Junction28 as Connection355
                    connect Vgrid Junction23 as Connection330
                    connect f_Grid PLL_Grid.f as Connection327
                    connect split.out2 PLL_Grid.Vc as Connection322
                    connect split.out PLL_Grid.Va as Connection325
                    connect split1.out1 Junction27 as Connection353
                    connect split1.out2 Junction28 as Connection357
                    connect split1.in V_Gen as Connection348
                    connect wt_gen.in Junction27 as Connection351
                    connect wt_grid.in Junction15 as Connection272
                }
                [
                    position = 8288, 8136
                    size = 104, 360
                ]

                component Subsystem Calculate_dw_synch {
                    layout = dynamic
                    component "core/Discrete Transfer Function" LPF_dw {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8200, 8104
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8456, 8120
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8384, 8136
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8400, 8040
                        hide_name = True
                    ]

                    component "core/Gain" dw_K {
                        gain = "dw_K"
                    }
                    [
                        position = 8272, 8104
                    ]

                    component "core/Sum" Sum4 {
                    }
                    [
                        position = 8112, 8104
                        hide_name = True
                    ]

                    port dw_f {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8048
                    ]

                    port dw_phase {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8112
                    ]

                    port dw_synch {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8528, 8120
                    ]

                    port Activate {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8328, 8040
                    ]

                    connect Sum4.out LPF_dw.in as Connection240
                    connect Sum4.in1 dw_phase as Connection231
                    connect "Unit Delay1.in" Activate as Connection180
                    connect "Unit Delay1.out" "Signal switch1.in2" as Connection181
                    connect dw_K.in LPF_dw.out as Connection241
                    connect dw_K.out "Signal switch1.in" as Connection242
                    connect dw_f Sum4.in as Connection239
                    connect dw_synch "Signal switch1.out" as Connection177
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8952, 8216
                    size = 128, 208
                ]

                component Subsystem check_f_diff {
                    layout = dynamic
                    component "core/Gain" Freq_diff {
                        gain = "delta_f/100.0"
                    }
                    [
                        position = 8208, 8256
                    ]

                    component "core/Gain" toPU {
                        gain = "[1.0/(2.0*f)]"
                    }
                    [
                        position = 8216, 8152
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8152
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8208, 8216
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "f"
                    }
                    [
                        position = 8120, 8256
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8280, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Discrete Transfer Function" LPF_dwf {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8128, 8152
                    ]

                    component "core/Probe" f_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    port dw_f {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8152
                    ]

                    port f_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8144
                    ]

                    port f_Gen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8160
                    ]

                    port f_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8224
                    ]

                    junction Junction1 sp
                    [
                        position = 8168, 8152
                    ]

                    connect Abs3.in Junction1 as Connection7
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Comparator1.out f_match as Connection59
                    connect Constant1.out Freq_diff.in as Connection14
                    connect Freq_diff.out Comparator1.in1 as Connection17
                    connect Junction1 LPF_dwf.out as Connection61
                    connect LPF_dwf.in Sum1.out as Connection62
                    connect Sum1.in1 f_Gen as Connection60
                    connect Sum1.in f_Grid as Connection57
                    connect f_diff.in Junction1 as Connection56
                    connect toPU.in Junction1 as Connection40
                    connect toPU.out dw_f as Connection63
                }
                [
                    position = 8520, 8176
                    size = 144, 120
                ]

                component Subsystem check_phase_diff {
                    layout = dynamic
                    component "core/Abs" Abs2 {
                    }
                    [
                        position = 8064, 8096
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" phase_filter {
                    }
                    [
                        position = 8112, 8040
                    ]

                    component "core/Probe" phase_diff {
                    }
                    [
                        position = 7992, 7928
                        rotation = left
                    ]

                    component "core/Discrete Transfer Function" LPF {
                        a_coeff = "[1.0/(2*np.pi*0.5),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8032, 7976
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8024, 8160
                    ]

                    component "core/Gain" Phase_diff {
                        gain = "delta_phi*np.pi/180.0"
                    }
                    [
                        position = 8088, 8160
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8384, 7968
                        hide_name = True
                    ]

                    component "core/C function" confine_phase {
                        init_fnc = "/*Begin code section*/
dtheta = 0;
dtheta_confined = 0;
/*End code section*/"
                        input_terminals = "real dtheta;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        output_fnc = "/*Begin code section*/
if (dtheta > 3.14159265359) {//confine theta to +/- 2*pi;
    dtheta_confined = dtheta - 6.28318530718;
}
else{
    if (dtheta < -3.14159265359){
        dtheta_confined = dtheta + 6.28318530718;
    }
    else{
        dtheta_confined = dtheta;
    }
}
/*End code section*/"
                        output_terminals = "real dtheta_confined;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7776, 7976
                        size = 0, 0
                    ]

                    component "core/Comparator" Comparator2 {
                    }
                    [
                        position = 8160, 8152
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" to_pu {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 7976
                    ]

                    component "core/C function" offset_phase {
                        global_variables = "real off1;real off2;"
                        init_fnc = "/*Begin code section*/
phase_out = 0;
off1 = execution_rate*6.2831853071*f;
off2 = phaseOff*3.141592653589793/180.0;
/*End code section*/"
                        input_terminals = "inherit phase;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "[(\'phase\', True)]"
                        output_fnc = "/*Begin code section*/
phase_out = phase - off1 + off2;
/*End code section*/"
                        output_terminals = "real phase_out;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                        output_terminals_show_labels = "[(\'phase_out\', True)]"
                        parameters = "real f;real phaseOff;"
                    }
                    [
                        position = 7888, 7976
                        size = 0, 0
                    ]

                    component Subsystem Counter {
                        layout = dynamic
                        component "core/Logical operator" not {
                            operator = "NOT"
                        }
                        [
                            position = 8104, 8248
                        ]

                        component "core/C function" c_function {
                            input_terminals = "real counter;"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
if(counter>=0.1/execution_rate){
    out = 1;
}
else{
    out = 0;
}
/*End code section*/"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8288, 8200
                            size = 0, 0
                        ]

                        component "core/Counter" Counter1 {
                        }
                        [
                            position = 8192, 8200
                            size = 48, 48
                        ]

                        port In {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8008, 8192
                        ]

                        port Out {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8368, 8200
                        ]

                        junction Junction14 sp
                        [
                            position = 8056, 8192
                        ]

                        connect Counter1.en Junction14 as Connection559
                        connect Junction14 In as Connection562
                        connect Junction14 not.in as Connection560
                        connect c_function.counter Counter1.out as Connection563
                        connect c_function.out Out as Connection564
                        connect not.out Counter1.reset as Connection88
                    }
                    [
                        position = 8256, 8152
                        size = 48, 48
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Limit" Limit1 {
                            lower_limit = "phase_lowLim"
                            upper_limit = "phase_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Ki {
                            gain = "phase_Ki"
                        }
                        [
                            position = 7984, 8216
                        ]

                        component "core/Gain" Kp {
                            gain = "phase_Kp"
                        }
                        [
                            position = 8032, 8168
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "phase_lowLim"
                            limit_upper = "phase_upLim"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7912, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7952, 8168
                        ]

                        connect In Junction4 as Connection57
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8240, 7976
                        size = 64, 48
                    ]

                    port phase_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8152
                    ]

                    port Activate {
                        position = bottom:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 7864
                        rotation = left
                        scale = 1, -1
                    ]

                    port dw_phase {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8464, 7968
                    ]

                    port phase_Diff {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7688, 7976
                    ]

                    junction Junction15 sp
                    [
                        position = 8064, 7976
                    ]

                    junction Junction17 sp
                    [
                        position = 8064, 8040
                    ]

                    junction Junction21 sp
                    [
                        position = 8240, 7912
                    ]

                    junction Junction22 sp
                    [
                        position = 7992, 7976
                    ]

                    connect Abs2.in Junction17 as Connection590
                    connect Activate Junction21 as Connection622
                    connect Comparator2.in2 Abs2.out as Connection712
                    connect Comparator2.out Counter.In as Connection674
                    connect Junction15 LPF.out as Connection582
                    connect Junction17 Junction15 as Connection591
                    connect Junction21 PI.Reset as Connection693
                    connect Junction21 Product1.in as Connection623
                    connect Junction22 LPF.in as Connection732
                    connect One.out Phase_diff.in as Connection15
                    connect Phase_diff.out Comparator2.in1 as Connection49
                    connect Product1.in1 PI.Out as Connection692
                    connect confine_phase.dtheta phase_Diff as Connection721
                    connect dw_phase Product1.out as Connection714
                    connect offset_phase.phase_out Junction22 as Connection733
                    connect offset_phase.phase confine_phase.dtheta_confined as Connection734
                    connect phase_diff.in Junction22 as Connection731
                    connect phase_filter.in Junction17 as Connection592
                    connect phase_match Counter.Out as Connection673
                    connect to_pu.in Junction15 as Connection581
                    connect to_pu.out PI.In as Connection713
                }
                [
                    position = 8528, 8328
                    size = 168, 112
                ]

                component Subsystem Contactor_Control {
                    layout = dynamic
                    component "core/Digital Probe" GCB_cmd {
                    }
                    [
                        position = 8256, 8224
                        rotation = left
                    ]

                    component "core/C function" wait_to_trip {
                        global_variables = "real time_acc;"
                        init_fnc = "/*Begin code section*/
time_acc = 0;
Trip = 0;
/*End code section*/"
                        input_terminals = "inherit boolean;inherit Reset;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(time_acc>=3.0){
    Trip = 1;
}
else{
    time_acc += execution_rate*boolean;
}
if(Reset ==1){
    time_acc = 0;
    Trip = 0;
}
/*End code section*/"
                        output_terminals = "real Trip;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7616, 8296
                        size = 48, 48
                    ]

                    component "core/Digital Probe" GCB_control {
                    }
                    [
                        position = 7848, 8248
                        rotation = left
                    ]

                    component "core/Constant" Close {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7992, 8248
                    ]

                    component "core/Logical operator" not {
                        operator = "NOT"
                    }
                    [
                        position = 7968, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8072, 8280
                        hide_name = True
                    ]

                    component "core/Logical operator" or {
                        operator = "OR"
                    }
                    [
                        position = 8072, 8400
                        hide_name = True
                    ]

                    component "core/SR Flip Flop" "SR Flip Flop1" {
                    }
                    [
                        position = 8168, 8296
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                        inputs = "5"
                    }
                    [
                        position = 7792, 8296
                    ]

                    component "core/Termination" Termination12 {
                    }
                    [
                        position = 8248, 8312
                        hide_name = True
                    ]

                    component "core/Bus Split" "Bus Split1" {
                        outputs = "3"
                    }
                    [
                        position = 7488, 8032
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Edge Detection" "Edge Detection1" {
                    }
                    [
                        position = 7536, 8320
                        hide_name = True
                        size = 32, 32
                    ]

                    port ss_speed {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8200
                        rotation = right
                    ]

                    port phase_match {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8232
                        rotation = right
                    ]

                    port Gen_on {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8368
                    ]

                    port f_match {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8432
                        rotation = left
                    ]

                    port GCB {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8304, 8280
                    ]

                    port GCB_Control {
                        position = top:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7488, 7960
                        rotation = right
                    ]

                    port V_match {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8408
                        rotation = left
                    ]

                    tag Goto31 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto30 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8096
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From36 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7432, 8288
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto29 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8072
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From35 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7888, 8432
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From34 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8000, 8184
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction32 sp
                    [
                        position = 8256, 8280
                    ]

                    junction Junction34 sp
                    [
                        position = 7848, 8296
                    ]

                    junction Junction35 sp
                    [
                        position = 7488, 8288
                    ]

                    connect "Bus Split1.in" GCB_Control as Connection541
                    connect "Bus Split1.out" Goto29 as Connection542
                    connect Close.out "Signal switch1.in" as Connection129
                    connect "Edge Detection1.In1" Junction35 as Connection559
                    connect From34 "Signal switch1.in2" as Connection534
                    connect From35 or.in1 as Connection535
                    connect GCB_cmd.in Junction32 as Connection528
                    connect Gen_on not.in as Connection517
                    connect Goto30 "Bus Split1.out1" as Connection543
                    connect Goto31 "Bus Split1.out2" as Connection544
                    connect Junction32 GCB as Connection529
                    connect Junction34 GCB_control.in as Connection551
                    connect Junction35 From36 as Connection560
                    connect "SR Flip Flop1.out" Junction32 as Connection530
                    connect "Signal switch1.in1" Junction34 as Connection550
                    connect "Signal switch1.out" "SR Flip Flop1.s_in" as Connection527
                    connect Termination12.in "SR Flip Flop1.out_n" as Connection55
                    connect V_match and.in4 as Connection557
                    connect and.out Junction34 as Connection552
                    connect f_match and.in3 as Connection556
                    connect or.out "SR Flip Flop1.r_in" as Connection501
                    connect or.in not.out as Connection499
                    connect phase_match and.in1 as Connection554
                    connect ss_speed and.in as Connection553
                    connect wait_to_trip.Reset "Edge Detection1.Out1" as Connection562
                    connect wait_to_trip.boolean Junction35 as Connection561
                    connect wait_to_trip.Trip and.in2 as Connection555
                }
                [
                    position = 9280, 8392
                    size = 176, 168
                ]

                component Subsystem Output {
                    layout = dynamic

                    port GCB_status {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "GCB_status"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto7 GCB_status as Connection630
                }
                [
                    position = 9392, 8624
                    size = 48, 48
                ]

                port V_grid {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 7976
                ]

                port GCB {
                    position = bottom:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9464, 8392
                ]

                port To_Gen_Control {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9248, 8104
                ]

                port From_Gen_Control {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8512, 8512
                ]

                port V_gen {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 8296
                ]

                tag From42 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7944
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8656, 8056
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto25 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8608
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8328
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8664, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto28 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8456
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8824, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From48 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8456, 7936
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto31 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9176, 8512
                    hide_name = True
                    size = 60, 20
                ]

                tag From44 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9280, 8240
                    rotation = right
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto29 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8792, 8664
                    hide_name = True
                    size = 60, 20
                ]

                tag From53 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From55 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8784, 8016
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8672
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7968
                    hide_name = True
                    size = 60, 20
                ]

                tag From37 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto30 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From39 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9296, 8624
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8632
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto20 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9480, 8352
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto22 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8680, 8216
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction26 sp
                [
                    position = 9424, 8392
                ]

                junction Junction32 sp
                [
                    position = 9056, 8216
                ]

                junction Junction34 sp
                [
                    position = 8744, 8136
                ]

                junction Junction35 sp
                [
                    position = 8624, 8216
                ]

                junction Junction39 sp
                [
                    position = 9120, 8536
                ]

                junction Junction40 sp
                [
                    position = 8728, 8016
                ]

                junction Junction41 sp
                [
                    position = 8608, 7976
                ]

                junction Junction42 sp
                [
                    position = 9160, 8328
                ]

                junction Junction43 sp
                [
                    position = 8616, 8680
                ]

                junction Junction44 sp
                [
                    position = 8744, 8296
                ]

                junction Junction45 sp
                [
                    position = 8720, 8360
                ]

                junction Junction46 sp
                [
                    position = 8528, 8440
                ]

                connect "Bus Join2.in1" "Bus Split1.out2" as Connection601
                connect "Bus Join2.in" "Bus Split1.out1" as Connection600
                connect "Bus Join2.in2" Junction43 as Connection603
                connect "Bus Split1.in" From_Gen_Control as Connection598
                connect "Bus Split1.out" Goto25 as Connection546
                connect Check_phase_ON.in Junction46 as Connection622
                connect Contactor_Control.ss_speed Junction42 as Connection594
                connect Contactor_Control.phase_match Junction45 as Connection618
                connect From37 Contactor_Control.f_match as Connection270
                connect From39 Contactor_Control.Gen_on as Connection271
                connect From40 Junction42 as Connection596
                connect From41 "Bus Join.in1" as Connection528
                connect From42 "Bus Join.in" as Connection527
                connect From44 Contactor_Control.GCB_Control as Connection541
                connect From47 Calculate_dw_synch.Activate as Connection556
                connect From48 check_V_diff.Activate as Connection586
                connect From49 "Bus Join.in2" as Connection569
                connect From50 Contactor_Control.V_match as Connection574
                connect From52 and2.in3 as Connection584
                connect From53 and1.in1 as Connection585
                connect From55 and2.in4 as Connection609
                connect From56 Output.GCB_status as Connection625
                connect GCB Junction26 as Connection141
                connect Goto20 Junction26 as Connection143
                connect Goto28 Junction32 as Connection250
                connect Goto29 "Bus Join2.out" as Connection540
                connect Goto30 Junction43 as Connection605
                connect Goto31 Junction39 as Connection561
                connect Goto32 Junction41 as Connection575
                connect Goto33 Junction40 as Connection571
                connect Goto34 "Bus Split1.out4" as Connection606
                connect Goto36 check_V_diff.Grid_On as Connection608
                connect Junction26 Contactor_Control.GCB as Connection204
                connect Junction32 Calculate_dw_synch.dw_synch as Connection249
                connect Junction34 Calculate_dw_synch.dw_f as Connection280
                connect Junction35 Goto22 as Connection283
                connect Junction39 and2.out as Connection562
                connect Junction40 check_V_diff.V_match as Connection572
                connect Junction41 check_V_diff.dV as Connection576
                connect Junction42 Speed_ss.in as Connection595
                connect Junction43 "Bus Split1.out3" as Connection604
                connect Junction44 Calculate_dw_synch.dw_phase as Connection616
                connect Junction45 Phase_match.in as Connection619
                connect Junction46 and1.out as Connection623
                connect To_Gen_Control "Bus Join.out" as Connection259
                connect V_gen PLLs.V_Gen as Connection587
                connect V_grid PLLs.V_Grid as Connection588
                connect V_match.in Junction40 as Connection573
                connect and1.in From30 as Connection273
                connect and2.in1 From45 as Connection553
                connect and2.in2 From46 as Connection554
                connect and2.in not.out as Connection552
                connect check_V_diff.Vgen PLLs.Vgen as Connection565
                connect check_V_diff.Vgrid PLLs.Vgrid as Connection566
                connect check_f_diff.dw_f Junction34 as Connection281
                connect check_f_diff.f_match Junction35 as Connection284
                connect check_f_diff.f_Grid PLLs.f_Grid as Connection278
                connect check_f_diff.f_Gen PLLs.f_Gen as Connection277
                connect check_phase_diff.dw_phase Junction44 as Connection617
                connect check_phase_diff.phase_match Junction45 as Connection620
                connect check_phase_diff.Activate Junction46 as Connection624
                connect check_phase_diff.phase_Diff "PLLs.Phase diff" as Connection621
                connect dV.in Junction41 as Connection577
                connect dw_f.in Junction34 as Connection279
                connect dw_phase.in Junction44 as Connection615
                connect dw_synch.in Junction32 as Connection248
                connect dw_synch_ON.in Junction39 as Connection563
                connect f_match.in Junction35 as Connection282
                connect not.in From33 as Connection551
            }
            [
                position = 9448, 8056
                scale = -1, 1
                size = 144, 200
            ]

            component Subsystem Output {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "14"
                }
                [
                    position = 8008, 8216
                    rotation = down
                    hide_name = True
                    scale = -1, -1
                ]

                port Output {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8112, 8216
                ]

                tag From32 {
                    value = "GCB_status"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7680, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "w_meas"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7656, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Gen_On"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7632, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7872, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7776, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7920, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7728, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From22 {
                    value = "Vc"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7752, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7704, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7896, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7800, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                connect "Bus Join1.out" Output as Connection4
                connect From21 "Bus Join1.in8" as Connection572
                connect From22 "Bus Join1.in5" as Connection569
                connect From23 "Bus Join1.in4" as Connection568
                connect From24 "Bus Join1.in7" as Connection571
                connect From25 "Bus Join1.in3" as Connection567
                connect From26 "Bus Join1.in9" as Connection573
                connect From27 "Bus Join1.in13" as Connection577
                connect From28 "Bus Join1.in12" as Connection576
                connect From29 "Bus Join1.in11" as Connection575
                connect From30 "Bus Join1.in10" as Connection574
                connect From31 "Bus Join1.in6" as Connection570
                connect From32 "Bus Join1.in2" as Connection578
                connect From33 "Bus Join1.in1" as Connection580
                connect From34 "Bus Join1.in" as Connection579
            }
            [
                position = 9696, 7968
                size = 104, 96
            ]

            component Subsystem Measurements {
                layout = dynamic
                component "core/Gain" Gain8 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7568
                    hide_name = True
                ]

                component "core/Probe" e_f {
                }
                [
                    position = 7760, 7776
                ]

                component "core/Gain" Gain7 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7632
                    hide_name = True
                ]

                component "core/Bus Join" "Bus Join3" {
                    inputs = "3"
                }
                [
                    position = 8080, 7792
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Bus Join" "Bus Join1" {
                    inputs = "4"
                }
                [
                    position = 8016, 7544
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Probe" pf {
                    addr = "17951"
                }
                [
                    position = 7704, 7696
                ]

                component "core/Probe" P {
                    addr = "17965"
                }
                [
                    position = 7704, 7504
                ]

                component "core/Probe" Q {
                    addr = "17938"
                }
                [
                    position = 7704, 7568
                ]

                component "core/Probe" S {
                    addr = "17951"
                }
                [
                    position = 7704, 7632
                ]

                component "core/Gain" Gain10 {
                    gain = "1.0/(2*np.pi*f)"
                }
                [
                    position = 7696, 7776
                    hide_name = True
                ]

                component "core/Gain" Gain9 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7504
                    hide_name = True
                ]

                component "core/Current Measurement" Ib {
                    addr = "24"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8176
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Current Measurement" Ic {
                    addr = "26"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8272
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7944, 8336
                    rotation = right
                    size = 64, 32
                ]

                component "core/Current Measurement" Ia {
                    addr = "22"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8080
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7856, 8432
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7904, 8384
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Output {
                    layout = dynamic

                    port Va {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8120
                    ]

                    port Vb {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8152
                    ]

                    port Vc {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8192
                    ]

                    port Vt {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8224
                    ]

                    port Ia {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8264
                    ]

                    port Ib {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8296
                    ]

                    port Ic {
                        position = left:7
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8336
                    ]

                    port P {
                        position = left:8
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8368
                    ]

                    port Q {
                        position = left:9
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8408
                    ]

                    port S {
                        position = left:10
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8440
                    ]

                    port pf {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8480
                    ]

                    tag Goto8 {
                        value = "Vb"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8152
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto9 {
                        value = "Vc"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8192
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto10 {
                        value = "Vt"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8224
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto11 {
                        value = "Ib"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8296
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto12 {
                        value = "P"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8368
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto13 {
                        value = "Ic"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8336
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto14 {
                        value = "Ia"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8264
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto15 {
                        value = "Q"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8408
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto16 {
                        value = "S"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto17 {
                        value = "pf"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8480
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto7 {
                        value = "Va"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto10 Vt as Connection4
                    connect Goto13 Ic as Connection7
                    connect Goto14 Ia as Connection5
                    connect Goto15 Q as Connection9
                    connect Goto17 pf as Connection11
                    connect Goto8 Vb as Connection2
                    connect Goto9 Vc as Connection3
                    connect Ib Goto11 as Connection6
                    connect P Goto12 as Connection8
                    connect S Goto16 as Connection10
                    connect Va Goto7 as Connection1
                }
                [
                    position = 8416, 7720
                    size = 96, 328
                ]

                component Subsystem "PQ measure" {
                    layout = dynamic
                    component "core/Power Meter" "PQ Power Meter1" {
                    }
                    [
                        position = 8096, 8192
                    ]

                    component "core/Termination" Termination2 {
                    }
                    [
                        position = 8264, 8232
                        rotation = left
                        hide_name = True
                        scale = -1, -1
                    ]

                    component "core/Termination" Termination1 {
                    }
                    [
                        position = 8264, 8152
                        rotation = left
                        hide_name = True
                        scale = -1, 1
                    ]

                    port S {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8264
                        rotation = right
                        scale = -1, 1
                    ]

                    port pf {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8288
                        rotation = right
                        scale = -1, 1
                    ]

                    port Q {
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8120
                        rotation = left
                        scale = -1, 1
                    ]

                    port P {
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8088
                        rotation = left
                        scale = -1, 1
                    ]

                    port Va {
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8088
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vb {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8120
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vc {
                        position = right:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8152
                        rotation = right
                        scale = -1, 1
                    ]

                    port Ia {
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8224
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ib {
                        position = right:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8256
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ic {
                        position = right:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8288
                        rotation = left
                        scale = -1, 1
                    ]

                    connect "PQ Power Meter1.ia" Ia as Connection1
                    connect "PQ Power Meter1.ib" Ib as Connection2
                    connect "PQ Power Meter1.ic" Ic as Connection3
                    connect "PQ Power Meter1.Pdc" P as Connection4
                    connect "PQ Power Meter1.Qdc" Q as Connection5
                    connect S "PQ Power Meter1.apparent" as Connection9
                    connect Termination1.in "PQ Power Meter1.Pac" as Connection10
                    connect Termination2.in "PQ Power Meter1.Qac" as Connection11
                    connect Va "PQ Power Meter1.va" as Connection13
                    connect Vb "PQ Power Meter1.vb" as Connection14
                    connect Vc "PQ Power Meter1.vc" as Connection15
                    connect pf "PQ Power Meter1.k_factor" as Connection12
                }
                [
                    position = 7424, 7600
                    scale = -1, 1
                    size = 128, 232
                ]

                component Subsystem 3ph_PLL_Gen {
                    layout = dynamic
                    component "core/Termination" Term {
                    }
                    [
                        position = 8080, 8144
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Termination" Term1 {
                    }
                    [
                        position = 8112, 8184
                        rotation = left
                        hide_name = True
                    ]

                    component Subsystem PLL {
                        layout = dynamic
                        component "core/Rate Limiter" "Rate Limiter1" {
                            falling_limit = "2*np.pi*w_fall"
                            rising_limit = "2*np.pi*w_rise"
                        }
                        [
                            position = 8304, 7984
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q1 {
                            a_coeff = "[1,2*zeta*(2*np.pi*fc_w),(2*np.pi*fc_w)**2.0]"
                            b_coeff = "(2*np.pi*fc_w)**2.0"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 7984
                            hide_name = True
                        ]

                        component "core/C function" integrator {
                            init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
out += execution_rate*in;
if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8352, 8136
                            size = 0, 0
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 7864, 8208
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Unit Delay" "Unit Delay1" {
                        }
                        [
                            position = 8432, 8224
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q {
                            a_coeff = "[1.0/(2*np.pi*fc_q),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7912, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_d {
                            a_coeff = "[1.0/(2*np.pi*fc_d),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7856, 8120
                            hide_name = True
                        ]

                        component Subsystem Normalize {
                            layout = dynamic
                            component "core/C function" V_terminal {
                                init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                input_terminals = "real d;inherit q;"
                                input_terminals_dimensions = "inherit;inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                input_terminals_show_labels = "False;False;"
                                output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                output_terminals = "real t;inherit q_pu;"
                                output_terminals_dimensions = "inherit;inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                output_terminals_show_labels = "False;False;"
                            }
                            [
                                position = 8192, 8192
                                size = 0, 0
                            ]

                            port d {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8152
                            ]

                            port q {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8216
                            ]

                            port q_pu {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8352, 8200
                            ]

                            port Vt {
                                position = top:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8280, 8104
                                rotation = left
                            ]

                            connect V_terminal.t Vt as Connection8
                            connect V_terminal.d d as Connection1
                            connect V_terminal.q q as Connection3
                            connect q_pu V_terminal.q_pu as Connection9
                        }
                        [
                            position = 8096, 8136
                            size = 64, 64
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8072, 8400
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "lowLim*2*np.pi*f/100.0"
                                upper_limit = "upLim*2*np.pi*f/100.0"
                            }
                            [
                                position = 8416, 8224
                            ]

                            component "core/Gain" Kp {
                                gain = "Kp"
                            }
                            [
                                position = 7928, 8136
                            ]

                            component "core/Integrator" Integrator2 {
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8112, 8304
                                scale = -1, 1
                            ]

                            component "core/Sum" Sum8 {
                                signs = "+-"
                            }
                            [
                                position = 8032, 8224
                            ]

                            component "core/Gain" Gain1 {
                                gain = "2*np.pi*fc_Kd"
                            }
                            [
                                position = 8152, 8224
                            ]

                            component "core/Gain" Ki {
                                gain = "Ki"
                            }
                            [
                                position = 7928, 8392
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "2*np.pi*f"
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8200, 8400
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8200, 8488
                                scale = -1, 1
                            ]

                            component "core/Gain" Kd {
                                gain = "Kd"
                            }
                            [
                                position = 7928, 8216
                            ]

                            component "core/Sum" Sum5 {
                                signs = "3"
                            }
                            [
                                position = 8328, 8224
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8328, 8488
                                scale = -1, 1
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7752, 8216
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8480, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8376, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8448, 8224
                            ]

                            junction Junction7 sp
                            [
                                position = 8224, 8224
                            ]

                            junction Junction8 sp
                            [
                                position = 7792, 8216
                            ]

                            junction Junction9 sp
                            [
                                position = 7792, 8216
                            ]

                            connect Gain1.out Junction7 as Connection85
                            connect Gain1.in Sum8.out as Connection61
                            connect In Junction9 as Connection94
                            connect Integrator1.out Sum5.in2 as Connection95
                            connect Integrator2.out Sum8.in1 as Connection66
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction7 Integrator2.in as Connection86
                            connect Junction8 Kd.in as Connection90
                            connect Junction9 Junction8 as Connection93
                            connect Kb.in Sum6.out as Connection50
                            connect Kd.out Sum8.in as Connection80
                            connect Ki.in Junction9 as Connection92
                            connect Kp.in Junction8 as Connection89
                            connect Kp.out Sum5.in as Connection68
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.out Junction2 as Connection44
                            connect Sum5.in1 Junction7 as Connection87
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                            connect Sum7.in Ki.out as Connection69
                        }
                        [
                            position = 8200, 8136
                            size = 64, 48
                        ]

                        component Subsystem ABC_dqz {
                            layout = dynamic
                            component "core/abc to alpha beta" "abc to alpha beta" {
                            }
                            [
                                position = 8024, 8192
                            ]

                            component "core/alpha beta to dq" "alpha beta to dq" {
                            }
                            [
                                position = 8248, 8192
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7952, 8104
                                rotation = right
                            ]

                            port B {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7904, 8104
                                rotation = right
                            ]

                            port C {
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7856, 8104
                                rotation = right
                            ]

                            port wt {
                                position = left:4
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8176, 8288
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8320, 8136
                                rotation = left
                            ]

                            port q {
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8368, 8136
                                rotation = left
                            ]

                            port z {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8096, 8288
                                rotation = right
                            ]

                            connect "abc to alpha beta.A" A as Connection2685
                            connect "abc to alpha beta.B" B as Connection2686
                            connect "abc to alpha beta.C" C as Connection2687
                            connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                            connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                            connect "alpha beta to dq.wt" wt as Connection2690
                            connect d "alpha beta to dq.d" as Connection2692
                            connect q "alpha beta to dq.q" as Connection2693
                            connect z "abc to alpha beta.gamma" as Connection2691
                        }
                        [
                            position = 7776, 8152
                            size = 48, 104
                        ]

                        port A {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7608, 8152
                            rotation = left
                        ]

                        port B {
                            label = "B"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8176
                            rotation = left
                        ]

                        port C {
                            label = "C"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7688, 8200
                            rotation = left
                        ]

                        port d {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8024
                        ]

                        port q {
                            label = "q"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8080
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8160, 8072
                        ]

                        port wt {
                            position = right:5
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8072
                        ]

                        port w {
                            position = right:4
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 7984
                        ]

                        junction Junction6 sp
                        [
                            position = 8408, 8136
                        ]

                        junction Junction13 sp
                        [
                            position = 8264, 8136
                        ]

                        junction Junction14 sp
                        [
                            position = 7960, 8120
                        ]

                        junction Junction15 sp
                        [
                            position = 8000, 8152
                        ]

                        connect ABC_dqz.A A as Connection266
                        connect ABC_dqz.B B as Connection267
                        connect ABC_dqz.C C as Connection268
                        connect ABC_dqz.d LPF_d.in as Connection263
                        connect ABC_dqz.q LPF_q.in as Connection264
                        connect ABC_dqz.z Term.in as Connection265
                        connect Junction13 integrator.in as Connection246
                        connect Junction14 Normalize.d as Connection253
                        connect Junction14 d as Connection262
                        connect Junction15 q as Connection261
                        connect Junction6 integrator.out as Connection195
                        connect LPF_d.out Junction14 as Connection254
                        connect LPF_q.out Junction15 as Connection257
                        connect LPF_q1.in "Rate Limiter1.out" as Connection259
                        connect Normalize.q Junction15 as Connection255
                        connect Normalize.Vt Vt as Connection211
                        connect PI.Out Junction13 as Connection247
                        connect PI.In Normalize.q_pu as Connection244
                        connect "Rate Limiter1.in" Junction13 as Connection260
                        connect "Unit Delay1.out" ABC_dqz.wt as Connection269
                        connect "Unit Delay1.in" Junction6 as Connection194
                        connect w LPF_q1.out as Connection258
                        connect wt Junction6 as Connection196

                        f = "f"
                        lowLim = "70"
                        upLim = "140"
                        w_fall = "-f/5"
                        w_rise = "f/5"

                        mask {
                            description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Simple PLL with wrapped wt</span></p></body></html>"

                            Kp {
                                label = "Proportional gain"
                                widget = edit
                                type = generic
                                default_value = "100.0"
                            }

                            Ki {
                                label = "Integral gain"
                                widget = edit
                                type = generic
                                default_value = "3200.0"
                            }

                            Kd {
                                label = "Differential gain"
                                widget = edit
                                type = generic
                                default_value = "1.0"
                            }

                            fc_Kd {
                                label = "Derivative control LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "113.6821"
                            }

                            fc_d {
                                label = "d channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            fc_q {
                                label = "q channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            f {
                                label = "Target frequency"
                                widget = edit
                                type = generic
                                default_value = "60.0"
                                unit = "Hz"
                            }

                            upLim {
                                label = "Frequency deviation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                unit = "%"
                            }

                            lowLim {
                                label = "Frequency deviation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                unit = "%"
                            }

                            zeta {
                                label = "w 2nd order LPF damping ratio"
                                widget = edit
                                type = generic
                                default_value = "0.707"
                            }

                            fc_w {
                                label = "w 2nd order LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "25.0"
                                unit = "Hz"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                            }

                            w_rise {
                                label = "w Rising rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            w_fall {
                                label = "w Falling rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 7984, 8240
                        rotation = down
                        scale = -1, -1
                        size = 72, 152
                    ]

                    port Va {
                        label = "Va"
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8184
                    ]

                    port Vb {
                        label = "Vb"
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8240
                    ]

                    port Vc {
                        label = "Vc"
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8296
                    ]

                    port Vt {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8136, 8240
                    ]

                    port w {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8104, 8264
                    ]

                    port wt {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8072, 8288
                    ]

                    connect PLL.d Term.in as Connection4
                    connect PLL.A Va as Connection1
                    connect PLL.C Vc as Connection3
                    connect PLL.Vt Vt as Connection6
                    connect PLL.wt wt as Connection8
                    connect Term1.in PLL.q as Connection5
                    connect Vb PLL.B as Connection2
                    connect w PLL.w as Connection7
                }
                [
                    position = 7480, 7824
                    size = 72, 120
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R21 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8232, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R20 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8304, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R22 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8376, 7944
                        rotation = right
                    ]

                    port G {
                        position = bottom:3
                        kind = pe
                    }
                    [
                        position = 8304, 8112
                        rotation = left
                    ]

                    port A {
                        position = top:4
                        kind = pe
                    }
                    [
                        position = 8232, 7848
                        rotation = right
                    ]

                    port B {
                        position = top:5
                        kind = pe
                    }
                    [
                        position = 8304, 7848
                        rotation = right
                    ]

                    port C {
                        position = top:6
                        kind = pe
                    }
                    [
                        position = 8376, 7848
                        rotation = right
                    ]

                    junction Junction1516 pe
                    [
                        position = 8304, 8032
                    ]

                    junction Junction1517 pe
                    [
                        position = 8304, 8032
                    ]

                    connect A R21.p_node as Connection758
                    connect B R20.p_node as Connection759
                    connect G Junction1517 as Connection764
                    connect Junction1516 Junction1517 as Connection762
                    connect Junction1516 R21.n_node as Connection755
                    connect Junction1517 R22.n_node as Connection763
                    connect R20.n_node Junction1516 as Connection698
                    connect R22.p_node C as Connection760
                }
                [
                    position = 7664, 8384
                    size = 88, 80
                ]

                port a {
                    label = "a"
                    position = right:1
                    kind = pe
                }
                [
                    position = 8208, 8080
                    rotation = down
                ]

                port b {
                    label = "b"
                    position = right:2
                    kind = pe
                }
                [
                    position = 8208, 8176
                    rotation = down
                ]

                port c {
                    label = "c"
                    position = right:3
                    kind = pe
                }
                [
                    position = 8208, 8272
                    rotation = down
                ]

                port A {
                    label = "A"
                    position = left:1
                    kind = pe
                }
                [
                    position = 7520, 8080
                ]

                port B {
                    label = "B"
                    position = left:2
                    kind = pe
                }
                [
                    position = 7520, 8176
                ]

                port C {
                    label = "C"
                    position = left:3
                    kind = pe
                }
                [
                    position = 7520, 8272
                ]

                port Sync_fb {
                    position = top:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8080, 7728
                    rotation = left
                    scale = -1, 1
                ]

                port Control_fb {
                    position = top:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8016, 7472
                    rotation = left
                    scale = -1, 1
                ]

                tag From22 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8032
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7608
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8384
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7600
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7672
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7624
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto11 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag From43 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag From32 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7632
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7704, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto5 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8136
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7912
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto8 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7520
                    hide_name = True
                    size = 60, 20
                ]

                tag From35 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7848
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7840
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto7 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7488
                    hide_name = True
                    size = 60, 20
                ]

                tag From42 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7744
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7792
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto6 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8232
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7816
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction1497 pe
                [
                    position = 7856, 8080
                ]

                junction Junction1518 sp
                [
                    position = 7520, 7504
                ]

                junction Junction1519 sp
                [
                    position = 7520, 7568
                ]

                junction Junction1520 sp
                [
                    position = 7520, 7632
                ]

                junction Junction1521 sp
                [
                    position = 7520, 7696
                ]

                junction Junction1525 pe
                [
                    position = 7904, 8176
                ]

                junction Junction1528 pe
                [
                    position = 7944, 8272
                ]

                junction Junction1534 pe
                [
                    position = 7904, 8504
                ]

                junction Junction1535 pe
                [
                    position = 7856, 8504
                ]

                junction Junction1536 pe
                [
                    position = 7640, 8080
                ]

                junction Junction1537 pe
                [
                    position = 7664, 8176
                ]

                junction Junction1538 pe
                [
                    position = 7688, 8272
                ]

                junction Junction1540 sp
                [
                    position = 7648, 7824
                ]

                connect 3ph_PLL_Gen.Va From42 as Connection925
                connect 3ph_PLL_Gen.Vt Goto11 as Connection924
                connect 3ph_PLL_Gen.w Junction1540 as Connection926
                connect B Junction1537 as Connection888
                connect "Bus Join1.in" From10 as Connection911
                connect "Bus Join1.in1" From11 as Connection908
                connect "Bus Join1.in2" From32 as Connection910
                connect C Junction1538 as Connection891
                connect Control_fb "Bus Join1.out" as Connection912
                connect From21 Output.Ib as Connection914
                connect From22 Output.Vc as Connection921
                connect From23 Output.Vb as Connection913
                connect From24 Output.Ia as Connection916
                connect From25 Output.Va as Connection918
                connect From26 Output.Ic as Connection920
                connect From27 Output.pf as Connection917
                connect From28 Output.S as Connection919
                connect From29 Output.Q as Connection922
                connect From30 Output.P as Connection915
                connect From31 Output.Vt as Connection923
                connect From33 "Bus Join3.in1" as Connection783
                connect From34 "Bus Join3.in2" as Connection784
                connect From35 "Bus Join3.in" as Connection782
                connect From4 "PQ measure.Va" as Connection714
                connect From40 3ph_PLL_Gen.Vc as Connection899
                connect From41 3ph_PLL_Gen.Vb as Connection898
                connect From43 "Bus Join1.in3" as Connection909
                connect From5 "PQ measure.Vc" as Connection716
                connect From6 "PQ measure.Vb" as Connection715
                connect From7 "PQ measure.Ia" as Connection717
                connect From8 "PQ measure.Ib" as Connection718
                connect From9 "PQ measure.Ic" as Connection719
                connect Gain10.in Junction1540 as Connection904
                connect Goto1 Va.out as Connection703
                connect Goto10 Junction1521 as Connection734
                connect Goto12 Junction1540 as Connection906
                connect Goto13 3ph_PLL_Gen.wt as Connection907
                connect Goto2 Vb.out as Connection705
                connect Goto3 Vc.out as Connection707
                connect Goto4 Ia.out as Connection708
                connect Goto5 Ib.out as Connection709
                connect Goto6 Ic.out as Connection710
                connect Goto7 Junction1518 as Connection725
                connect Goto8 Junction1519 as Connection728
                connect Goto9 Junction1520 as Connection731
                connect Ia.p_node a as Connection218
                connect Ib.p_node b as Connection212
                connect Ic.p_node c as Connection217
                connect Junction1497 Ia.n_node as Connection871
                connect Junction1497 Junction1536 as Connection885
                connect Junction1518 Gain9.in as Connection724
                connect Junction1519 Gain8.in as Connection727
                connect Junction1520 Gain7.in as Connection730
                connect Junction1521 "PQ measure.pf" as Connection733
                connect Junction1525 Ib.n_node as Connection870
                connect Junction1528 Ic.n_node as Connection867
                connect Junction1534 Junction1535 as Connection882
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Va.n_node as Connection883
                connect Junction1536 A as Connection886
                connect Junction1537 Junction1525 as Connection889
                connect Junction1538 Junction1528 as Connection892
                connect P.in Gain9.out as Connection158
                connect "PQ measure.P" Junction1518 as Connection723
                connect "PQ measure.Q" Junction1519 as Connection726
                connect "PQ measure.S" Junction1520 as Connection729
                connect Q.in Gain8.out as Connection161
                connect S.in Gain7.out as Connection192
                connect Snubber.G Junction1535 as Connection884
                connect Snubber.A Junction1536 as Connection887
                connect Snubber.B Junction1537 as Connection890
                connect Snubber.C Junction1538 as Connection893
                connect Sync_fb "Bus Join3.out" as Connection781
                connect Va.p_node Junction1497 as Connection487
                connect Vb.p_node Junction1525 as Connection833
                connect Vb.n_node Junction1534 as Connection839
                connect Vc.p_node Junction1528 as Connection806
                connect e_f.in Gain10.out as Connection824
                connect pf.in Junction1521 as Connection732
            }
            [
                position = 9248, 8320
                scale = -1, 1
                size = 112, 112
            ]

            component Subsystem Ggrid_meas {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "3"
                }
                [
                    position = 8744, 7984
                    rotation = left
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8336, 8168
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8248, 8264
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8296, 8216
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R1 {
                        resistance = "1e5"
                    }
                    [
                        position = 8120, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R2 {
                        resistance = "1e5"
                    }
                    [
                        position = 8192, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R3 {
                        resistance = "1e5"
                    }
                    [
                        position = 8264, 8144
                        rotation = right
                    ]

                    port G {
                        position = bottom:1
                        kind = pe
                    }
                    [
                        position = 8192, 8296
                        rotation = left
                    ]

                    port A {
                        position = top:1
                        kind = pe
                    }
                    [
                        position = 8120, 8064
                        rotation = right
                    ]

                    port B {
                        position = top:2
                        kind = pe
                    }
                    [
                        position = 8192, 8064
                        rotation = right
                    ]

                    port C {
                        position = top:3
                        kind = pe
                    }
                    [
                        position = 8264, 8064
                        rotation = right
                    ]

                    junction Junction1490 pe
                    [
                        position = 8192, 8248
                    ]

                    junction Junction1491 pe
                    [
                        position = 8192, 8248
                    ]

                    connect G Junction1491 as Connection403
                    connect Junction1490 R1.n_node as Connection395
                    connect Junction1491 Junction1490 as Connection402
                    connect R1.p_node A as Connection399
                    connect R2.p_node B as Connection397
                    connect R2.n_node Junction1490 as Connection385
                    connect R3.p_node C as Connection398
                    connect R3.n_node Junction1491 as Connection401
                }
                [
                    position = 8104, 8248
                    size = 64, 48
                ]

                port V {
                    position = top:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8744, 7912
                    rotation = left
                ]

                port A {
                    position = left:1
                    kind = pe
                }
                [
                    position = 7992, 7912
                ]

                port B {
                    position = left:2
                    kind = pe
                }
                [
                    position = 7992, 8016
                ]

                port C {
                    position = left:3
                    kind = pe
                }
                [
                    position = 7992, 8120
                ]

                port a {
                    position = right:1
                    kind = pe
                }
                [
                    position = 8504, 7912
                    rotation = down
                ]

                port b {
                    position = right:2
                    kind = pe
                }
                [
                    position = 8504, 8016
                    rotation = down
                ]

                port c {
                    position = right:3
                    kind = pe
                }
                [
                    position = 8504, 8120
                    rotation = down
                ]

                tag From1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8040
                    hide_name = True
                    size = 0, 0
                ]

                tag From2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8080
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8216
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8264
                    hide_name = True
                    size = 0, 0
                ]

                tag From3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8120
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8168
                    hide_name = True
                    size = 0, 0
                ]

                junction Junction1492 pe
                [
                    position = 8088, 7912
                ]

                junction Junction1493 pe
                [
                    position = 8104, 8016
                ]

                junction Junction1494 pe
                [
                    position = 8120, 8120
                ]

                junction Junction1534 pe
                [
                    position = 8296, 8336
                ]

                junction Junction1535 pe
                [
                    position = 8336, 8120
                ]

                junction Junction1536 pe
                [
                    position = 8296, 8016
                ]

                junction Junction1537 pe
                [
                    position = 8248, 7912
                ]

                junction Junction1538 pe
                [
                    position = 8248, 8336
                ]

                connect A Junction1492 as Connection402
                connect B Junction1493 as Connection405
                connect "Bus Join1.in1" From2 as Connection431
                connect "Bus Join1.in2" From3 as Connection432
                connect C Junction1494 as Connection408
                connect From1 "Bus Join1.in" as Connection430
                connect Goto4 Va.out as Connection703
                connect Goto5 Vc.out as Connection707
                connect Goto6 Vb.out as Connection705
                connect Junction1492 Junction1537 as Connection855
                connect Junction1492 Snubber.A as Connection412
                connect Junction1493 Junction1536 as Connection852
                connect Junction1493 Snubber.B as Connection410
                connect Junction1494 Snubber.C as Connection411
                connect Junction1534 Junction1538 as Connection858
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Junction1494 as Connection850
                connect Junction1536 b as Connection853
                connect Junction1537 a as Connection856
                connect Junction1538 Va.n_node as Connection859
                connect Snubber.G Junction1538 as Connection860
                connect V "Bus Join1.out" as Connection366
                connect Va.p_node Junction1537 as Connection857
                connect Vb.n_node Junction1534 as Connection839
                connect Vb.p_node Junction1536 as Connection854
                connect Vc.p_node Junction1535 as Connection851
                connect c Junction1535 as Connection849
            }
            [
                position = 9608, 8320
                scale = -1, 1
                size = 56, 232
            ]

            component "core/Bus Split" bus_split {
            }
            [
                position = 8888, 8112
            ]

            port A {
                position = 180.0, -96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8224
                scale = -1, 1
            ]

            port B {
                position = 180.0, -0.1
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8320
                scale = -1, 1
            ]

            port C {
                position = 180.0, 96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8416
                scale = -1, 1
            ]

            port Inputs {
                position = -152.0, -120.0
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 9088, 7896
                rotation = right
                scale = -1, 1
            ]

            port Outputs {
                position = 152.0, -120.0
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 9816, 7920
                rotation = left
            ]

            junction Junction118 pe
            [
                position = 8800, 8240
            ]

            junction Junction122 pe
            [
                position = 8800, 8408
            ]

            connect A Ggrid_meas.A as Connection669
            connect B Ggrid_meas.B as Connection670
            connect C Ggrid_meas.C as Connection671
            connect Control.T_out Gen.load_in as Connection611
            connect Control.To_synch_check Sync_Check.From_Gen_Control as Connection673
            connect Gen.r_2 Junction122 as Connection664
            [
                position = 0, 0
                breakpoints = 8864, 8336; 8864, 8408
            ]
            connect Gen.c_in Measurements.c as Connection323
            connect Gen.b_in Measurements.b as Connection318
            connect Gen.a_in Measurements.a as Connection324
            connect Ggrid_meas.b MCB.b_in as Connection481
            connect Ggrid_meas.c MCB.c_in as Connection483
            connect Ggrid_meas.a MCB.a_in as Connection479
            connect If.n_node Junction118 as Connection601
            connect Inputs Control.Inputs as Connection668
            connect Junction118 Gen.r_1 as Connection600
            [
                position = 0, 0
                breakpoints = 8864, 8240; 8864, 8304
            ]
            connect Junction122 Vfield.n_node as Connection665
            connect Measurements.Control_fb Control.Meas_feedback as Connection500
            connect Measurements.B MCB.b_out as Connection613
            connect Measurements.C MCB.c_out as Connection614
            connect Measurements.A MCB.a_out as Connection612
            connect Output.Output Outputs as Connection667
            connect Sync_Check.To_Gen_Control Control.From_synch_check as Connection672
            connect Sync_Check.V_grid Ggrid_meas.V as Connection638
            connect Sync_Check.GCB MCB.ctrl_in as Connection637
            connect Sync_Check.V_gen Measurements.Sync_fb as Connection636
            connect Vfd.in Control.Vf_out as Connection649
            connect Vfd.p_node If.p_node as Connection663
            connect Vfd.n_node Junction122 as Connection666
            connect Vfield.p_node Junction118 as Connection599
            connect Gen.out bus_split.in as Connection674
            [
                position = 0, 0
                breakpoints = 8848, 8232; 8848, 8160
            ]
            connect bus_split.out Control.T_in as Connection675
            connect bus_split.out1 Control.wmeas as Connection676

            Sb = "1e6"
            Ts = "Ts"
            Vn = "480"
            phaseOff = "0.0"

            mask {
                icon = "image(\'diesel_genset.svg\')"
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Diesel Genset with synchronous machine, DEGOV governor, DC4B exciter, frequency setpoint control for w and P, power factor control loop and synch check with grid to close GCB contactor.</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of variable inputs to this block is 9 and they must be sent through a Bus Join in the following order: 0 - Gen_On; 1 - Vref; 2 - wref; 3 - Pref; 4 - pf_ref; 5 - Gen_OP_mode; 6 - Gen_Control_Mode; 7 - Load_share_on; 8 - Load_share.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                                                                                                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of outputs of this block is 14 and they are arranged in the following order: 0 - Gen_On; 1 - wmeas; 2 - GCB_status; 3 - Va; 4 - Vb; 5 - Vc; 6 - Vt; 7 - Ia; 8 - Ib; 9 - Ic; 10 - P; 11 - Q; 12 - S; 13 - pf.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Adjustment of the shunt snubber load is important for simulation stability in multiple time steps.</span></p></body></html>"
                help_file = "diesel_genset.html"

                Sb {
                    label = "Nominal Power"
                    widget = edit
                    type = generic
                    default_value = "2.2e6"
                    unit = "VA"
                    group = "1 - Basic"
                }

                Vn {
                    label = "Phase Nominal Voltage"
                    widget = edit
                    type = generic
                    default_value = "480.0"
                    unit = "V (line to line)"
                    group = "1 - Basic"
                }

                f {
                    label = "Nominal electrical frequency"
                    widget = edit
                    type = generic
                    default_value = "60.0"
                    unit = "Hz"
                    group = "1 - Basic"
                }

                load {
                    label = "Shunt snubber load percentage of nominal power"
                    widget = edit
                    type = generic
                    default_value = "5"
                    unit = "%"
                    group = "1 - Basic"
                }

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                    unit = "s"
                    group = "1 - Basic"
                }

                Rs {
                    label = "Rs"
                    widget = edit
                    type = generic
                    default_value = "9.4035e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Lls {
                    label = "Lls"
                    widget = edit
                    type = generic
                    default_value = "1.389e-5"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmd {
                    label = "Lmd"
                    widget = edit
                    type = generic
                    default_value = "6.5282e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmq {
                    label = "Lmq"
                    widget = edit
                    type = generic
                    default_value = "4.778e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rf_prime {
                    label = "Rf"
                    widget = edit
                    type = generic
                    default_value = "2.1574e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llfd_prime {
                    label = "Llfd"
                    widget = edit
                    type = generic
                    default_value = "1.4195e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkd {
                    label = "Rkd"
                    widget = edit
                    type = generic
                    default_value = "0.0443938909091"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkq {
                    label = "Rkq"
                    widget = edit
                    type = generic
                    default_value = "0.00399796363636"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkd {
                    label = "Llkd"
                    widget = edit
                    type = generic
                    default_value = "0.00155586168397"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkq {
                    label = "Llkq"
                    widget = edit
                    type = generic
                    default_value = "9.96738215238e-05"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nfd {
                    label = "Ns/Nfd"
                    widget = edit
                    type = generic
                    default_value = "0.02512"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkd {
                    label = "Ns/Nkd"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkq {
                    label = "Ns/Nkq"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                pms {
                    label = "pms"
                    widget = edit
                    type = generic
                    default_value = "2.0"
                    group = "3- Synch. mach. - Mec."
                }

                J {
                    label = "Jm"
                    widget = edit
                    type = generic
                    default_value = "42.9467"
                    unit = "kg.m²"
                    group = "3- Synch. mach. - Mec."
                }

                F {
                    label = "Friction coefficient"
                    widget = edit
                    type = generic
                    default_value = "0.572003113298"
                    unit = "Nms"
                    group = "3- Synch. mach. - Mec."
                }

                T1 {
                    label = "Electric control box time constant 1"
                    widget = edit
                    type = generic
                    default_value = "1.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T2 {
                    label = "Electric control box time constant 2"
                    widget = edit
                    type = generic
                    default_value = "1e-6"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T3 {
                    label = "Electric control box time constant 3"
                    widget = edit
                    type = generic
                    default_value = "0.5001"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                K {
                    label = "Actuator gain K"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    group = "4 - Gov. and Eng."
                }

                T4 {
                    label = "Actuator time constant 4"
                    widget = edit
                    type = generic
                    default_value = "25.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T5 {
                    label = "Actuator time constant 5"
                    widget = edit
                    type = generic
                    default_value = "9.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T6 {
                    label = "Actuator time constant 6"
                    widget = edit
                    type = generic
                    default_value = "5.74e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Pm0 {
                    label = "Initial mechanical power"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmax {
                    label = "Maximum torque limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmin {
                    label = "Minimum torque limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Td {
                    label = "Engine time delay"
                    widget = edit
                    type = generic
                    default_value = "24.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Tr {
                    label = "Time constant Tr"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                exc_Kp {
                    label = "Exciter PI proportional gain"
                    widget = edit
                    type = generic
                    default_value = "0.025"
                    group = "5 - Exciter"
                }

                exc_Ki {
                    label = "Exciter PI integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.007"
                    group = "5 - Exciter"
                }

                Ka {
                    label = "Major regulator gain Ka"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Ta {
                    label = "Major regulator time constant Ta"
                    widget = edit
                    type = generic
                    default_value = "2.0e-3"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vrmax {
                    label = "Saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vrmin {
                    label = "Saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Te {
                    label = "Exciter time constant Te"
                    widget = edit
                    type = generic
                    default_value = "1.0e-8"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Ke {
                    label = "Exciter gain Ke"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Kf {
                    label = "Stabilization feedback gain Kf"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "5 - Exciter"
                }

                Tf {
                    label = "Stabilization feedback time constant Tf"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vt0 {
                    label = "Initial terminal voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vf0 {
                    label = "Initial field voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmax {
                    label = "Exciter saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "[\'inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmin {
                    label = "Exciter saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "[\'-inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                delta_f {
                    label = "Synch Check - accepted frequency difference"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                delta_phi {
                    label = "Synch Check - Accepted phase difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                phase_Kp {
                    label = "Synck Check - Phase PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "6 - Adv. 1"
                }

                phase_Ki {
                    label = "Synch Check - Phase PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.00012"
                    group = "6 - Adv. 1"
                }

                phase_upLim {
                    label = "Synch Check - Phase PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "6 - Adv. 1"
                }

                phase_lowLim {
                    label = "Synch Check - Phase PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-0.1"
                    group = "6 - Adv. 1"
                }

                phaseOff {
                    label = "Synch Check - Phase calibration"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                dw_K {
                    label = "Synch Check - delta w gain"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "6 - Adv. 1"
                }

                V_Kp {
                    label = "Synck Check - Voltage PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.0071"
                    group = "6 - Adv. 1"
                }

                V_Ki {
                    label = "Synck Check - Voltage PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.0354"
                    group = "6 - Adv. 1"
                }

                V_upLim {
                    label = "Synck Check - Voltage PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "6 - Adv. 1"
                }

                V_lowLim {
                    label = "Synck Check - Voltage PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-1"
                    group = "6 - Adv. 1"
                }

                delta_V {
                    label = "Synck Check - Accepted voltage difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                w_sp_Kp {
                    label = "Frequency setpoint loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_Ki {
                    label = "Frequency setpoint loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_upLim {
                    label = "Frequency setpoint loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                w_sp_lowLim {
                    label = "Frequency setpoint loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                P_droop {
                    label = "Frequency setpoint loop - P droop"
                    widget = edit
                    type = generic
                    default_value = "2.7"
                    group = "7 - Adv. 2"
                }

                P_rise {
                    label = "Frequency setpoint loop - P rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                P_fall {
                    label = "Frequency setpoint loop - P falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_droop {
                    label = "Frequency setpoint loop - w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                w_rise {
                    label = "Frequency setpoint loop - w rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_fall {
                    label = "Frequency setpoint loop - w falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                gov_Kp {
                    label = "Governor - Proportional gain Kp"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    group = "7 - Adv. 2"
                }

                delta_wn {
                    label = "Governor - Accepted nominal speed difference"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    unit = "%"
                    group = "7 - Adv. 2"
                }

                inner_w_droop {
                    label = "Governor - inner w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                inner_w_rise {
                    label = "Governor - inner w rise"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                inner_w_fall {
                    label = "Governor - inner w fall"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                pf_Kp {
                    label = "Power factor loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.05"
                    group = "8 - Adv. 3"
                }

                pf_Ki {
                    label = "Power factor loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.075"
                    group = "8 - Adv. 3"
                }

                pf_upLim {
                    label = "Power factor loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_lowLim {
                    label = "Power factor loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                pf_rise {
                    label = "Power factor loop - pf rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_fall {
                    label = "Power factor loop - pf falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                exc_dwn {
                    label = "Exciter - start speed"
                    widget = edit
                    type = generic
                    default_value = "75"
                    unit = "%"
                    group = "8 - Adv. 3"
                }

                V_rise {
                    label = "Exciter - V rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_fall {
                    label = "Exciter - V falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_inner_droop {
                    label = "Exciter - V inner droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "8 - Adv. 3"
                }

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, 'diesel_genset.svg')
                ENDCODE

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                
                ENDCODE
            }
        }
        [
            position = 7376, 6496
            size = 354, 240
        ]

        component "core/Three Phase Two Winding Transformer" Tr4 {
            Sn = "1e6"
            V1 = "339"
            V2 = "5000"
            core_model = "Lm/Rm neglected"
            input = "pu"
            l1 = "0.48e-3"
            l2 = "0.48e-3"
            lm = "156.68213162985495"
            r1 = "1e-5"
            r2 = "1e-5"
            rm = "347.82608695652175"
            winding_1_connection = "D"
            winding_2_connection = "D"
        }
        [
            position = 8840, 6696
            rotation = left
            size = 126, 256
        ]

        component "core/Three-phase Meter" "Voltage gen 2" {
            VAB = "True"
            VBC = "True"
            VCA = "True"
        }
        [
            position = 8840, 6888
            rotation = left
            size = 56, 240
        ]

        component "core/Ground" gnd27 {
        }
        [
            position = 9136, 6888
            rotation = left
        ]

        component Subsystem DG_in1 {
            layout = dynamic
            component "core/SCADA Input" pf_ref {
                execution_rate = "Ts"
                unit = ""
            }
            [
                position = 8120, 8112
            ]

            component "core/SCADA Input" Gen_OP_mode {
                def_value = "1"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8144
            ]

            component "core/SCADA Input" Gen_On {
                addr = "1427111952"
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 7992
            ]

            component "core/SCADA Input" Load_share {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8112, 8312
            ]

            component "core/SCADA Input" wref {
                addr = "1427111952"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8120, 8056
            ]

            component "core/Bus Join" "Bus Join2" {
                inputs = "9"
            }
            [
                position = 8272, 8392
                rotation = right
                hide_name = True
            ]

            component "core/SCADA Input" Vref {
                addr = "1427111940"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = "pu"
            }
            [
                position = 8160, 8016
            ]

            component "core/SCADA Input" Gen_Control_Mode {
                addr = "1427111944"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 8200
            ]

            component "core/SCADA Input" Pref {
                addr = "1427111936"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8160, 8080
            ]

            component "core/SCADA Input" Load_share_on {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8256
            ]

            port inputs {
                position = right:1
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8272, 8464
                rotation = right
                hide_name = True
            ]

            connect "Bus Join2.out" inputs as Connection828
            connect Gen_Control_Mode.out "Bus Join2.in6" as Connection235
            connect Gen_OP_mode.out "Bus Join2.in5" as Connection565
            connect Gen_On.out "Bus Join2.in" as Connection230
            connect Load_share.out "Bus Join2.in8" as Connection826
            connect Load_share_on.out "Bus Join2.in7" as Connection825
            connect Pref.out "Bus Join2.in3" as Connection233
            connect Vref.out "Bus Join2.in1" as Connection231
            connect pf_ref.out "Bus Join2.in4" as Connection827
            connect wref.out "Bus Join2.in2" as Connection232

            Ts = "Ts"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Scada inputs for the Diesel Genset from the Microgrid Library.</p></body></html>"

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 8648, 7248
            scale = -1, 1
            size = 48, 48
        ]

        component Subsystem Diesel_Gen2 {
            layout = static
            component "core/Signal Controlled Voltage Source" Vfd {
            }
            [
                position = 8672, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" If {
            }
            [
                position = 8736, 8240
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vfield {
            }
            [
                position = 8800, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Triple Pole Single Throw Contactor" MCB {
                ctrl_src = "Model"
            }
            [
                position = 9448, 8320
                scale = -1, 1
                size = 64, 256
            ]

            component "core/Three Phase Wound Rotor Synchronous Machine" Gen {
                Jm = "J"
                Llfd = "Llfd_prime"
                Llkd = "Llkd"
                Llkq = "Llkq"
                Lls = "Lls"
                Lmd = "Lmd"
                Lmq = "Lmq"
                Ns_div_Nfd = "Ns_Nfd"
                Ns_div_Nkd = "Ns_Nkd"
                Ns_div_Nkq = "Ns_Nkq"
                Rf = "Rf_prime"
                Rkd = "Rkd"
                Rkq = "Rkq"
                Rs = "Rs"
                el_torque_out_addr = "8200"
                el_trq_out = "True"
                execution_rate = "Ts"
                friction_coeff = "F"
                load_src = "Model"
                me_speed_out_addr = "8202"
                mech_speed_out = "True"
                pms = "pms"
                res_int_carr_f = "5000.0"
            }
            [
                position = 8984, 8320
                scale = -1, 1
                size = 176, 160
            ]

            component Subsystem Control {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "5"
                }
                [
                    position = 8456, 8192
                    rotation = left
                    hide_name = True
                ]

                component "core/Unit Delay" "Unit Delay2" {
                    execution_rate = "Ts"
                }
                [
                    position = 7920, 8104
                    hide_name = True
                ]

                component "core/Digital Probe" Exciter_on {
                }
                [
                    position = 7800, 7664
                    rotation = left
                ]

                component "core/Unit Delay" "Unit Delay1" {
                }
                [
                    position = 7208, 7696
                    hide_name = True
                ]

                component "core/Probe" Vf {
                    addr = "8978"
                    execution_rate = "Ts"
                }
                [
                    position = 8224, 7768
                    rotation = left
                ]

                component "core/Termination" Termination1 {
                }
                [
                    position = 7384, 8280
                    hide_name = True
                ]

                component "core/Digital Probe" StandBy {
                }
                [
                    position = 7416, 7888
                ]

                component "core/Digital Probe" GridForming {
                }
                [
                    position = 7416, 7952
                ]

                component "core/Unit Delay" "Unit Delay3" {
                    execution_rate = "Ts"
                }
                [
                    position = 8024, 7664
                    hide_name = True
                ]

                component "core/Round" Round1 {
                    round_fn = "round"
                }
                [
                    position = 7208, 7656
                    hide_name = True
                ]

                component "core/Bus Split" "Bus Split2" {
                    outputs = "3"
                }
                [
                    position = 6952, 7856
                    hide_name = True
                ]

                component "core/Digital Probe" GridFollowing {
                }
                [
                    position = 7504, 7928
                ]

                component "core/Bus Split" "Bus Split3" {
                    outputs = "9"
                }
                [
                    position = 6952, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" T {
                }
                [
                    position = 8128, 8184
                    rotation = left
                ]

                component "core/Digital Probe" Gen_On {
                }
                [
                    position = 7120, 8064
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "4"
                }
                [
                    position = 7296, 8104
                    rotation = right
                    hide_name = True
                ]

                component Subsystem check_steady_state_w {
                    layout = dynamic
                    component "core/Gain" speed_diff {
                        gain = "delta_wn/100.0"
                    }
                    [
                        position = 8232, 8208
                    ]

                    component "core/Abs" Abs1 {
                    }
                    [
                        position = 8280, 8160
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator3 {
                    }
                    [
                        position = 8360, 8200
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 8208, 8160
                        hide_name = True
                    ]

                    component "core/Constant" Constant3 {
                        execution_rate = "Ts"
                        value = "2.0*np.pi*f/pms"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    port ss_speed {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8424, 8200
                    ]

                    port w_meas {
                        position = left:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8096, 8152
                    ]

                    junction Junction9 sp
                    [
                        position = 8168, 8208
                    ]

                    connect Abs1.in Sum3.out as Connection5
                    connect Comparator3.in2 Abs1.out as Connection13
                    connect Comparator3.out ss_speed as Connection58
                    connect Constant3.out Junction9 as Connection16
                    connect Junction9 speed_diff.in as Connection39
                    connect Sum3.in1 Junction9 as Connection54
                    connect speed_diff.out Comparator3.in1 as Connection57
                    connect w_meas Sum3.in as Connection59
                }
                [
                    position = 7968, 8440
                    size = 96, 48
                ]

                component Subsystem Governor_and_Engine {
                    layout = dynamic
                    component "core/Signal switch" w_switch1 {
                    }
                    [
                        position = 7832, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum4 {
                        signs = "+--"
                    }
                    [
                        position = 7920, 8000
                        hide_name = True
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "inner_w_fall"
                        rising_limit = "inner_w_rise"
                    }
                    [
                        position = 7568, 7944
                        hide_name = True
                    ]

                    component "core/Probe" wmeas {
                        addr = "8977"
                    }
                    [
                        position = 7832, 8080
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 7352, 7960
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1/Sb"
                    }
                    [
                        position = 7576, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum5 {
                        signs = "3"
                    }
                    [
                        position = 7704, 7984
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7728, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 7496, 7944
                        hide_name = True
                    ]

                    component "core/Gain" "Tpu to T" {
                        execution_rate = "Ts"
                        gain = "-Sb*pms/(2*np.pi*f)"
                    }
                    [
                        position = 8200, 8000
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 7672, 8200
                        hide_name = True
                    ]

                    component "core/Probe" Inner_droop_dw {
                        addr = "8977"
                    }
                    [
                        position = 7936, 8080
                    ]

                    component "core/Probe" wref {
                        addr = "8977"
                    }
                    [
                        position = 7768, 7936
                        rotation = left
                    ]

                    component "core/Constant" Inner_w_droop {
                        execution_rate = "Ts"
                        value = "inner_w_droop"
                    }
                    [
                        position = 7528, 8232
                    ]

                    component Subsystem DEGOV {
                        layout = dynamic
                        component "core/Gain" Kp {
                            gain = "gov_Kp"
                        }
                        [
                            position = 8040, 8160
                        ]

                        component "core/Gain" K {
                            gain = "K"
                        }
                        [
                            position = 8112, 8160
                        ]

                        component "core/Transport Delay" "Transport Delay1" {
                            init_value = "Pm0"
                            time_delay = "Td"
                        }
                        [
                            position = 8392, 8160
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[T5*T6,T5+T6,1]"
                            b_coeff = "[T4,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8176, 8160
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[T1*T2,T1,1]"
                            b_coeff = "[T3,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7960, 8160
                        ]

                        component Subsystem Integrator {
                            layout = dynamic
                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8304
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Tmin"
                                upper_limit = "Tmax"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8216
                                hide_name = True
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "Pm0"
                                limit_lower = "phase_lowLim"
                                limit_upper = "phase_upLim"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                                gain = "1000"
                            }
                            [
                                position = 8216, 8304
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8256
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7968, 8208
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 8368, 8224
                            ]

                            connect In Sum7.in as Connection58
                            connect Integrator1.reset Reset as Connection2
                            connect Junction3 Out as Connection48
                            connect Junction4 Integrator1.out as Connection65
                            connect Junction4 Sum6.in as Connection56
                            connect Kb.in Sum6.out as Connection50
                            connect Limit1.out Junction3 as Connection66
                            connect Limit1.in Junction4 as Connection55
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8264, 8160
                            size = 64, 48
                        ]

                        port T {
                            label = "T"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8488, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8208, 8104
                        ]

                        port w_bias {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7832, 8160
                        ]

                        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Engine</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8368, 8192
                        ]

                        comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Actuator:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">          K (1 + sT4)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">   s(1 + sT5)(1 + sT6)</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8128, 8208
                        ]

                        comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Electric Control Box:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">           (1 + sT3)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">  1 + sT1 + (s^2)T1T2</span></p></body></html> ENDCOMMENT 
                        [
                            position = 7872, 8208
                        ]

                        connect Integrator.In TF2.out as Connection31
                        connect Integrator.Out "Transport Delay1.in" as Connection32
                        connect Kp.out K.in as Connection35
                        connect TF1.out Kp.in as Connection36
                        connect TF2.in K.out as Connection27
                        connect "Transport Delay1.out" T as Connection28
                        connect reset Integrator.Reset as Connection33
                        connect w_bias TF1.in as Connection34
                    }
                    [
                        position = 8072, 8000
                        size = 120, 64
                    ]

                    port w_meas_in {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7656, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    port T_out {
                        label = "T_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8264, 8000
                    ]

                    port "Gen On" {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7448, 7872
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_meas {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7504, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_bias {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7592, 7984
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7784, 8160
                        rotation = down
                        scale = -1, 1
                    ]

                    port dw_synch {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7632, 8000
                    ]

                    port w_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7432, 7928
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7752, 8232
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7440, 7984
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction9 sp
                    [
                        position = 7496, 7872
                    ]

                    junction Junction10 sp
                    [
                        position = 7768, 7984
                    ]

                    junction Junction12 sp
                    [
                        position = 7392, 7960
                    ]

                    junction Junction13 sp
                    [
                        position = 7784, 8080
                    ]

                    junction Junction14 sp
                    [
                        position = 7880, 8080
                    ]

                    connect DEGOV.T "Tpu to T.in" as Connection720
                    connect From1 w_switch1.in1 as Connection695
                    connect GCB_status w_switch1.in2 as Connection691
                    connect "Gen On" Junction9 as Connection678
                    connect Inner_w_droop.out Product1.in1 as Connection764
                    connect Junction10 Sum4.in as Connection684
                    connect Junction12 Goto1 as Connection699
                    connect Junction12 w_switch.in1 as Connection693
                    connect Junction13 wmeas.in as Connection755
                    connect Junction14 Inner_droop_dw.in as Connection758
                    connect Junction9 DEGOV.reset as Connection679
                    connect Product1.in to_pu.out as Connection618
                    connect Product1.out w_switch1.in as Connection712
                    connect Sum4.out DEGOV.w_bias as Connection742
                    connect Sum4.in1 Junction13 as Connection756
                    connect Sum4.in2 Junction14 as Connection759
                    connect Sum5.out Junction10 as Connection683
                    connect "Tpu to T.out" T_out as Connection30
                    connect dw_synch Sum5.in2 as Connection701
                    connect to_pu.in P_meas as Connection619
                    connect "w to wpu.out" Junction13 as Connection754
                    connect "w to wpu.in" w_meas_in as Connection166
                    connect w_bias Sum5.in1 as Connection700
                    connect w_ramp.out Sum5.in as Connection762
                    connect w_ramp.in w_switch.out as Connection761
                    connect w_ref w_switch.in as Connection763
                    connect w_switch.in2 Junction9 as Connection680
                    connect w_switch1.out Junction14 as Connection757
                    connect wref.in Junction10 as Connection685
                    connect zero.out Junction12 as Connection692
                }
                [
                    position = 8016, 8232
                    size = 184, 208
                ]

                component Subsystem Read_Control_mode {
                    layout = dynamic
                    component "core/Digital Probe" PV_mode {
                    }
                    [
                        position = 8264, 8192
                    ]

                    component "core/C function" State {
                        init_fnc = "/*Begin code section*/
Vf = 0;
PV = 0;
PQ = 0;
/*End code section*/"
                        input_terminals = "real enable;inherit P;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;False;"
                        output_fnc = "/*Begin code section*/
if(enable && P && Q){
    Vf = 0;
    PV = 0;
    PQ = 1;
}
else{
    if(enable && P){
        Vf = 0;
        PV = 1;
        PQ = 0;
    }
    else{
        Vf = 1;
        PV = 0;
        PQ = 0;
    }
}
/*End code section*/"
                        output_terminals = "real Vf;inherit PV;inherit PQ;"
                        output_terminals_dimensions = "inherit;inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;False;"
                    }
                    [
                        position = 8144, 8192
                        size = 56, 168
                    ]

                    component "core/Digital Probe" Vf_mode {
                    }
                    [
                        position = 8264, 8128
                    ]

                    component "core/Digital Probe" PQ_mode {
                    }
                    [
                        position = 8264, 8256
                    ]

                    port Enable_outer_loop {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8128
                    ]

                    port P_control_mode {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8192
                    ]

                    port Q_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8256
                    ]

                    connect Enable_outer_loop State.enable as Connection1
                    connect PV_mode.in State.PV as Connection4
                    connect State.PQ PQ_mode.in as Connection6
                    connect State.P P_control_mode as Connection2
                    connect State.Q Q_control_mode as Connection3
                    connect State.Vf Vf_mode.in as Connection5
                }
                [
                    position = 7728, 8448
                    size = 96, 96
                ]

                component Subsystem Start_Exciter {
                    layout = dynamic
                    component "core/Gain" Exciter_start_speed {
                        gain = "exc_dwn/100.0"
                    }
                    [
                        position = 8152, 8248
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8312, 8144
                        hide_name = True
                    ]

                    component "core/Constant" steadyState_w {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8032, 8248
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1.0/(2*np.pi*f/pms)"
                    }
                    [
                        position = 8152, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8224, 8200
                        hide_name = True
                    ]

                    port w_meas {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8192
                    ]

                    port Gen_On {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8136
                    ]

                    port Start {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8144
                    ]

                    connect Comparator1.out and.in1 as Connection73
                    connect Comparator1.in1 "w to wpu.out" as Connection2
                    connect Exciter_start_speed.out Comparator1.in2 as Connection5
                    connect and.in Gen_On as Connection74
                    connect and.out Start as Connection76
                    connect steadyState_w.out Exciter_start_speed.in as Connection56
                    connect "w to wpu.in" w_meas as Connection75
                }
                [
                    position = 7704, 7704
                    size = 104, 64
                ]

                component Subsystem Exciter {
                    layout = dynamic
                    component "core/Gain" one_ov_sqrt_3 {
                        execution_rate = "Ts"
                        gain = "1.0/(3.0**0.5)"
                    }
                    [
                        position = 8032, 8432
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" Vt_to_Vtpu {
                        execution_rate = "Ts"
                        gain = "1.0/(Vn*((2.0/3.0)**0.5))"
                    }
                    [
                        position = 8304, 8248
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8568, 8200
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 8032, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum2 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8184, 8208
                        hide_name = True
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                        value = "1.0"
                    }
                    [
                        position = 8448, 8104
                    ]

                    component "core/Gain" Vfpu_to_Vf {
                        execution_rate = "Ts"
                        gain = "Vn*((2.0/3.0)**0.5)/Ns_Nfd"
                    }
                    [
                        position = 8648, 8200
                    ]

                    component "core/Sum" Sum1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8264, 8104
                        hide_name = True
                    ]

                    component "core/Probe" Vt {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8304
                        rotation = right
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8112, 8272
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Constant" Zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 7680, 8168
                        hide_name = True
                    ]

                    component "core/Probe" V_ref {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8072, 8160
                        rotation = left
                    ]

                    component "core/Signal switch" switch {
                    }
                    [
                        position = 7752, 8184
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" Vpss {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8176, 8128
                    ]

                    component "core/Sum" Sum {
                        execution_rate = "Ts"
                        signs = "3"
                    }
                    [
                        position = 8016, 8200
                        hide_name = True
                    ]

                    component "core/Constant" Const {
                        execution_rate = "Ts"
                        value = "Vf0/Ka"
                    }
                    [
                        position = 8176, 8072
                    ]

                    component "core/Constant" V_inner_droop {
                        execution_rate = "Ts"
                        value = "V_inner_droop"
                    }
                    [
                        position = 7928, 8432
                    ]

                    component "core/Rate Limiter" "Rate Limit" {
                        falling_limit = "V_fall"
                        rising_limit = "V_rise"
                    }
                    [
                        position = 7816, 8184
                        hide_name = True
                    ]

                    component Subsystem DC4B {
                        layout = dynamic
                        component "core/Signal switch" switch {
                        }
                        [
                            position = 8000, 8256
                            hide_name = True
                            scale = 1, -1
                        ]

                        component "core/Product" Product1 {
                        }
                        [
                            position = 8200, 8160
                            hide_name = True
                        ]

                        component "core/Gain" Kf {
                            gain = "Kf"
                        }
                        [
                            position = 8424, 8032
                            scale = -1, 1
                        ]

                        component "core/Discrete Transfer Function" TF4 {
                            a_coeff = "[Tf,1]"
                            b_coeff = "[1,0]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8032
                            scale = -1, 1
                        ]

                        component "core/Gain" KA {
                            gain = "Ka"
                        }
                        [
                            position = 8304, 8160
                        ]

                        component "core/Sum" Sum2 {
                            signs = "-+"
                        }
                        [
                            position = 8000, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF3 {
                            a_coeff = "[Te,Ke]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8552, 8168
                        ]

                        component "core/Constant" One {
                            execution_rate = "Ts"
                        }
                        [
                            position = 7872, 8272
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[Ta,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 8160
                        ]

                        component "core/C function" "Variable Limit" {
                            init_fnc = "/*Begin code section*/
LimitChange = 0;
out = 0;
/*End code section*/"
                            input_terminals = "inherit in;inherit LimitChange;"
                            input_terminals_dimensions = "inherit;inherit"
                            input_terminals_feedthrough = "[u\'\']"
                            input_terminals_show_labels = "True;True;"
                            output_fnc = "/*Begin code section*/
if(LimitChange == 0.0){
    LimitChange = 0.01;
}

if(in>=Vrmax*LimitChange){
    out = Vrmax*LimitChange;
}
else{
    if(in<=Vrmin*LimitChange){
        out = Vrmin*LimitChange;
    }
    else{
        out = in;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[u\'\']"
                            output_terminals_show_labels = "True;"
                            parameters = "real Vrmax;real Vrmin;"
                        }
                        [
                            position = 8464, 8168
                            size = 0, 0
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[Tr,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7768, 8216
                        ]

                        component "core/Sum" Sum1 {
                            signs = "++-"
                        }
                        [
                            position = 7896, 8160
                            hide_name = True
                        ]

                        component "core/Probe" Va {
                        }
                        [
                            position = 8288, 8096
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8312
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Integrator" Integrator1 {
                                limit_lower = "[\'-inf\']"
                                limit_upper = "[\'inf\']"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8232
                                hide_name = True
                            ]

                            component "core/Gain" Kp {
                                gain = "exc_Kp"
                            }
                            [
                                position = 7992, 8152
                            ]

                            component "core/Gain" Ki {
                                gain = "exc_Ki"
                            }
                            [
                                position = 7992, 8216
                            ]

                            component "core/Sum" Sum5 {
                            }
                            [
                                position = 8320, 8224
                                hide_name = True
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Vrmin/Ka"
                                upper_limit = "Vrmax/Ka"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8216, 8312
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8264
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7824, 8184
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8368, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 7928, 8184
                            ]

                            connect Integrator1.reset Reset as Connection2
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction4 In as Connection57
                            connect Kb.in Sum6.out as Connection50
                            connect Ki.in Junction4 as Connection56
                            connect Ki.out Sum7.in as Connection54
                            connect Kp.in Junction4 as Connection58
                            connect Kp.out Sum5.in as Connection59
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.in1 Integrator1.out as Connection5
                            connect Sum5.out Junction2 as Connection44
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8104, 8152
                            size = 64, 48
                        ]

                        port Vfd {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8672, 8168
                        ]

                        port Vref {
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8048, 8088
                        ]

                        port Vpss {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8104
                        ]

                        port Vt {
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8216
                        ]

                        port Linearize {
                            position = top:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8320
                        ]

                        junction Junction6 sp
                        [
                            position = 8248, 8160
                        ]

                        junction Junction10 sp
                        [
                            position = 8160, 8256
                        ]

                        junction Junction13 sp
                        [
                            position = 7816, 8216
                        ]

                        junction Junction14 sp
                        [
                            position = 8608, 8168
                        ]

                        connect Junction10 Product1.in1 as Connection102
                        connect Junction13 Sum1.in2 as Connection114
                        connect Junction14 Vfd as Connection126
                        connect Junction6 KA.in as Connection77
                        connect Kf.in Junction14 as Connection128
                        connect Linearize switch.in2 as Connection74
                        connect One.out switch.in as Connection75
                        connect PI.In Sum2.out as Connection48
                        connect Product1.out Junction6 as Connection76
                        connect Product1.in PI.Out as Connection49
                        connect Sum2.in1 Sum1.out as Connection5
                        connect TF1.out Junction13 as Connection113
                        connect TF2.in KA.out as Connection10
                        connect TF3.out Junction14 as Connection125
                        connect TF3.in "Variable Limit.out" as Connection118
                        connect TF4.in Kf.out as Connection127
                        connect TF4.out Sum2.in as Connection123
                        connect Va.in Junction6 as Connection78
                        connect "Variable Limit.LimitChange" Junction10 as Connection103
                        connect "Variable Limit.in" TF2.out as Connection89
                        connect Vpss Sum1.in as Connection45
                        connect Vref Sum1.in1 as Connection46
                        connect Vt TF1.in as Connection112
                        connect reset PI.Reset as Connection117
                        connect switch.out Junction10 as Connection101
                        connect switch.in1 Junction13 as Connection115

                        Ka = "Ka"
                        Ke = "Ke"
                        Kf = "Kf"
                        Ta = "Ta"
                        Te = "Te"
                        Tf = "Tf"
                        Tr = "Tr"
                        Vf0 = "Vf0"
                        Vfmax = "Efmax"
                        Vfmin = "Efmin"
                        Vrmax = "Vrmax"
                        Vrmin = "Vrmin"
                        exc_Ki = "exc_Ki"
                        exc_Kp = "exc_Kp"

                        mask {
                            description = "IEEE DC1A exciter model."

                            Tr {
                                label = "Time constant Tr"
                                widget = edit
                                type = generic
                                default_value = "2e-6"
                                group = "General"
                            }

                            exc_Kp {
                                label = "Exciter PI proportional gain"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            exc_Ki {
                                label = "Exciter PI integral gain"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Ka {
                                label = "Major regulator gain Ka"
                                widget = edit
                                type = generic
                                default_value = "200"
                                group = "General"
                            }

                            Ta {
                                label = "Major regulator time constant  Ta"
                                widget = edit
                                type = generic
                                default_value = "2e-3"
                                group = "General"
                            }

                            Vrmax {
                                label = "Saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                group = "General"
                            }

                            Vrmin {
                                label = "Saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                group = "General"
                            }

                            Te {
                                label = "Exciter time constant Te"
                                widget = edit
                                type = generic
                                default_value = "1e-8"
                                group = "General"
                            }

                            Ke {
                                label = "Exciter gain Ke"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            Kf {
                                label = "Stabilization feedback gain Kf"
                                widget = edit
                                type = generic
                                default_value = "0.0"
                                group = "General"
                            }

                            Tf {
                                label = "Stabilization feedback time constant Tf"
                                widget = edit
                                type = generic
                                default_value = "1.0e-12"
                                group = "General"
                            }

                            Vf0 {
                                label = "Initial field voltage"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Vfmax {
                                label = "Exciter saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "[\'inf\']"
                                group = "General"
                            }

                            Vfmin {
                                label = "Exciter saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "[\'-inf\']"
                                group = "General"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                                group = "General"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8448, 8208
                        size = 112, 120
                    ]

                    port Delta_V_in {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8200
                    ]

                    port Vf_out {
                        label = "Vf_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8200
                    ]

                    port Vt_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8248
                    ]

                    port Vref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8200
                    ]

                    port dV {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7944, 8216
                    ]

                    port Start {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7696, 8256
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8336
                        rotation = down
                        scale = -1, 1
                    ]

                    port Q_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8072
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7816, 8256
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction112 sp
                    [
                        position = 7752, 8256
                    ]

                    junction Junction116 sp
                    [
                        position = 8072, 8200
                    ]

                    junction Junction117 sp
                    [
                        position = 8416, 8072
                    ]

                    junction Junction118 sp
                    [
                        position = 8360, 8248
                    ]

                    connect Const.out Sum1.in as Connection3
                    connect DC4B.reset Junction117 as Connection743
                    connect DC4B.Vt Junction118 as Connection748
                    connect DC4B.Vfd Product1.in1 as Connection739
                    connect DC4B.Vref Sum2.out as Connection745
                    connect GCB_status Product2.in as Connection709
                    connect Goto1 Junction112 as Connection121
                    connect Junction112 switch.in2 as Connection120
                    connect Junction116 Sum.out as Connection720
                    connect Junction117 From1 as Connection742
                    connect Junction118 Vt.in as Connection747
                    connect One.out DC4B.Linearize as Connection740
                    connect Product1.in Junction117 as Connection741
                    connect Product2.out Sum2.in1 as Connection717
                    connect Product2.in1 to_pu.out as Connection710
                    connect "Rate Limit.out" Sum.in as Connection59
                    connect "Rate Limit.in" switch.out as Connection58
                    connect Start Junction112 as Connection119
                    connect Sum.in1 Delta_V_in as Connection25
                    connect Sum1.out DC4B.Vpss as Connection744
                    connect Sum2.in Junction116 as Connection721
                    connect V_inner_droop.out one_ov_sqrt_3.in as Connection749
                    connect V_ref.in Junction116 as Connection719
                    connect Vf_out Vfpu_to_Vf.out as Connection126
                    connect Vfpu_to_Vf.in Product1.out as Connection125
                    connect Vpss.out Sum1.in1 as Connection32
                    connect Vref switch.in as Connection87
                    connect Vt_to_Vtpu.out Junction118 as Connection746
                    connect Vt_to_Vtpu.in Vt_in as Connection36
                    connect Zero.out switch.in1 as Connection45
                    connect dV Sum.in2 as Connection88
                    connect one_ov_sqrt_3.out Product2.in2 as Connection724
                    connect to_pu.in Q_meas as Connection619
                }
                [
                    position = 8088, 7816
                    size = 192, 200
                ]

                component Subsystem "pf Control" {
                    layout = dynamic
                    component "core/Signal switch" "Signal switch2" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7872, 8192
                        hide_name = True
                    ]

                    component "core/Probe" delta_V {
                        addr = "8972"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8392, 8160
                    ]

                    component "core/Probe" pf_r {
                    }
                    [
                        position = 7808, 8208
                    ]

                    component "core/C function" norm_pf_ref {
                        global_variables = "real u;"
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
/*End code section*/"
                        input_terminals = "real pf;inherit P;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(P>=0){
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7712, 8176
                        size = 48, 48
                    ]

                    component "core/Probe" pf_m {
                    }
                    [
                        position = 7912, 8304
                    ]

                    component "core/Logical operator" "Logical operator5" {
                        inputs = "4"
                    }
                    [
                        position = 7904, 8016
                        rotation = right
                        hide_name = True
                    ]

                    component "core/C function" norm_pf_meas {
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
Q = 0.0;
/*End code section*/"
                        input_terminals = "real pf;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(pf>=0){
    if(Q>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(Q>=0){
        pf_norm = 2+pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7760, 8304
                        size = 48, 48
                    ]

                    component "core/Rate Limiter" "Rate Limiter1" {
                        falling_limit = "pf_fall"
                        rising_limit = "pf_rise"
                    }
                    [
                        position = 7936, 8192
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "0.1/Sb"
                    }
                    [
                        position = 7720, 7992
                        hide_name = True
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7824, 7944
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch4" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8304, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8032, 8200
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8240, 8232
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Ki {
                            gain = "pf_Ki"
                        }
                        [
                            position = 7992, 8216
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "pf_lowLim"
                            upper_limit = "pf_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "pf_Kp"
                        }
                        [
                            position = 7992, 8136
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7824, 8176
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7920, 8176
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection60
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection61
                        connect Kp.in Junction4 as Connection59
                        connect Kp.out Sum5.in as Connection57
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                        connect Sum7.in Ki.out as Connection54
                    }
                    [
                        position = 8144, 8200
                        size = 64, 48
                    ]

                    port Q_meas_in {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8344
                    ]

                    port Q_control_mode {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7792, 7840
                    ]

                    port enable {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7832, 7800
                    ]

                    port dV_out {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8392, 8216
                    ]

                    port P_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7880
                    ]

                    port pf_ref {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8128
                    ]

                    port pf_meas {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8280
                    ]

                    port Pref {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7936
                    ]

                    port P_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8184
                    ]

                    port Q_active {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8000
                    ]

                    tag Goto1 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8072, 8064
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7808, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction75 sp
                    [
                        position = 8344, 8216
                    ]

                    junction Junction81 sp
                    [
                        position = 7872, 8120
                    ]

                    junction Junction84 sp
                    [
                        position = 8144, 8120
                    ]

                    junction Junction85 sp
                    [
                        position = 7840, 8248
                    ]

                    junction Junction86 sp
                    [
                        position = 7840, 8304
                    ]

                    junction Junction87 sp
                    [
                        position = 7768, 8176
                    ]

                    junction Junction88 sp
                    [
                        position = 7984, 8064
                    ]

                    connect Constant1.out greater_equal.in1 as Connection125
                    connect From2 Junction81 as Connection52
                    connect Goto1 Junction88 as Connection128
                    connect Junction75 dV_out as Connection2
                    connect Junction81 Junction84 as Connection79
                    connect Junction81 "Signal switch2.in2" as Connection53
                    connect Junction84 "Signal switch4.in2" as Connection80
                    connect Junction85 "Signal switch2.in1" as Connection99
                    connect Junction86 Junction85 as Connection102
                    connect Junction87 "Signal switch2.in" as Connection108
                    connect Junction88 "Logical operator5.out" as Connection129
                    connect PI.Reset Junction84 as Connection81
                    connect PI.Out "Signal switch4.in" as Connection77
                    connect P_control_mode "Logical operator5.in2" as Connection84
                    connect P_meas norm_pf_ref.P as Connection127
                    connect Q_active Junction88 as Connection130
                    connect Q_control_mode "Logical operator5.in1" as Connection135
                    connect Q_meas_in norm_pf_meas.Q as Connection96
                    connect "Rate Limiter1.out" Sum6.in as Connection134
                    connect "Signal switch2.out" "Rate Limiter1.in" as Connection133
                    connect "Signal switch4.out" Junction75 as Connection17
                    connect Sum6.in1 Junction85 as Connection98
                    connect Sum6.out PI.In as Connection123
                    connect delta_V.in Junction75 as Connection20
                    connect enable "Logical operator5.in" as Connection136
                    connect greater_equal.out "Logical operator5.in3" as Connection126
                    connect greater_equal.in Pref as Connection124
                    connect norm_pf_meas.pf_norm Junction86 as Connection101
                    connect norm_pf_ref.pf_norm Junction87 as Connection107
                    connect norm_pf_ref.pf pf_ref as Connection132
                    connect pf_m.in Junction86 as Connection103
                    connect pf_meas norm_pf_meas.pf as Connection104
                    connect pf_r.in Junction87 as Connection109
                    connect zero1.out "Signal switch4.in1" as Connection75
                }
                [
                    position = 7736, 7912
                    size = 144, 272
                ]

                component Subsystem Output {
                    layout = dynamic

                    port w_meas {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8216
                    ]

                    port Gen_On {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "Gen_On"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto8 {
                        value = "w_meas"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8216
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Gen_On Goto7 as Connection632
                    connect Goto8 w_meas as Connection631
                }
                [
                    position = 8448, 8416
                    size = 56, 72
                ]

                component Subsystem Freq_setpoint_control {
                    layout = dynamic
                    component "core/Gain" P_3ph_to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 7960, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Constant" P_Droop {
                        execution_rate = "Ts"
                        value = "P_droop"
                    }
                    [
                        position = 7864, 7864
                    ]

                    component "core/Sum" Sum5 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8168, 7944
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" w_Droop {
                        execution_rate = "Ts"
                        value = "w_droop"
                    }
                    [
                        position = 8120, 8296
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 9184, 8352
                    ]

                    component "core/Signal switch" load_share_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8888, 8232
                        hide_name = True
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8208, 8344
                        hide_name = True
                    ]

                    component "core/Probe" w_Psp {
                    }
                    [
                        position = 8360, 7904
                        rotation = left
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 8400, 8512
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 8280, 8528
                        hide_name = True
                    ]

                    component "core/Probe" w_Pm {
                    }
                    [
                        position = 8360, 8016
                        rotation = left
                    ]

                    component "core/Signal switch" mode_switch1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 9408, 8368
                        hide_name = True
                    ]

                    component "core/Product" Product3 {
                        signs = "3"
                    }
                    [
                        position = 8152, 8056
                        hide_name = True
                    ]

                    component "core/Signal switch" mode_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8776, 8352
                        hide_name = True
                    ]

                    component "core/Limit" P_limit {
                        lower_limit = "0.0"
                        upper_limit = "1.0/1.25"
                    }
                    [
                        position = 7872, 7936
                        hide_name = True
                    ]

                    component "core/Sum" Sum8 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8608, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" f_droop_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8360
                        hide_name = True
                    ]

                    component "core/Probe" delta_w {
                        addr = "8975"
                        execution_rate = "Ts"
                    }
                    [
                        position = 9056, 8288
                        rotation = left
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8032, 7936
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7880, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum7 {
                    }
                    [
                        position = 8976, 8344
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8616, 7952
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Probe" w_sp {
                    }
                    [
                        position = 8712, 7992
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "w_fall"
                        rising_limit = "w_rise"
                    }
                    [
                        position = 8472, 8512
                        hide_name = True
                    ]

                    component "core/Rate Limiter" P_ramp {
                        falling_limit = "P_fall"
                        rising_limit = "P_rise"
                    }
                    [
                        position = 7936, 7936
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "w_sp_Kp"
                        }
                        [
                            position = 8008, 8152
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Ki {
                            gain = "w_sp_Ki"
                        }
                        [
                            position = 8008, 8216
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "w_sp_lowLim"
                            upper_limit = "w_sp_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7872, 8184
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7928, 8184
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.in Junction4 as Connection57
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 9296, 8352
                        size = 64, 48
                    ]

                    port Pmeas_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7864, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 7936
                    ]

                    port enable {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8280
                    ]

                    port w_meas {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_ref {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8496
                        rotation = down
                        scale = -1, 1
                    ]

                    port Load_Share {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8800, 8200
                    ]

                    port w_bias {
                        position = auto:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 9480, 8368
                    ]

                    port Load_Share_on {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8824, 8136
                    ]

                    port P_mode {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8288
                    ]

                    tag Goto2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8416, 8568
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From5 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9216, 8272
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8280, 8376
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From4 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9096, 8360
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto4 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8440, 8280
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8064, 7864
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto3 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7968, 8040
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From7 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9320, 8416
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8064, 8056
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From6 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From3 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8800, 8248
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction4 sp
                    [
                        position = 8072, 8016
                    ]

                    junction Junction6 sp
                    [
                        position = 8056, 8352
                    ]

                    junction Junction7 sp
                    [
                        position = 8344, 8528
                    ]

                    junction Junction8 sp
                    [
                        position = 7992, 8016
                    ]

                    junction Junction9 sp
                    [
                        position = 8360, 7944
                    ]

                    junction Junction10 sp
                    [
                        position = 8360, 8056
                    ]

                    junction Junction11 sp
                    [
                        position = 8656, 7992
                    ]

                    junction Junction12 sp
                    [
                        position = 9056, 8344
                    ]

                    junction Junction13 sp
                    [
                        position = 7920, 8016
                    ]

                    junction Junction14 sp
                    [
                        position = 8360, 8280
                    ]

                    junction Junction15 sp
                    [
                        position = 9296, 8272
                    ]

                    junction Junction16 sp
                    [
                        position = 7992, 7864
                    ]

                    comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8384, 8328
                    ]

                    comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_P_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8208, 7912
                    ]

                    comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8640, 8376
                    ]

                    comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8512, 8384
                    ]

                    comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Power setpoint loop</span></p></body></html> ENDCOMMENT 
                    [
                        position = 7904, 7816
                    ]

                    comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8656, 8056
                        rotation = right
                    ]

                    comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Frequency setpoint loop</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp = f_rated*Droop*Ppu</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Ppu = Pmeas/Prated</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">f_rated = 1pu</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8008, 8392
                    ]

                    connect From1 Product3.in1 as Connection631
                    connect From2 f_droop_switch.in1 as Connection655
                    connect From3 load_share_switch.in1 as Connection656
                    connect From5 Junction15 as Connection714
                    connect From6 w_switch.in2 as Connection711
                    connect From7 mode_switch1.in1 as Connection717
                    connect Goto2 Junction7 as Connection654
                    connect Goto3 Junction13 as Connection698
                    connect Goto4 Junction14 as Connection710
                    connect Junction10 Sum6.in as Connection682
                    connect Junction11 Sum6.out as Connection685
                    connect Junction12 Sum7.out as Connection693
                    connect Junction13 Junction8 as Connection697
                    connect Junction14 f_droop_switch.in2 as Connection709
                    connect Junction15 PI.Reset as Connection715
                    connect Junction16 Goto1 as Connection725
                    connect Junction4 Junction8 as Connection674
                    connect Junction6 Product1.in1 as Connection648
                    connect Junction7 w_switch.in1 as Connection653
                    connect Junction8 Product2.in2 as Connection675
                    connect Junction9 Sum5.out as Connection679
                    connect Load_Share load_share_switch.in as Connection659
                    connect Load_Share_on load_share_switch.in2 as Connection718
                    connect P_3ph_to_pu.out Junction6 as Connection647
                    connect P_Droop.out Junction16 as Connection726
                    connect P_limit.in P_ref as Connection721
                    connect P_mode mode_switch.in2 as Connection719
                    connect P_ramp.in P_limit.out as Connection720
                    connect Pmeas_in P_3ph_to_pu.in as Connection58
                    connect Product2.in Junction16 as Connection724
                    connect Product2.in1 P_ramp.out as Connection645
                    connect Product3.out Junction10 as Connection681
                    connect Product3.in Junction4 as Connection626
                    connect Product3.in2 Junction6 as Connection649
                    connect Sum3.in1 From4 as Connection707
                    connect Sum3.in Junction12 as Connection694
                    connect Sum3.out PI.In as Connection687
                    connect Sum5.in Junction4 as Connection624
                    connect Sum5.in1 Product2.out as Connection611
                    connect Sum6.in1 Junction9 as Connection678
                    connect Sum8.in f_droop_switch.out as Connection637
                    connect Sum8.in1 w_ramp.out as Connection638
                    connect delta_w.in Junction12 as Connection692
                    connect enable Junction14 as Connection708
                    connect f_droop_switch.in Product1.out as Connection634
                    connect load_share_switch.out Sum7.in as Connection650
                    connect mode_switch.in Junction11 as Connection684
                    connect mode_switch.out Sum7.in1 as Connection644
                    connect mode_switch.in1 Sum8.out as Connection643
                    connect mode_switch1.in2 Junction15 as Connection716
                    connect mode_switch1.in PI.Out as Connection712
                    connect "w to wpu.out" Junction13 as Connection696
                    connect w_Droop.out Product1.in as Connection722
                    connect w_Pm.in Junction10 as Connection683
                    connect w_Psp.in Junction9 as Connection680
                    connect w_bias mode_switch1.out as Connection713
                    connect w_meas "w to wpu.in" as Connection677
                    connect w_ramp.in w_switch.out as Connection103
                    connect w_ref w_switch.in as Connection180
                    connect w_sp.in Junction11 as Connection686
                    connect zero1.out Junction7 as Connection652
                }
                [
                    position = 7696, 8224
                    size = 120, 264
                ]

                component Subsystem Define_control_mode {
                    layout = dynamic
                    component "core/C function" Control_mode {
                        init_fnc = "/*Begin code section*/
P_control = 0;
Q_control = 0;
/*End code section*/"
                        input_terminals = "real Control_mode;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        output_fnc = "/*Begin code section*/
if(Control_mode == 1){
    //PV mode
    P_control = 1;
    Q_control = 0;
}
else{
    if(Control_mode == 2){
        //PQ mode
        P_control = 1;
        Q_control = 1;
    }
    else{
        P_control = 0;
        Q_control = 0;
    }
}
/*End code section*/"
                        output_terminals = "real P_control;inherit Q_control;"
                        output_terminals_dimensions = "inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;"
                    }
                    [
                        position = 8224, 8184
                        size = 176, 96
                    ]

                    port Gen_Control_Mode {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8184
                    ]

                    port P_Control {
                        position = right:11
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8152
                    ]

                    port Q_Control {
                        position = right:12
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8216
                    ]

                    connect Control_mode.Control_mode Gen_Control_Mode as Connection3
                    connect Control_mode.P_control P_Control as Connection2
                    connect Control_mode.Q_control Q_Control as Connection1
                }
                [
                    position = 7328, 8432
                    size = 144, 64
                ]

                component "core/C function" read_OP_mode {
                    init_fnc = "/*Begin code section*/
OP_mode =0;
enable = 0;
StandBy = 1;
GridFollowing = 0;
GridForming = 0;
/*End code section*/"
                    input_terminals = "real OP_mode;inherit GCB_status;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[u\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
if(OP_mode==0){
    StandBy= 1;
    GridFollowing = 0;
    GridForming = 0;
    enable = 0;
}
else{
    if(OP_mode == 1){
        StandBy = 0;
        GridFollowing = 1;
        GridForming = 0;
        if(GCB_status == 0){
            enable = 0;
        }
        else{
            enable = 1;
        }
    }
    else{
        StandBy = 0;
        GridFollowing = 0;
        GridForming = 1;
        enable = 0;
    }
}
/*End code section*/"
                    output_terminals = "real StandBy;inherit GridFollowing;inherit GridForming;inherit enable;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[u\'\']"
                    output_terminals_show_labels = "False;False;False;False;"
                }
                [
                    position = 7288, 7800
                    rotation = right
                    size = 128, 96
                ]

                port wmeas {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7840, 8320
                ]

                port T_in {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7272, 8280
                ]

                port Meas_feedback {
                    position = left:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7208, 8024
                ]

                port From_synch_check {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7856
                ]

                port To_synch_check {
                    position = left:12
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8456, 8112
                    rotation = left
                ]

                port T_out {
                    position = right:14
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8176, 8240
                ]

                port Inputs {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7960
                ]

                port Vf_out {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8272, 7816
                ]

                tag Goto38 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8088, 8440
                    hide_name = True
                    size = 60, 20
                ]

                tag From3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag From12 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From54 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8168
                    hide_name = True
                    size = 60, 20
                ]

                tag From59 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8104
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8256
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto39 {
                    value = "Exciter_on"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7864, 7728
                    hide_name = True
                    size = 60, 20
                ]

                tag From15 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8112
                    hide_name = True
                    size = 60, 20
                ]

                tag From62 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8272
                    hide_name = True
                    size = 60, 20
                ]

                tag From66 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto44 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7952, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag From70 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7928
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7504, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From13 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto45 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7872, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From67 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7192, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From68 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto16 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag From63 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8304
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7800
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto40 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8152
                    hide_name = True
                    size = 60, 20
                ]

                tag From2 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto15 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From61 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto43 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8416
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From65 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7688
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8176
                    hide_name = True
                    size = 58, 20
                ]

                tag Goto11 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8120
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From51 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 8008
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8160
                    hide_name = True
                    size = 60, 20
                ]

                tag From71 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8400
                    hide_name = True
                    size = 60, 20
                ]

                tag From60 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 7664
                    hide_name = True
                    size = 60, 20
                ]

                tag From1 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From64 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto42 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag From69 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7960
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto35 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From16 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8208
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto46 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8224
                    hide_name = True
                    size = 58, 20
                ]

                tag From4 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8176
                    hide_name = True
                    size = 60, 20
                ]

                tag From72 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From58 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto37 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8200
                    hide_name = True
                    size = 58, 20
                ]

                junction Junction13 sp
                [
                    position = 7800, 7704
                ]

                junction Junction14 sp
                [
                    position = 7888, 8392
                ]

                junction Junction15 sp
                [
                    position = 7800, 7704
                ]

                junction Junction18 sp
                [
                    position = 8224, 7816
                ]

                junction Junction22 sp
                [
                    position = 7056, 8120
                ]

                junction Junction23 sp
                [
                    position = 7888, 8320
                ]

                junction Junction24 sp
                [
                    position = 8128, 8240
                ]

                junction Junction25 sp
                [
                    position = 7368, 7888
                ]

                junction Junction26 sp
                [
                    position = 7456, 7928
                ]

                junction Junction27 sp
                [
                    position = 7368, 7952
                ]

                connect "Bus Join1.out" To_synch_check as Connection608
                connect "Bus Split2.in" From_synch_check as Connection205
                connect "Bus Split2.out1" Goto4 as Connection543
                connect "Bus Split3.out2" Goto13 as Connection677
                connect "Bus Split3.out4" Goto15 as Connection679
                connect "Bus Split3.out7" Goto40 as Connection687
                connect "Bus Split3.in" Inputs as Connection672
                connect "Bus Split3.out" Junction22 as Connection675
                connect Exciter_on.in Junction15 as Connection604
                connect Freq_setpoint_control.P_ref From14 as Connection648
                connect Freq_setpoint_control.Pmeas_in From2 as Connection651
                connect Freq_setpoint_control.enable From4 as Connection649
                connect Freq_setpoint_control.w_bias Governor_and_Engine.w_bias as Connection706
                connect From10 "Governor_and_Engine.Gen On" as Connection700
                connect From13 Exciter.Vref as Connection226
                connect From15 Freq_setpoint_control.w_ref as Connection647
                connect From16 "Bus Join1.in" as Connection576
                connect From27 "pf Control.pf_meas" as Connection693
                connect From3 Exciter.Vt_in as Connection179
                connect From45 Round1.in as Connection570
                connect From46 "Unit Delay1.in" as Connection581
                connect From49 "Bus Join1.in1" as Connection609
                connect From5 Read_Control_mode.Enable_outer_loop as Connection187
                connect From50 "Bus Join1.in3" as Connection611
                connect From51 "Bus Join1.in2" as Connection610
                connect From52 Exciter.dV as Connection585
                connect From54 "Bus Join1.in4" as Connection612
                connect From56 Freq_setpoint_control.w_meas as Connection650
                connect From58 Governor_and_Engine.P_meas as Connection697
                connect From59 "Unit Delay2.in" as Connection622
                connect From6 Read_Control_mode.P_control_mode as Connection188
                connect From60 "Unit Delay3.in" as Connection632
                connect From61 Exciter.Q_meas as Connection634
                connect From62 Freq_setpoint_control.P_mode as Connection653
                connect From63 Freq_setpoint_control.Load_Share_on as Connection654
                connect From64 Freq_setpoint_control.Load_Share as Connection655
                connect From65 Read_Control_mode.Q_control_mode as Connection685
                connect From66 "pf Control.P_control_mode" as Connection686
                connect From67 Define_control_mode.Gen_Control_Mode as Connection691
                connect From68 Governor_and_Engine.w_ref as Connection701
                connect From69 "pf Control.P_meas" as Connection709
                connect From7 Start_Exciter.Gen_On as Connection589
                connect From70 "pf Control.pf_ref" as Connection708
                connect From71 Output.Gen_On as Connection713
                connect From72 Output.w_meas as Connection714
                connect From8 Start_Exciter.w_meas as Connection590
                connect From9 Governor_and_Engine.dw_synch as Connection698
                connect Gen_On.in Junction22 as Connection673
                connect Goto1 "Bus Split1.out" as Connection174
                connect Goto10 "Bus Split2.out" as Connection531
                connect Goto12 "Bus Split3.out1" as Connection676
                connect Goto14 "Bus Split3.out3" as Connection678
                connect Goto16 "Bus Split3.out6" as Connection681
                connect Goto2 "Bus Split1.out1" as Connection175
                connect Goto3 "Bus Split1.out2" as Connection176
                connect Goto32 "Bus Split3.out5" as Connection680
                connect Goto37 "Bus Split2.out2" as Connection584
                connect Goto38 check_steady_state_w.ss_speed as Connection602
                connect Goto39 Junction15 as Connection606
                connect Goto42 "Bus Split3.out8" as Connection688
                connect Goto43 Define_control_mode.P_Control as Connection690
                connect Goto44 Define_control_mode.Q_Control as Connection689
                connect Goto45 "pf Control.Q_active" as Connection707
                connect Goto46 "Bus Split1.out3" as Connection711
                connect Goto9 Junction14 as Connection599
                connect Governor_and_Engine.w_meas_in Junction23 as Connection696
                connect Governor_and_Engine.T_out Junction24 as Connection705
                connect Junction13 Exciter.Start as Connection596
                connect Junction15 Junction13 as Connection605
                connect Junction18 Exciter.Vf_out as Connection645
                connect Junction22 Goto11 as Connection674
                connect Junction23 Junction14 as Connection695
                connect Junction24 T.in as Connection704
                connect Meas_feedback "Bus Split1.in" as Connection712
                connect Start_Exciter.Start Junction13 as Connection595
                connect T_in Termination1.in as Connection166
                connect T_out Junction24 as Connection703
                connect "Unit Delay2.out" Governor_and_Engine.GCB_status as Connection702
                connect "Unit Delay3.out" Exciter.GCB_status as Connection633
                connect Vf.in Junction18 as Connection644
                connect Vf_out Junction18 as Connection646
                connect check_steady_state_w.w_meas Junction14 as Connection601
                connect "pf Control.dV_out" Exciter.Delta_V_in as Connection710
                connect "pf Control.Q_meas_in" From1 as Connection552
                connect "pf Control.Q_control_mode" From11 as Connection549
                connect "pf Control.Pref" From12 as Connection551
                connect "pf Control.enable" From47 as Connection550
                connect wmeas Junction23 as Connection694
                connect Goto35 Junction25 as Connection718
                connect Junction25 StandBy.in as Connection719
                connect read_OP_mode.StandBy Junction25 as Connection720
                connect Goto36 Junction26 as Connection721
                connect Junction26 GridFollowing.in as Connection722
                connect read_OP_mode.GridFollowing Junction26 as Connection723
                connect GridForming.in Junction27 as Connection724
                connect Junction27 Goto34 as Connection725
                connect read_OP_mode.GridForming Junction27 as Connection726
                connect read_OP_mode.enable Goto33 as Connection727
                connect read_OP_mode.GCB_status "Unit Delay1.out" as Connection728
                connect Round1.out read_OP_mode.OP_mode as Connection729
            }
            [
                position = 9088, 8056
                scale = -1, 1
                size = 208, 200
            ]

            component Subsystem Sync_Check {
                layout = dynamic
                component "core/Logical operator" not {
                    operator = "NOT"
                }
                [
                    position = 9032, 8632
                    hide_name = True
                ]

                component "core/Probe" dw_f {
                }
                [
                    position = 8744, 8096
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join2" {
                    inputs = "3"
                }
                [
                    position = 8704, 8664
                    hide_name = True
                ]

                component "core/Digital Probe" V_match {
                }
                [
                    position = 8728, 7968
                    rotation = left
                ]

                component "core/Digital Probe" Speed_ss {
                }
                [
                    position = 9160, 8280
                    rotation = left
                ]

                component "core/Digital Probe" Phase_match {
                }
                [
                    position = 8720, 8400
                    rotation = right
                ]

                component "core/Digital Probe" dw_synch_ON {
                }
                [
                    position = 9248, 8536
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "5"
                }
                [
                    position = 8632, 8560
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dV {
                }
                [
                    position = 8608, 7928
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join" {
                    inputs = "3"
                }
                [
                    position = 9192, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dw_phase {
                }
                [
                    position = 8744, 8256
                    rotation = left
                ]

                component "core/Digital Probe" f_match {
                }
                [
                    position = 8624, 8176
                    rotation = left
                ]

                component "core/Digital Probe" Check_phase_ON {
                }
                [
                    position = 8592, 8440
                ]

                component "core/Logical operator" and1 {
                }
                [
                    position = 8464, 8440
                    hide_name = True
                ]

                component "core/Probe" dw_synch {
                }
                [
                    position = 9056, 8168
                    rotation = left
                ]

                component "core/Logical operator" and2 {
                    inputs = "5"
                }
                [
                    position = 9120, 8576
                    rotation = left
                    hide_name = True
                ]

                component Subsystem check_V_diff {
                    layout = dynamic
                    component "core/Abs" Abs4 {
                    }
                    [
                        position = 7816, 8176
                        hide_name = True
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8144
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8264, 8216
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8432, 8160
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8048, 8248
                        hide_name = True
                    ]

                    component "core/Gain" Volt_diff {
                        gain = "delta_V/100.0"
                    }
                    [
                        position = 8264, 8256
                    ]

                    component "core/Gain" Vgrid_lowLim {
                        gain = "0.9"
                    }
                    [
                        position = 7864, 8280
                    ]

                    component "core/Probe" V_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    component "core/Gain" Vgrid_upLim {
                        gain = "1.1"
                    }
                    [
                        position = 7864, 8224
                    ]

                    component "core/Constant" one1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7776, 8224
                    ]

                    component "core/Constant" one {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8200, 8256
                    ]

                    component "core/Gain" pu {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 8128, 8144
                    ]

                    component "core/Gain" pu1 {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 7880, 8176
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8360, 8176
                        hide_name = True
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8144, 8064
                        hide_name = True
                    ]

                    component "core/Relational operator" less_equal {
                        relational_op = "<="
                    }
                    [
                        position = 7960, 8216
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8336, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7960, 8272
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "-1"
                            limit_upper = "1"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "V_lowLim"
                            upper_limit = "V_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Kp {
                            gain = "V_Kp"
                        }
                        [
                            position = 8024, 8168
                        ]

                        component "core/Gain" Ki {
                            gain = "V_Ki"
                        }
                        [
                            position = 7976, 8216
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7888, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7944, 8168
                        ]

                        connect In Junction4 as Connection58
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection59
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection60
                        connect Ki.out Sum7.in as Connection56
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8272, 8144
                        size = 64, 48
                    ]

                    port Vgrid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8136
                    ]

                    port Vgen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8152
                    ]

                    port dV {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8160
                    ]

                    port Activate {
                        position = top:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8064
                    ]

                    port V_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8400, 8224
                    ]

                    port Grid_On {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8128, 8248
                    ]

                    junction Junction2 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction3 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction4 sp
                    [
                        position = 8272, 8064
                    ]

                    junction Junction5 sp
                    [
                        position = 7776, 8136
                    ]

                    junction Junction6 sp
                    [
                        position = 7912, 8208
                    ]

                    junction Junction7 sp
                    [
                        position = 7816, 8224
                    ]

                    connect Abs3.in Junction2 as Connection202
                    connect Abs4.in Junction5 as Connection227
                    connect Abs4.out pu1.in as Connection235
                    connect Activate "Unit Delay1.in" as Connection208
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Grid_On and.out as Connection241
                    connect Junction2 pu.out as Connection201
                    connect Junction3 Junction2 as Connection216
                    connect Junction4 "Unit Delay1.out" as Connection219
                    connect Junction5 Vgrid as Connection226
                    connect Junction6 less_equal.in as Connection232
                    connect Junction7 Vgrid_upLim.in as Connection239
                    connect PI.In Junction3 as Connection217
                    connect PI.Reset Junction4 as Connection220
                    connect PI.Out "Signal switch1.in" as Connection214
                    connect "Signal switch1.in2" Junction4 as Connection218
                    connect Sum1.in Junction5 as Connection225
                    connect Sum1.in1 Vgen as Connection60
                    connect V_diff.in Junction3 as Connection215
                    connect V_match Comparator1.out as Connection187
                    connect Vgrid_lowLim.in Junction7 as Connection240
                    connect Vgrid_lowLim.out greater_equal.in1 as Connection237
                    connect Vgrid_upLim.out less_equal.in1 as Connection234
                    connect Volt_diff.out Comparator1.in1 as Connection17
                    connect dV "Signal switch1.out" as Connection181
                    connect greater_equal.in Junction6 as Connection233
                    connect greater_equal.out and.in1 as Connection229
                    connect less_equal.out and.in as Connection228
                    connect one.out Volt_diff.in as Connection14
                    connect one1.out Junction7 as Connection238
                    connect pu.in Sum1.out as Connection198
                    connect pu1.out Junction6 as Connection236
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8520, 8016
                    size = 144, 120
                ]

                component Subsystem PLLs {
                    layout = dynamic
                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8464, 8216
                        hide_name = True
                    ]

                    component "core/Probe" V_grid {
                    }
                    [
                        position = 8296, 8096
                    ]

                    component "core/Probe" wt_grid {
                    }
                    [
                        position = 8464, 8144
                    ]

                    component "core/Bus Split" split1 {
                        outputs = "3"
                    }
                    [
                        position = 8072, 8360
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Probe" wt_gen {
                    }
                    [
                        position = 8464, 8280
                    ]

                    component "core/Bus Split" split {
                        outputs = "3"
                    }
                    [
                        position = 8096, 7936
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" V_gen {
                    }
                    [
                        position = 8216, 8352
                    ]

                    component "core/Gain" Gain1 {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    component Subsystem PLL_Grid {
                        layout = dynamic
                        component "core/Termination" Term1 {
                        }
                        [
                            position = 8128, 8152
                            rotation = left
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_Vt {
                            a_coeff = "[1.0/(2*np.pi*fc_vt),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8224
                        ]

                        component "core/Discrete Transfer Function" LPF_f {
                            a_coeff = "[1.0/(2*np.pi*fc_f),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8216, 8248
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 8104, 8112
                            rotation = left
                            hide_name = True
                        ]

                        component Subsystem PLL {
                            layout = dynamic
                            component "core/Gain" rads_to_Hz {
                                gain = "1/(2*np.pi)"
                            }
                            [
                                position = 8360, 8056
                            ]

                            component "core/Termination" Term {
                            }
                            [
                                position = 8008, 8216
                                rotation = right
                            ]

                            component "core/Unit Delay" "Unit Delay1" {
                            }
                            [
                                position = 8480, 8272
                                rotation = right
                            ]

                            component "core/C function" integrator {
                                global_variables = "real out;"
                                init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                                input_terminals_dimensions = "inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                output_fnc = "/*Begin code section*/
output = out+0.0;
/*End code section*/"
                                output_terminals = "inherit output;"
                                output_terminals_dimensions = "inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                parameters = "real Ts;"
                                update_fnc = "/*Begin code section*/
out += Ts*in;

if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            }
                            [
                                position = 8424, 8136
                                size = 0, 0
                            ]

                            component Subsystem Normalize {
                                layout = dynamic
                                component "core/C function" V_terminal {
                                    init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                    input_terminals = "real d;inherit q;"
                                    input_terminals_dimensions = "inherit;inherit"
                                    input_terminals_feedthrough = "[u\'\']"
                                    input_terminals_show_labels = "False;False;"
                                    output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                    output_terminals = "real t;inherit q_pu;"
                                    output_terminals_dimensions = "inherit;inherit"
                                    output_terminals_feedthrough = "[u\'\']"
                                    output_terminals_show_labels = "False;False;"
                                }
                                [
                                    position = 8192, 8192
                                    size = 0, 0
                                ]

                                port d {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8152
                                ]

                                port q {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8216
                                ]

                                port q_pu {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8352, 8200
                                ]

                                port Vt {
                                    position = top:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8280, 8104
                                    rotation = left
                                ]

                                connect V_terminal.t Vt as Connection8
                                connect V_terminal.d d as Connection1
                                connect V_terminal.q q as Connection3
                                connect q_pu V_terminal.q_pu as Connection9
                            }
                            [
                                position = 8128, 8136
                                size = 64, 64
                            ]

                            component Subsystem PI {
                                layout = dynamic
                                component "core/Sum" Sum6 {
                                    signs = "-+"
                                }
                                [
                                    position = 8304, 8304
                                    hide_name = True
                                    scale = -1, 1
                                ]

                                component "core/Gain" Ki {
                                    gain = "Ki"
                                }
                                [
                                    position = 7960, 8208
                                ]

                                component "core/Limit" Limit1 {
                                    lower_limit = "0.7*2*np.pi*f"
                                    upper_limit = "1.4*2*np.pi*f"
                                }
                                [
                                    position = 8416, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum8 {
                                }
                                [
                                    position = 8272, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum7 {
                                }
                                [
                                    position = 8072, 8216
                                    hide_name = True
                                ]

                                component "core/Gain" Kp {
                                    gain = "Kp"
                                }
                                [
                                    position = 8088, 8144
                                ]

                                component "core/Gain" Kb {
                                    gain = "1000"
                                }
                                [
                                    position = 8200, 8304
                                    scale = -1, 1
                                ]

                                component "core/Integrator" Integrator1 {
                                    init_value = "[2*np.pi*f]"
                                }
                                [
                                    position = 8176, 8216
                                    hide_name = True
                                ]

                                port In {
                                    position = right:auto
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7840, 8144
                                    rotation = down
                                    scale = -1, 1
                                ]

                                port Out {
                                    position = left:auto
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8544, 8176
                                    rotation = down
                                    scale = -1, 1
                                ]

                                junction Junction161 sp
                                [
                                    position = 7904, 8144
                                ]

                                junction Junction162 sp
                                [
                                    position = 8368, 8176
                                ]

                                junction Junction163 sp
                                [
                                    position = 8456, 8176
                                ]

                                connect Integrator1.out Sum8.in1 as Connection352
                                connect Junction161 In as Connection360
                                connect Junction161 Ki.in as Connection359
                                connect Junction161 Kp.in as Connection358
                                connect Junction162 Limit1.in as Connection369
                                connect Junction163 Out as Connection372
                                connect Kb.in Sum6.out as Connection50
                                connect Kp.out Sum8.in as Connection350
                                connect Limit1.out Junction163 as Connection371
                                connect Sum6.in Junction162 as Connection370
                                connect Sum6.in1 Junction163 as Connection373
                                connect Sum7.out Integrator1.in as Connection365
                                connect Sum7.in1 Kb.out as Connection53
                                connect Sum7.in Ki.out as Connection364
                                connect Sum8.out Junction162 as Connection368
                            }
                            [
                                position = 8256, 8136
                                scale = -1, -1
                                size = 48, 48
                            ]

                            component Subsystem ABC_dqz {
                                layout = dynamic
                                component "core/alpha beta to dq" "alpha beta to dq" {
                                }
                                [
                                    position = 8248, 8192
                                ]

                                component "core/abc to alpha beta" "abc to alpha beta" {
                                }
                                [
                                    position = 8024, 8192
                                ]

                                port A {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7952, 8104
                                    rotation = right
                                ]

                                port B {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7904, 8104
                                    rotation = right
                                ]

                                port C {
                                    position = left:3
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7856, 8104
                                    rotation = right
                                ]

                                port wt {
                                    position = left:4
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8176, 8288
                                    rotation = left
                                ]

                                port d {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8320, 8136
                                    rotation = left
                                ]

                                port q {
                                    position = right:2
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8368, 8136
                                    rotation = left
                                ]

                                port z {
                                    position = right:3
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8096, 8288
                                    rotation = right
                                ]

                                connect "abc to alpha beta.A" A as Connection2685
                                connect "abc to alpha beta.B" B as Connection2686
                                connect "abc to alpha beta.C" C as Connection2687
                                connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                                connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                                connect "alpha beta to dq.wt" wt as Connection2690
                                connect d "alpha beta to dq.d" as Connection2692
                                connect q "alpha beta to dq.q" as Connection2693
                                connect z "abc to alpha beta.gamma" as Connection2691
                            }
                            [
                                position = 7912, 8152
                                size = 48, 104
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7736, 8152
                                rotation = left
                            ]

                            port B {
                                label = "B"
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7776, 8176
                                rotation = left
                            ]

                            port C {
                                label = "C"
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7816, 8200
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8008
                            ]

                            port q {
                                label = "q"
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8056
                            ]

                            port Vt {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8192, 8064
                            ]

                            port wt {
                                position = right:5
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8528, 8136
                            ]

                            port f {
                                position = right:4
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8424, 8056
                            ]

                            junction Junction4 sp
                            [
                                position = 8480, 8136
                            ]

                            junction Junction5 sp
                            [
                                position = 8320, 8136
                            ]

                            junction Junction6 sp
                            [
                                position = 8008, 8120
                            ]

                            junction Junction7 sp
                            [
                                position = 8024, 8152
                            ]

                            connect ABC_dqz.A A as Connection233
                            connect ABC_dqz.C C as Connection231
                            connect ABC_dqz.d Junction6 as Connection225
                            connect ABC_dqz.q Junction7 as Connection228
                            connect ABC_dqz.z Term.in as Connection229
                            connect B ABC_dqz.B as Connection232
                            connect Junction4 "Unit Delay1.in" as Connection213
                            connect Junction5 integrator.in as Connection218
                            connect Junction6 d as Connection224
                            [
                                position = 0, 0
                            ]
                            connect Junction7 Normalize.q as Connection227
                            [
                                position = 0, 0
                            ]
                            connect Normalize.d Junction6 as Connection223
                            connect PI.Out Junction5 as Connection219
                            connect PI.In Normalize.q_pu as Connection220
                            connect "Unit Delay1.out" ABC_dqz.wt as Connection230
                            connect Vt Normalize.Vt as Connection184
                            connect f rads_to_Hz.out as Connection199
                            connect integrator.output Junction4 as Connection214
                            connect q Junction7 as Connection226
                            connect rads_to_Hz.in Junction5 as Connection217
                            connect wt Junction4 as Connection212

                            f = "f"

                            mask {
                                description = "Simple PLL with wrapped wt"

                                Kp {
                                    label = "Proportional gain"
                                    widget = edit
                                    type = generic
                                    default_value = "100"
                                }

                                Ki {
                                    label = "Integral gain"
                                    widget = edit
                                    type = generic
                                    default_value = "3200"
                                }

                                f {
                                    label = "Target frequency"
                                    widget = edit
                                    type = generic
                                    default_value = "60"
                                    unit = "Hz"
                                }

                                Ts {
                                    label = "Execution rate"
                                    widget = edit
                                    type = generic
                                    default_value = "Ts"
                                }

                                CODE open
                                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                                
                                    dialog = RegularComponentPropertiesDialog(
                                        component=component,
                                        property_container=component.masks[-1],
                                        current_diagram=current_diagram
                                    )
                                    dialog.exec_()
                                
                                ENDCODE
                            }
                        }
                        [
                            position = 8048, 8224
                            rotation = down
                            scale = -1, -1
                            size = 64, 136
                        ]

                        port f {
                            label = "f"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8280, 8248
                        ]

                        port wt {
                            label = "wt"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8152, 8272
                        ]

                        port Va {
                            label = "Va"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8176
                        ]

                        port Vb {
                            label = "Vb"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8224
                        ]

                        port Vc {
                            label = "Vc"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8272
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8392, 8224
                        ]

                        connect LPF_Vt.in PLL.Vt as Connection12
                        connect LPF_f.in PLL.f as Connection10
                        connect PLL.A Va as Connection1
                        connect PLL.C Vc as Connection3
                        connect Term.in PLL.d as Connection7
                        connect Term1.in PLL.q as Connection8
                        connect Vb PLL.B as Connection2
                        connect Vt LPF_Vt.out as Connection11
                        connect f LPF_f.out as Connection9
                        connect wt PLL.wt as Connection6

                        fc_f = "10.0"
                        fc_vt = "10.0"

                        mask {
                            fc_vt {
                                label = "Vt channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            fc_f {
                                label = "f channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8184, 8024
                        size = 72, 120
                    ]

                    port f_Gen {
                        label = "f_Gen"
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8208
                    ]

                    port f_Grid {
                        label = "f_Grid"
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 7984
                    ]

                    port Vgrid {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8064
                    ]

                    port Vgen {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8288
                    ]

                    port V_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7888
                    ]

                    port V_Gen {
                        label = "V_Gen"
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8416
                    ]

                    port "Phase diff" {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8544, 8216
                    ]

                    tag From2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8352, 8208
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8288, 8024
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction15 sp
                    [
                        position = 8400, 8208
                    ]

                    junction Junction23 sp
                    [
                        position = 8264, 8064
                    ]

                    junction Junction27 sp
                    [
                        position = 8400, 8248
                    ]

                    junction Junction28 sp
                    [
                        position = 8160, 8288
                    ]

                    connect From2 Junction15 as Connection270
                    connect Gain1.out f_Gen as Connection342
                    connect Gain1.in split1.out as Connection349
                    connect Junction15 Sum1.in as Connection271
                    connect Junction23 V_grid.in as Connection329
                    connect Junction27 Sum1.in1 as Connection352
                    connect Junction28 V_gen.in as Connection356
                    connect PLL_Grid.wt Goto2 as Connection294
                    connect PLL_Grid.Vt Junction23 as Connection328
                    connect PLL_Grid.Vb split.out1 as Connection324
                    connect "Phase diff" Sum1.out as Connection336
                    connect V_Grid split.in as Connection134
                    connect Vgen Junction28 as Connection355
                    connect Vgrid Junction23 as Connection330
                    connect f_Grid PLL_Grid.f as Connection327
                    connect split.out2 PLL_Grid.Vc as Connection322
                    connect split.out PLL_Grid.Va as Connection325
                    connect split1.out1 Junction27 as Connection353
                    connect split1.out2 Junction28 as Connection357
                    connect split1.in V_Gen as Connection348
                    connect wt_gen.in Junction27 as Connection351
                    connect wt_grid.in Junction15 as Connection272
                }
                [
                    position = 8288, 8136
                    size = 104, 360
                ]

                component Subsystem Calculate_dw_synch {
                    layout = dynamic
                    component "core/Discrete Transfer Function" LPF_dw {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8200, 8104
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8456, 8120
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8384, 8136
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8400, 8040
                        hide_name = True
                    ]

                    component "core/Gain" dw_K {
                        gain = "dw_K"
                    }
                    [
                        position = 8272, 8104
                    ]

                    component "core/Sum" Sum4 {
                    }
                    [
                        position = 8112, 8104
                        hide_name = True
                    ]

                    port dw_f {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8048
                    ]

                    port dw_phase {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8112
                    ]

                    port dw_synch {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8528, 8120
                    ]

                    port Activate {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8328, 8040
                    ]

                    connect Sum4.out LPF_dw.in as Connection240
                    connect Sum4.in1 dw_phase as Connection231
                    connect "Unit Delay1.in" Activate as Connection180
                    connect "Unit Delay1.out" "Signal switch1.in2" as Connection181
                    connect dw_K.in LPF_dw.out as Connection241
                    connect dw_K.out "Signal switch1.in" as Connection242
                    connect dw_f Sum4.in as Connection239
                    connect dw_synch "Signal switch1.out" as Connection177
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8952, 8216
                    size = 128, 208
                ]

                component Subsystem check_f_diff {
                    layout = dynamic
                    component "core/Gain" Freq_diff {
                        gain = "delta_f/100.0"
                    }
                    [
                        position = 8208, 8256
                    ]

                    component "core/Gain" toPU {
                        gain = "[1.0/(2.0*f)]"
                    }
                    [
                        position = 8216, 8152
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8152
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8208, 8216
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "f"
                    }
                    [
                        position = 8120, 8256
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8280, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Discrete Transfer Function" LPF_dwf {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8128, 8152
                    ]

                    component "core/Probe" f_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    port dw_f {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8152
                    ]

                    port f_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8144
                    ]

                    port f_Gen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8160
                    ]

                    port f_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8224
                    ]

                    junction Junction1 sp
                    [
                        position = 8168, 8152
                    ]

                    connect Abs3.in Junction1 as Connection7
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Comparator1.out f_match as Connection59
                    connect Constant1.out Freq_diff.in as Connection14
                    connect Freq_diff.out Comparator1.in1 as Connection17
                    connect Junction1 LPF_dwf.out as Connection61
                    connect LPF_dwf.in Sum1.out as Connection62
                    connect Sum1.in1 f_Gen as Connection60
                    connect Sum1.in f_Grid as Connection57
                    connect f_diff.in Junction1 as Connection56
                    connect toPU.in Junction1 as Connection40
                    connect toPU.out dw_f as Connection63
                }
                [
                    position = 8520, 8176
                    size = 144, 120
                ]

                component Subsystem check_phase_diff {
                    layout = dynamic
                    component "core/Abs" Abs2 {
                    }
                    [
                        position = 8064, 8096
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" phase_filter {
                    }
                    [
                        position = 8112, 8040
                    ]

                    component "core/Probe" phase_diff {
                    }
                    [
                        position = 7992, 7928
                        rotation = left
                    ]

                    component "core/Discrete Transfer Function" LPF {
                        a_coeff = "[1.0/(2*np.pi*0.5),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8032, 7976
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8024, 8160
                    ]

                    component "core/Gain" Phase_diff {
                        gain = "delta_phi*np.pi/180.0"
                    }
                    [
                        position = 8088, 8160
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8384, 7968
                        hide_name = True
                    ]

                    component "core/C function" confine_phase {
                        init_fnc = "/*Begin code section*/
dtheta = 0;
dtheta_confined = 0;
/*End code section*/"
                        input_terminals = "real dtheta;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        output_fnc = "/*Begin code section*/
if (dtheta > 3.14159265359) {//confine theta to +/- 2*pi;
    dtheta_confined = dtheta - 6.28318530718;
}
else{
    if (dtheta < -3.14159265359){
        dtheta_confined = dtheta + 6.28318530718;
    }
    else{
        dtheta_confined = dtheta;
    }
}
/*End code section*/"
                        output_terminals = "real dtheta_confined;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7776, 7976
                        size = 0, 0
                    ]

                    component "core/Comparator" Comparator2 {
                    }
                    [
                        position = 8160, 8152
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" to_pu {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 7976
                    ]

                    component "core/C function" offset_phase {
                        global_variables = "real off1;real off2;"
                        init_fnc = "/*Begin code section*/
phase_out = 0;
off1 = execution_rate*6.2831853071*f;
off2 = phaseOff*3.141592653589793/180.0;
/*End code section*/"
                        input_terminals = "inherit phase;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "[(\'phase\', True)]"
                        output_fnc = "/*Begin code section*/
phase_out = phase - off1 + off2;
/*End code section*/"
                        output_terminals = "real phase_out;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                        output_terminals_show_labels = "[(\'phase_out\', True)]"
                        parameters = "real f;real phaseOff;"
                    }
                    [
                        position = 7888, 7976
                        size = 0, 0
                    ]

                    component Subsystem Counter {
                        layout = dynamic
                        component "core/Logical operator" not {
                            operator = "NOT"
                        }
                        [
                            position = 8104, 8248
                        ]

                        component "core/C function" c_function {
                            input_terminals = "real counter;"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
if(counter>=0.1/execution_rate){
    out = 1;
}
else{
    out = 0;
}
/*End code section*/"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8288, 8200
                            size = 0, 0
                        ]

                        component "core/Counter" Counter1 {
                        }
                        [
                            position = 8192, 8200
                            size = 48, 48
                        ]

                        port In {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8008, 8192
                        ]

                        port Out {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8368, 8200
                        ]

                        junction Junction14 sp
                        [
                            position = 8056, 8192
                        ]

                        connect Counter1.en Junction14 as Connection559
                        connect Junction14 In as Connection562
                        connect Junction14 not.in as Connection560
                        connect c_function.counter Counter1.out as Connection563
                        connect c_function.out Out as Connection564
                        connect not.out Counter1.reset as Connection88
                    }
                    [
                        position = 8256, 8152
                        size = 48, 48
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Limit" Limit1 {
                            lower_limit = "phase_lowLim"
                            upper_limit = "phase_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Ki {
                            gain = "phase_Ki"
                        }
                        [
                            position = 7984, 8216
                        ]

                        component "core/Gain" Kp {
                            gain = "phase_Kp"
                        }
                        [
                            position = 8032, 8168
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "phase_lowLim"
                            limit_upper = "phase_upLim"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7912, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7952, 8168
                        ]

                        connect In Junction4 as Connection57
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8240, 7976
                        size = 64, 48
                    ]

                    port phase_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8152
                    ]

                    port Activate {
                        position = bottom:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 7864
                        rotation = left
                        scale = 1, -1
                    ]

                    port dw_phase {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8464, 7968
                    ]

                    port phase_Diff {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7688, 7976
                    ]

                    junction Junction15 sp
                    [
                        position = 8064, 7976
                    ]

                    junction Junction17 sp
                    [
                        position = 8064, 8040
                    ]

                    junction Junction21 sp
                    [
                        position = 8240, 7912
                    ]

                    junction Junction22 sp
                    [
                        position = 7992, 7976
                    ]

                    connect Abs2.in Junction17 as Connection590
                    connect Activate Junction21 as Connection622
                    connect Comparator2.in2 Abs2.out as Connection712
                    connect Comparator2.out Counter.In as Connection674
                    connect Junction15 LPF.out as Connection582
                    connect Junction17 Junction15 as Connection591
                    connect Junction21 PI.Reset as Connection693
                    connect Junction21 Product1.in as Connection623
                    connect Junction22 LPF.in as Connection732
                    connect One.out Phase_diff.in as Connection15
                    connect Phase_diff.out Comparator2.in1 as Connection49
                    connect Product1.in1 PI.Out as Connection692
                    connect confine_phase.dtheta phase_Diff as Connection721
                    connect dw_phase Product1.out as Connection714
                    connect offset_phase.phase_out Junction22 as Connection733
                    connect offset_phase.phase confine_phase.dtheta_confined as Connection734
                    connect phase_diff.in Junction22 as Connection731
                    connect phase_filter.in Junction17 as Connection592
                    connect phase_match Counter.Out as Connection673
                    connect to_pu.in Junction15 as Connection581
                    connect to_pu.out PI.In as Connection713
                }
                [
                    position = 8528, 8328
                    size = 168, 112
                ]

                component Subsystem Contactor_Control {
                    layout = dynamic
                    component "core/Digital Probe" GCB_cmd {
                    }
                    [
                        position = 8256, 8224
                        rotation = left
                    ]

                    component "core/C function" wait_to_trip {
                        global_variables = "real time_acc;"
                        init_fnc = "/*Begin code section*/
time_acc = 0;
Trip = 0;
/*End code section*/"
                        input_terminals = "inherit boolean;inherit Reset;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(time_acc>=3.0){
    Trip = 1;
}
else{
    time_acc += execution_rate*boolean;
}
if(Reset ==1){
    time_acc = 0;
    Trip = 0;
}
/*End code section*/"
                        output_terminals = "real Trip;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7616, 8296
                        size = 48, 48
                    ]

                    component "core/Digital Probe" GCB_control {
                    }
                    [
                        position = 7848, 8248
                        rotation = left
                    ]

                    component "core/Constant" Close {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7992, 8248
                    ]

                    component "core/Logical operator" not {
                        operator = "NOT"
                    }
                    [
                        position = 7968, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8072, 8280
                        hide_name = True
                    ]

                    component "core/Logical operator" or {
                        operator = "OR"
                    }
                    [
                        position = 8072, 8400
                        hide_name = True
                    ]

                    component "core/SR Flip Flop" "SR Flip Flop1" {
                    }
                    [
                        position = 8168, 8296
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                        inputs = "5"
                    }
                    [
                        position = 7792, 8296
                    ]

                    component "core/Termination" Termination12 {
                    }
                    [
                        position = 8248, 8312
                        hide_name = True
                    ]

                    component "core/Bus Split" "Bus Split1" {
                        outputs = "3"
                    }
                    [
                        position = 7488, 8032
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Edge Detection" "Edge Detection1" {
                    }
                    [
                        position = 7536, 8320
                        hide_name = True
                        size = 32, 32
                    ]

                    port ss_speed {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8200
                        rotation = right
                    ]

                    port phase_match {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8232
                        rotation = right
                    ]

                    port Gen_on {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8368
                    ]

                    port f_match {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8432
                        rotation = left
                    ]

                    port GCB {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8304, 8280
                    ]

                    port GCB_Control {
                        position = top:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7488, 7960
                        rotation = right
                    ]

                    port V_match {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8408
                        rotation = left
                    ]

                    tag Goto31 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto30 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8096
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From36 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7432, 8288
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto29 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8072
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From35 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7888, 8432
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From34 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8000, 8184
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction32 sp
                    [
                        position = 8256, 8280
                    ]

                    junction Junction34 sp
                    [
                        position = 7848, 8296
                    ]

                    junction Junction35 sp
                    [
                        position = 7488, 8288
                    ]

                    connect "Bus Split1.in" GCB_Control as Connection541
                    connect "Bus Split1.out" Goto29 as Connection542
                    connect Close.out "Signal switch1.in" as Connection129
                    connect "Edge Detection1.In1" Junction35 as Connection559
                    connect From34 "Signal switch1.in2" as Connection534
                    connect From35 or.in1 as Connection535
                    connect GCB_cmd.in Junction32 as Connection528
                    connect Gen_on not.in as Connection517
                    connect Goto30 "Bus Split1.out1" as Connection543
                    connect Goto31 "Bus Split1.out2" as Connection544
                    connect Junction32 GCB as Connection529
                    connect Junction34 GCB_control.in as Connection551
                    connect Junction35 From36 as Connection560
                    connect "SR Flip Flop1.out" Junction32 as Connection530
                    connect "Signal switch1.in1" Junction34 as Connection550
                    connect "Signal switch1.out" "SR Flip Flop1.s_in" as Connection527
                    connect Termination12.in "SR Flip Flop1.out_n" as Connection55
                    connect V_match and.in4 as Connection557
                    connect and.out Junction34 as Connection552
                    connect f_match and.in3 as Connection556
                    connect or.out "SR Flip Flop1.r_in" as Connection501
                    connect or.in not.out as Connection499
                    connect phase_match and.in1 as Connection554
                    connect ss_speed and.in as Connection553
                    connect wait_to_trip.Reset "Edge Detection1.Out1" as Connection562
                    connect wait_to_trip.boolean Junction35 as Connection561
                    connect wait_to_trip.Trip and.in2 as Connection555
                }
                [
                    position = 9280, 8392
                    size = 176, 168
                ]

                component Subsystem Output {
                    layout = dynamic

                    port GCB_status {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "GCB_status"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto7 GCB_status as Connection630
                }
                [
                    position = 9392, 8624
                    size = 48, 48
                ]

                port V_grid {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 7976
                ]

                port GCB {
                    position = bottom:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9464, 8392
                ]

                port To_Gen_Control {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9248, 8104
                ]

                port From_Gen_Control {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8512, 8512
                ]

                port V_gen {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 8296
                ]

                tag From42 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7944
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8656, 8056
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto25 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8608
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8328
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8664, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto28 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8456
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8824, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From48 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8456, 7936
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto31 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9176, 8512
                    hide_name = True
                    size = 60, 20
                ]

                tag From44 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9280, 8240
                    rotation = right
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto29 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8792, 8664
                    hide_name = True
                    size = 60, 20
                ]

                tag From53 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From55 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8784, 8016
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8672
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7968
                    hide_name = True
                    size = 60, 20
                ]

                tag From37 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto30 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From39 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9296, 8624
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8632
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto20 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9480, 8352
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto22 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8680, 8216
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction26 sp
                [
                    position = 9424, 8392
                ]

                junction Junction32 sp
                [
                    position = 9056, 8216
                ]

                junction Junction34 sp
                [
                    position = 8744, 8136
                ]

                junction Junction35 sp
                [
                    position = 8624, 8216
                ]

                junction Junction39 sp
                [
                    position = 9120, 8536
                ]

                junction Junction40 sp
                [
                    position = 8728, 8016
                ]

                junction Junction41 sp
                [
                    position = 8608, 7976
                ]

                junction Junction42 sp
                [
                    position = 9160, 8328
                ]

                junction Junction43 sp
                [
                    position = 8616, 8680
                ]

                junction Junction44 sp
                [
                    position = 8744, 8296
                ]

                junction Junction45 sp
                [
                    position = 8720, 8360
                ]

                junction Junction46 sp
                [
                    position = 8528, 8440
                ]

                connect "Bus Join2.in1" "Bus Split1.out2" as Connection601
                connect "Bus Join2.in" "Bus Split1.out1" as Connection600
                connect "Bus Join2.in2" Junction43 as Connection603
                connect "Bus Split1.in" From_Gen_Control as Connection598
                connect "Bus Split1.out" Goto25 as Connection546
                connect Check_phase_ON.in Junction46 as Connection622
                connect Contactor_Control.ss_speed Junction42 as Connection594
                connect Contactor_Control.phase_match Junction45 as Connection618
                connect From37 Contactor_Control.f_match as Connection270
                connect From39 Contactor_Control.Gen_on as Connection271
                connect From40 Junction42 as Connection596
                connect From41 "Bus Join.in1" as Connection528
                connect From42 "Bus Join.in" as Connection527
                connect From44 Contactor_Control.GCB_Control as Connection541
                connect From47 Calculate_dw_synch.Activate as Connection556
                connect From48 check_V_diff.Activate as Connection586
                connect From49 "Bus Join.in2" as Connection569
                connect From50 Contactor_Control.V_match as Connection574
                connect From52 and2.in3 as Connection584
                connect From53 and1.in1 as Connection585
                connect From55 and2.in4 as Connection609
                connect From56 Output.GCB_status as Connection625
                connect GCB Junction26 as Connection141
                connect Goto20 Junction26 as Connection143
                connect Goto28 Junction32 as Connection250
                connect Goto29 "Bus Join2.out" as Connection540
                connect Goto30 Junction43 as Connection605
                connect Goto31 Junction39 as Connection561
                connect Goto32 Junction41 as Connection575
                connect Goto33 Junction40 as Connection571
                connect Goto34 "Bus Split1.out4" as Connection606
                connect Goto36 check_V_diff.Grid_On as Connection608
                connect Junction26 Contactor_Control.GCB as Connection204
                connect Junction32 Calculate_dw_synch.dw_synch as Connection249
                connect Junction34 Calculate_dw_synch.dw_f as Connection280
                connect Junction35 Goto22 as Connection283
                connect Junction39 and2.out as Connection562
                connect Junction40 check_V_diff.V_match as Connection572
                connect Junction41 check_V_diff.dV as Connection576
                connect Junction42 Speed_ss.in as Connection595
                connect Junction43 "Bus Split1.out3" as Connection604
                connect Junction44 Calculate_dw_synch.dw_phase as Connection616
                connect Junction45 Phase_match.in as Connection619
                connect Junction46 and1.out as Connection623
                connect To_Gen_Control "Bus Join.out" as Connection259
                connect V_gen PLLs.V_Gen as Connection587
                connect V_grid PLLs.V_Grid as Connection588
                connect V_match.in Junction40 as Connection573
                connect and1.in From30 as Connection273
                connect and2.in1 From45 as Connection553
                connect and2.in2 From46 as Connection554
                connect and2.in not.out as Connection552
                connect check_V_diff.Vgen PLLs.Vgen as Connection565
                connect check_V_diff.Vgrid PLLs.Vgrid as Connection566
                connect check_f_diff.dw_f Junction34 as Connection281
                connect check_f_diff.f_match Junction35 as Connection284
                connect check_f_diff.f_Grid PLLs.f_Grid as Connection278
                connect check_f_diff.f_Gen PLLs.f_Gen as Connection277
                connect check_phase_diff.dw_phase Junction44 as Connection617
                connect check_phase_diff.phase_match Junction45 as Connection620
                connect check_phase_diff.Activate Junction46 as Connection624
                connect check_phase_diff.phase_Diff "PLLs.Phase diff" as Connection621
                connect dV.in Junction41 as Connection577
                connect dw_f.in Junction34 as Connection279
                connect dw_phase.in Junction44 as Connection615
                connect dw_synch.in Junction32 as Connection248
                connect dw_synch_ON.in Junction39 as Connection563
                connect f_match.in Junction35 as Connection282
                connect not.in From33 as Connection551
            }
            [
                position = 9448, 8056
                scale = -1, 1
                size = 144, 200
            ]

            component Subsystem Output {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "14"
                }
                [
                    position = 8008, 8216
                    rotation = down
                    hide_name = True
                    scale = -1, -1
                ]

                port Output {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8112, 8216
                ]

                tag From32 {
                    value = "GCB_status"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7680, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "w_meas"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7656, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Gen_On"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7632, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7872, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7776, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7920, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7728, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From22 {
                    value = "Vc"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7752, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7704, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7896, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7800, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                connect "Bus Join1.out" Output as Connection4
                connect From21 "Bus Join1.in8" as Connection572
                connect From22 "Bus Join1.in5" as Connection569
                connect From23 "Bus Join1.in4" as Connection568
                connect From24 "Bus Join1.in7" as Connection571
                connect From25 "Bus Join1.in3" as Connection567
                connect From26 "Bus Join1.in9" as Connection573
                connect From27 "Bus Join1.in13" as Connection577
                connect From28 "Bus Join1.in12" as Connection576
                connect From29 "Bus Join1.in11" as Connection575
                connect From30 "Bus Join1.in10" as Connection574
                connect From31 "Bus Join1.in6" as Connection570
                connect From32 "Bus Join1.in2" as Connection578
                connect From33 "Bus Join1.in1" as Connection580
                connect From34 "Bus Join1.in" as Connection579
            }
            [
                position = 9696, 7968
                size = 104, 96
            ]

            component Subsystem Measurements {
                layout = dynamic
                component "core/Gain" Gain8 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7568
                    hide_name = True
                ]

                component "core/Probe" e_f {
                }
                [
                    position = 7760, 7776
                ]

                component "core/Gain" Gain7 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7632
                    hide_name = True
                ]

                component "core/Bus Join" "Bus Join3" {
                    inputs = "3"
                }
                [
                    position = 8080, 7792
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Bus Join" "Bus Join1" {
                    inputs = "4"
                }
                [
                    position = 8016, 7544
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Probe" pf {
                    addr = "17951"
                }
                [
                    position = 7704, 7696
                ]

                component "core/Probe" P {
                    addr = "17965"
                }
                [
                    position = 7704, 7504
                ]

                component "core/Probe" Q {
                    addr = "17938"
                }
                [
                    position = 7704, 7568
                ]

                component "core/Probe" S {
                    addr = "17951"
                }
                [
                    position = 7704, 7632
                ]

                component "core/Gain" Gain10 {
                    gain = "1.0/(2*np.pi*f)"
                }
                [
                    position = 7696, 7776
                    hide_name = True
                ]

                component "core/Gain" Gain9 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7504
                    hide_name = True
                ]

                component "core/Current Measurement" Ib {
                    addr = "24"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8176
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Current Measurement" Ic {
                    addr = "26"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8272
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7944, 8336
                    rotation = right
                    size = 64, 32
                ]

                component "core/Current Measurement" Ia {
                    addr = "22"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8080
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7856, 8432
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7904, 8384
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Output {
                    layout = dynamic

                    port Va {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8120
                    ]

                    port Vb {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8152
                    ]

                    port Vc {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8192
                    ]

                    port Vt {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8224
                    ]

                    port Ia {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8264
                    ]

                    port Ib {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8296
                    ]

                    port Ic {
                        position = left:7
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8336
                    ]

                    port P {
                        position = left:8
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8368
                    ]

                    port Q {
                        position = left:9
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8408
                    ]

                    port S {
                        position = left:10
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8440
                    ]

                    port pf {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8480
                    ]

                    tag Goto8 {
                        value = "Vb"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8152
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto9 {
                        value = "Vc"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8192
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto10 {
                        value = "Vt"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8224
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto11 {
                        value = "Ib"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8296
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto12 {
                        value = "P"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8368
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto13 {
                        value = "Ic"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8336
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto14 {
                        value = "Ia"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8264
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto15 {
                        value = "Q"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8408
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto16 {
                        value = "S"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto17 {
                        value = "pf"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8480
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto7 {
                        value = "Va"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto10 Vt as Connection4
                    connect Goto13 Ic as Connection7
                    connect Goto14 Ia as Connection5
                    connect Goto15 Q as Connection9
                    connect Goto17 pf as Connection11
                    connect Goto8 Vb as Connection2
                    connect Goto9 Vc as Connection3
                    connect Ib Goto11 as Connection6
                    connect P Goto12 as Connection8
                    connect S Goto16 as Connection10
                    connect Va Goto7 as Connection1
                }
                [
                    position = 8416, 7720
                    size = 96, 328
                ]

                component Subsystem "PQ measure" {
                    layout = dynamic
                    component "core/Power Meter" "PQ Power Meter1" {
                    }
                    [
                        position = 8096, 8192
                    ]

                    component "core/Termination" Termination2 {
                    }
                    [
                        position = 8264, 8232
                        rotation = left
                        hide_name = True
                        scale = -1, -1
                    ]

                    component "core/Termination" Termination1 {
                    }
                    [
                        position = 8264, 8152
                        rotation = left
                        hide_name = True
                        scale = -1, 1
                    ]

                    port S {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8264
                        rotation = right
                        scale = -1, 1
                    ]

                    port pf {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8288
                        rotation = right
                        scale = -1, 1
                    ]

                    port Q {
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8120
                        rotation = left
                        scale = -1, 1
                    ]

                    port P {
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8088
                        rotation = left
                        scale = -1, 1
                    ]

                    port Va {
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8088
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vb {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8120
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vc {
                        position = right:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8152
                        rotation = right
                        scale = -1, 1
                    ]

                    port Ia {
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8224
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ib {
                        position = right:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8256
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ic {
                        position = right:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8288
                        rotation = left
                        scale = -1, 1
                    ]

                    connect "PQ Power Meter1.ia" Ia as Connection1
                    connect "PQ Power Meter1.ib" Ib as Connection2
                    connect "PQ Power Meter1.ic" Ic as Connection3
                    connect "PQ Power Meter1.Pdc" P as Connection4
                    connect "PQ Power Meter1.Qdc" Q as Connection5
                    connect S "PQ Power Meter1.apparent" as Connection9
                    connect Termination1.in "PQ Power Meter1.Pac" as Connection10
                    connect Termination2.in "PQ Power Meter1.Qac" as Connection11
                    connect Va "PQ Power Meter1.va" as Connection13
                    connect Vb "PQ Power Meter1.vb" as Connection14
                    connect Vc "PQ Power Meter1.vc" as Connection15
                    connect pf "PQ Power Meter1.k_factor" as Connection12
                }
                [
                    position = 7424, 7600
                    scale = -1, 1
                    size = 128, 232
                ]

                component Subsystem 3ph_PLL_Gen {
                    layout = dynamic
                    component "core/Termination" Term {
                    }
                    [
                        position = 8080, 8144
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Termination" Term1 {
                    }
                    [
                        position = 8112, 8184
                        rotation = left
                        hide_name = True
                    ]

                    component Subsystem PLL {
                        layout = dynamic
                        component "core/Rate Limiter" "Rate Limiter1" {
                            falling_limit = "2*np.pi*w_fall"
                            rising_limit = "2*np.pi*w_rise"
                        }
                        [
                            position = 8304, 7984
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q1 {
                            a_coeff = "[1,2*zeta*(2*np.pi*fc_w),(2*np.pi*fc_w)**2.0]"
                            b_coeff = "(2*np.pi*fc_w)**2.0"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 7984
                            hide_name = True
                        ]

                        component "core/C function" integrator {
                            init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
out += execution_rate*in;
if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8352, 8136
                            size = 0, 0
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 7864, 8208
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Unit Delay" "Unit Delay1" {
                        }
                        [
                            position = 8432, 8224
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q {
                            a_coeff = "[1.0/(2*np.pi*fc_q),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7912, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_d {
                            a_coeff = "[1.0/(2*np.pi*fc_d),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7856, 8120
                            hide_name = True
                        ]

                        component Subsystem Normalize {
                            layout = dynamic
                            component "core/C function" V_terminal {
                                init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                input_terminals = "real d;inherit q;"
                                input_terminals_dimensions = "inherit;inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                input_terminals_show_labels = "False;False;"
                                output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                output_terminals = "real t;inherit q_pu;"
                                output_terminals_dimensions = "inherit;inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                output_terminals_show_labels = "False;False;"
                            }
                            [
                                position = 8192, 8192
                                size = 0, 0
                            ]

                            port d {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8152
                            ]

                            port q {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8216
                            ]

                            port q_pu {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8352, 8200
                            ]

                            port Vt {
                                position = top:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8280, 8104
                                rotation = left
                            ]

                            connect V_terminal.t Vt as Connection8
                            connect V_terminal.d d as Connection1
                            connect V_terminal.q q as Connection3
                            connect q_pu V_terminal.q_pu as Connection9
                        }
                        [
                            position = 8096, 8136
                            size = 64, 64
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8072, 8400
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "lowLim*2*np.pi*f/100.0"
                                upper_limit = "upLim*2*np.pi*f/100.0"
                            }
                            [
                                position = 8416, 8224
                            ]

                            component "core/Gain" Kp {
                                gain = "Kp"
                            }
                            [
                                position = 7928, 8136
                            ]

                            component "core/Integrator" Integrator2 {
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8112, 8304
                                scale = -1, 1
                            ]

                            component "core/Sum" Sum8 {
                                signs = "+-"
                            }
                            [
                                position = 8032, 8224
                            ]

                            component "core/Gain" Gain1 {
                                gain = "2*np.pi*fc_Kd"
                            }
                            [
                                position = 8152, 8224
                            ]

                            component "core/Gain" Ki {
                                gain = "Ki"
                            }
                            [
                                position = 7928, 8392
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "2*np.pi*f"
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8200, 8400
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8200, 8488
                                scale = -1, 1
                            ]

                            component "core/Gain" Kd {
                                gain = "Kd"
                            }
                            [
                                position = 7928, 8216
                            ]

                            component "core/Sum" Sum5 {
                                signs = "3"
                            }
                            [
                                position = 8328, 8224
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8328, 8488
                                scale = -1, 1
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7752, 8216
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8480, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8376, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8448, 8224
                            ]

                            junction Junction7 sp
                            [
                                position = 8224, 8224
                            ]

                            junction Junction8 sp
                            [
                                position = 7792, 8216
                            ]

                            junction Junction9 sp
                            [
                                position = 7792, 8216
                            ]

                            connect Gain1.out Junction7 as Connection85
                            connect Gain1.in Sum8.out as Connection61
                            connect In Junction9 as Connection94
                            connect Integrator1.out Sum5.in2 as Connection95
                            connect Integrator2.out Sum8.in1 as Connection66
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction7 Integrator2.in as Connection86
                            connect Junction8 Kd.in as Connection90
                            connect Junction9 Junction8 as Connection93
                            connect Kb.in Sum6.out as Connection50
                            connect Kd.out Sum8.in as Connection80
                            connect Ki.in Junction9 as Connection92
                            connect Kp.in Junction8 as Connection89
                            connect Kp.out Sum5.in as Connection68
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.out Junction2 as Connection44
                            connect Sum5.in1 Junction7 as Connection87
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                            connect Sum7.in Ki.out as Connection69
                        }
                        [
                            position = 8200, 8136
                            size = 64, 48
                        ]

                        component Subsystem ABC_dqz {
                            layout = dynamic
                            component "core/abc to alpha beta" "abc to alpha beta" {
                            }
                            [
                                position = 8024, 8192
                            ]

                            component "core/alpha beta to dq" "alpha beta to dq" {
                            }
                            [
                                position = 8248, 8192
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7952, 8104
                                rotation = right
                            ]

                            port B {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7904, 8104
                                rotation = right
                            ]

                            port C {
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7856, 8104
                                rotation = right
                            ]

                            port wt {
                                position = left:4
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8176, 8288
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8320, 8136
                                rotation = left
                            ]

                            port q {
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8368, 8136
                                rotation = left
                            ]

                            port z {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8096, 8288
                                rotation = right
                            ]

                            connect "abc to alpha beta.A" A as Connection2685
                            connect "abc to alpha beta.B" B as Connection2686
                            connect "abc to alpha beta.C" C as Connection2687
                            connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                            connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                            connect "alpha beta to dq.wt" wt as Connection2690
                            connect d "alpha beta to dq.d" as Connection2692
                            connect q "alpha beta to dq.q" as Connection2693
                            connect z "abc to alpha beta.gamma" as Connection2691
                        }
                        [
                            position = 7776, 8152
                            size = 48, 104
                        ]

                        port A {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7608, 8152
                            rotation = left
                        ]

                        port B {
                            label = "B"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8176
                            rotation = left
                        ]

                        port C {
                            label = "C"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7688, 8200
                            rotation = left
                        ]

                        port d {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8024
                        ]

                        port q {
                            label = "q"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8080
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8160, 8072
                        ]

                        port wt {
                            position = right:5
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8072
                        ]

                        port w {
                            position = right:4
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 7984
                        ]

                        junction Junction6 sp
                        [
                            position = 8408, 8136
                        ]

                        junction Junction13 sp
                        [
                            position = 8264, 8136
                        ]

                        junction Junction14 sp
                        [
                            position = 7960, 8120
                        ]

                        junction Junction15 sp
                        [
                            position = 8000, 8152
                        ]

                        connect ABC_dqz.A A as Connection266
                        connect ABC_dqz.B B as Connection267
                        connect ABC_dqz.C C as Connection268
                        connect ABC_dqz.d LPF_d.in as Connection263
                        connect ABC_dqz.q LPF_q.in as Connection264
                        connect ABC_dqz.z Term.in as Connection265
                        connect Junction13 integrator.in as Connection246
                        connect Junction14 Normalize.d as Connection253
                        connect Junction14 d as Connection262
                        connect Junction15 q as Connection261
                        connect Junction6 integrator.out as Connection195
                        connect LPF_d.out Junction14 as Connection254
                        connect LPF_q.out Junction15 as Connection257
                        connect LPF_q1.in "Rate Limiter1.out" as Connection259
                        connect Normalize.q Junction15 as Connection255
                        connect Normalize.Vt Vt as Connection211
                        connect PI.Out Junction13 as Connection247
                        connect PI.In Normalize.q_pu as Connection244
                        connect "Rate Limiter1.in" Junction13 as Connection260
                        connect "Unit Delay1.out" ABC_dqz.wt as Connection269
                        connect "Unit Delay1.in" Junction6 as Connection194
                        connect w LPF_q1.out as Connection258
                        connect wt Junction6 as Connection196

                        f = "f"
                        lowLim = "70"
                        upLim = "140"
                        w_fall = "-f/5"
                        w_rise = "f/5"

                        mask {
                            description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Simple PLL with wrapped wt</span></p></body></html>"

                            Kp {
                                label = "Proportional gain"
                                widget = edit
                                type = generic
                                default_value = "100.0"
                            }

                            Ki {
                                label = "Integral gain"
                                widget = edit
                                type = generic
                                default_value = "3200.0"
                            }

                            Kd {
                                label = "Differential gain"
                                widget = edit
                                type = generic
                                default_value = "1.0"
                            }

                            fc_Kd {
                                label = "Derivative control LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "113.6821"
                            }

                            fc_d {
                                label = "d channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            fc_q {
                                label = "q channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            f {
                                label = "Target frequency"
                                widget = edit
                                type = generic
                                default_value = "60.0"
                                unit = "Hz"
                            }

                            upLim {
                                label = "Frequency deviation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                unit = "%"
                            }

                            lowLim {
                                label = "Frequency deviation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                unit = "%"
                            }

                            zeta {
                                label = "w 2nd order LPF damping ratio"
                                widget = edit
                                type = generic
                                default_value = "0.707"
                            }

                            fc_w {
                                label = "w 2nd order LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "25.0"
                                unit = "Hz"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                            }

                            w_rise {
                                label = "w Rising rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            w_fall {
                                label = "w Falling rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 7984, 8240
                        rotation = down
                        scale = -1, -1
                        size = 72, 152
                    ]

                    port Va {
                        label = "Va"
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8184
                    ]

                    port Vb {
                        label = "Vb"
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8240
                    ]

                    port Vc {
                        label = "Vc"
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8296
                    ]

                    port Vt {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8136, 8240
                    ]

                    port w {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8104, 8264
                    ]

                    port wt {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8072, 8288
                    ]

                    connect PLL.d Term.in as Connection4
                    connect PLL.A Va as Connection1
                    connect PLL.C Vc as Connection3
                    connect PLL.Vt Vt as Connection6
                    connect PLL.wt wt as Connection8
                    connect Term1.in PLL.q as Connection5
                    connect Vb PLL.B as Connection2
                    connect w PLL.w as Connection7
                }
                [
                    position = 7480, 7824
                    size = 72, 120
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R21 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8232, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R20 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8304, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R22 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8376, 7944
                        rotation = right
                    ]

                    port G {
                        position = bottom:3
                        kind = pe
                    }
                    [
                        position = 8304, 8112
                        rotation = left
                    ]

                    port A {
                        position = top:4
                        kind = pe
                    }
                    [
                        position = 8232, 7848
                        rotation = right
                    ]

                    port B {
                        position = top:5
                        kind = pe
                    }
                    [
                        position = 8304, 7848
                        rotation = right
                    ]

                    port C {
                        position = top:6
                        kind = pe
                    }
                    [
                        position = 8376, 7848
                        rotation = right
                    ]

                    junction Junction1516 pe
                    [
                        position = 8304, 8032
                    ]

                    junction Junction1517 pe
                    [
                        position = 8304, 8032
                    ]

                    connect A R21.p_node as Connection758
                    connect B R20.p_node as Connection759
                    connect G Junction1517 as Connection764
                    connect Junction1516 Junction1517 as Connection762
                    connect Junction1516 R21.n_node as Connection755
                    connect Junction1517 R22.n_node as Connection763
                    connect R20.n_node Junction1516 as Connection698
                    connect R22.p_node C as Connection760
                }
                [
                    position = 7664, 8384
                    size = 88, 80
                ]

                port a {
                    label = "a"
                    position = right:1
                    kind = pe
                }
                [
                    position = 8208, 8080
                    rotation = down
                ]

                port b {
                    label = "b"
                    position = right:2
                    kind = pe
                }
                [
                    position = 8208, 8176
                    rotation = down
                ]

                port c {
                    label = "c"
                    position = right:3
                    kind = pe
                }
                [
                    position = 8208, 8272
                    rotation = down
                ]

                port A {
                    label = "A"
                    position = left:1
                    kind = pe
                }
                [
                    position = 7520, 8080
                ]

                port B {
                    label = "B"
                    position = left:2
                    kind = pe
                }
                [
                    position = 7520, 8176
                ]

                port C {
                    label = "C"
                    position = left:3
                    kind = pe
                }
                [
                    position = 7520, 8272
                ]

                port Sync_fb {
                    position = top:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8080, 7728
                    rotation = left
                    scale = -1, 1
                ]

                port Control_fb {
                    position = top:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8016, 7472
                    rotation = left
                    scale = -1, 1
                ]

                tag From22 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8032
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7608
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8384
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7600
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7672
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7624
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto11 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag From43 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag From32 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7632
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7704, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto5 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8136
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7912
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto8 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7520
                    hide_name = True
                    size = 60, 20
                ]

                tag From35 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7848
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7840
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto7 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7488
                    hide_name = True
                    size = 60, 20
                ]

                tag From42 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7744
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7792
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto6 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8232
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7816
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction1497 pe
                [
                    position = 7856, 8080
                ]

                junction Junction1518 sp
                [
                    position = 7520, 7504
                ]

                junction Junction1519 sp
                [
                    position = 7520, 7568
                ]

                junction Junction1520 sp
                [
                    position = 7520, 7632
                ]

                junction Junction1521 sp
                [
                    position = 7520, 7696
                ]

                junction Junction1525 pe
                [
                    position = 7904, 8176
                ]

                junction Junction1528 pe
                [
                    position = 7944, 8272
                ]

                junction Junction1534 pe
                [
                    position = 7904, 8504
                ]

                junction Junction1535 pe
                [
                    position = 7856, 8504
                ]

                junction Junction1536 pe
                [
                    position = 7640, 8080
                ]

                junction Junction1537 pe
                [
                    position = 7664, 8176
                ]

                junction Junction1538 pe
                [
                    position = 7688, 8272
                ]

                junction Junction1540 sp
                [
                    position = 7648, 7824
                ]

                connect 3ph_PLL_Gen.Va From42 as Connection925
                connect 3ph_PLL_Gen.Vt Goto11 as Connection924
                connect 3ph_PLL_Gen.w Junction1540 as Connection926
                connect B Junction1537 as Connection888
                connect "Bus Join1.in" From10 as Connection911
                connect "Bus Join1.in1" From11 as Connection908
                connect "Bus Join1.in2" From32 as Connection910
                connect C Junction1538 as Connection891
                connect Control_fb "Bus Join1.out" as Connection912
                connect From21 Output.Ib as Connection914
                connect From22 Output.Vc as Connection921
                connect From23 Output.Vb as Connection913
                connect From24 Output.Ia as Connection916
                connect From25 Output.Va as Connection918
                connect From26 Output.Ic as Connection920
                connect From27 Output.pf as Connection917
                connect From28 Output.S as Connection919
                connect From29 Output.Q as Connection922
                connect From30 Output.P as Connection915
                connect From31 Output.Vt as Connection923
                connect From33 "Bus Join3.in1" as Connection783
                connect From34 "Bus Join3.in2" as Connection784
                connect From35 "Bus Join3.in" as Connection782
                connect From4 "PQ measure.Va" as Connection714
                connect From40 3ph_PLL_Gen.Vc as Connection899
                connect From41 3ph_PLL_Gen.Vb as Connection898
                connect From43 "Bus Join1.in3" as Connection909
                connect From5 "PQ measure.Vc" as Connection716
                connect From6 "PQ measure.Vb" as Connection715
                connect From7 "PQ measure.Ia" as Connection717
                connect From8 "PQ measure.Ib" as Connection718
                connect From9 "PQ measure.Ic" as Connection719
                connect Gain10.in Junction1540 as Connection904
                connect Goto1 Va.out as Connection703
                connect Goto10 Junction1521 as Connection734
                connect Goto12 Junction1540 as Connection906
                connect Goto13 3ph_PLL_Gen.wt as Connection907
                connect Goto2 Vb.out as Connection705
                connect Goto3 Vc.out as Connection707
                connect Goto4 Ia.out as Connection708
                connect Goto5 Ib.out as Connection709
                connect Goto6 Ic.out as Connection710
                connect Goto7 Junction1518 as Connection725
                connect Goto8 Junction1519 as Connection728
                connect Goto9 Junction1520 as Connection731
                connect Ia.p_node a as Connection218
                connect Ib.p_node b as Connection212
                connect Ic.p_node c as Connection217
                connect Junction1497 Ia.n_node as Connection871
                connect Junction1497 Junction1536 as Connection885
                connect Junction1518 Gain9.in as Connection724
                connect Junction1519 Gain8.in as Connection727
                connect Junction1520 Gain7.in as Connection730
                connect Junction1521 "PQ measure.pf" as Connection733
                connect Junction1525 Ib.n_node as Connection870
                connect Junction1528 Ic.n_node as Connection867
                connect Junction1534 Junction1535 as Connection882
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Va.n_node as Connection883
                connect Junction1536 A as Connection886
                connect Junction1537 Junction1525 as Connection889
                connect Junction1538 Junction1528 as Connection892
                connect P.in Gain9.out as Connection158
                connect "PQ measure.P" Junction1518 as Connection723
                connect "PQ measure.Q" Junction1519 as Connection726
                connect "PQ measure.S" Junction1520 as Connection729
                connect Q.in Gain8.out as Connection161
                connect S.in Gain7.out as Connection192
                connect Snubber.G Junction1535 as Connection884
                connect Snubber.A Junction1536 as Connection887
                connect Snubber.B Junction1537 as Connection890
                connect Snubber.C Junction1538 as Connection893
                connect Sync_fb "Bus Join3.out" as Connection781
                connect Va.p_node Junction1497 as Connection487
                connect Vb.p_node Junction1525 as Connection833
                connect Vb.n_node Junction1534 as Connection839
                connect Vc.p_node Junction1528 as Connection806
                connect e_f.in Gain10.out as Connection824
                connect pf.in Junction1521 as Connection732
            }
            [
                position = 9248, 8320
                scale = -1, 1
                size = 112, 112
            ]

            component Subsystem Ggrid_meas {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "3"
                }
                [
                    position = 8744, 7984
                    rotation = left
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8336, 8168
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8248, 8264
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8296, 8216
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R1 {
                        resistance = "1e5"
                    }
                    [
                        position = 8120, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R2 {
                        resistance = "1e5"
                    }
                    [
                        position = 8192, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R3 {
                        resistance = "1e5"
                    }
                    [
                        position = 8264, 8144
                        rotation = right
                    ]

                    port G {
                        position = bottom:1
                        kind = pe
                    }
                    [
                        position = 8192, 8296
                        rotation = left
                    ]

                    port A {
                        position = top:1
                        kind = pe
                    }
                    [
                        position = 8120, 8064
                        rotation = right
                    ]

                    port B {
                        position = top:2
                        kind = pe
                    }
                    [
                        position = 8192, 8064
                        rotation = right
                    ]

                    port C {
                        position = top:3
                        kind = pe
                    }
                    [
                        position = 8264, 8064
                        rotation = right
                    ]

                    junction Junction1490 pe
                    [
                        position = 8192, 8248
                    ]

                    junction Junction1491 pe
                    [
                        position = 8192, 8248
                    ]

                    connect G Junction1491 as Connection403
                    connect Junction1490 R1.n_node as Connection395
                    connect Junction1491 Junction1490 as Connection402
                    connect R1.p_node A as Connection399
                    connect R2.p_node B as Connection397
                    connect R2.n_node Junction1490 as Connection385
                    connect R3.p_node C as Connection398
                    connect R3.n_node Junction1491 as Connection401
                }
                [
                    position = 8104, 8248
                    size = 64, 48
                ]

                port V {
                    position = top:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8744, 7912
                    rotation = left
                ]

                port A {
                    position = left:1
                    kind = pe
                }
                [
                    position = 7992, 7912
                ]

                port B {
                    position = left:2
                    kind = pe
                }
                [
                    position = 7992, 8016
                ]

                port C {
                    position = left:3
                    kind = pe
                }
                [
                    position = 7992, 8120
                ]

                port a {
                    position = right:1
                    kind = pe
                }
                [
                    position = 8504, 7912
                    rotation = down
                ]

                port b {
                    position = right:2
                    kind = pe
                }
                [
                    position = 8504, 8016
                    rotation = down
                ]

                port c {
                    position = right:3
                    kind = pe
                }
                [
                    position = 8504, 8120
                    rotation = down
                ]

                tag From1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8040
                    hide_name = True
                    size = 0, 0
                ]

                tag From2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8080
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8216
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8264
                    hide_name = True
                    size = 0, 0
                ]

                tag From3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8120
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8168
                    hide_name = True
                    size = 0, 0
                ]

                junction Junction1492 pe
                [
                    position = 8088, 7912
                ]

                junction Junction1493 pe
                [
                    position = 8104, 8016
                ]

                junction Junction1494 pe
                [
                    position = 8120, 8120
                ]

                junction Junction1534 pe
                [
                    position = 8296, 8336
                ]

                junction Junction1535 pe
                [
                    position = 8336, 8120
                ]

                junction Junction1536 pe
                [
                    position = 8296, 8016
                ]

                junction Junction1537 pe
                [
                    position = 8248, 7912
                ]

                junction Junction1538 pe
                [
                    position = 8248, 8336
                ]

                connect A Junction1492 as Connection402
                connect B Junction1493 as Connection405
                connect "Bus Join1.in1" From2 as Connection431
                connect "Bus Join1.in2" From3 as Connection432
                connect C Junction1494 as Connection408
                connect From1 "Bus Join1.in" as Connection430
                connect Goto4 Va.out as Connection703
                connect Goto5 Vc.out as Connection707
                connect Goto6 Vb.out as Connection705
                connect Junction1492 Junction1537 as Connection855
                connect Junction1492 Snubber.A as Connection412
                connect Junction1493 Junction1536 as Connection852
                connect Junction1493 Snubber.B as Connection410
                connect Junction1494 Snubber.C as Connection411
                connect Junction1534 Junction1538 as Connection858
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Junction1494 as Connection850
                connect Junction1536 b as Connection853
                connect Junction1537 a as Connection856
                connect Junction1538 Va.n_node as Connection859
                connect Snubber.G Junction1538 as Connection860
                connect V "Bus Join1.out" as Connection366
                connect Va.p_node Junction1537 as Connection857
                connect Vb.n_node Junction1534 as Connection839
                connect Vb.p_node Junction1536 as Connection854
                connect Vc.p_node Junction1535 as Connection851
                connect c Junction1535 as Connection849
            }
            [
                position = 9608, 8320
                scale = -1, 1
                size = 56, 232
            ]

            component "core/Bus Split" bus_split {
            }
            [
                position = 8888, 8112
            ]

            port A {
                position = 180.0, -96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8224
                scale = -1, 1
            ]

            port B {
                position = 180.0, -0.1
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8320
                scale = -1, 1
            ]

            port C {
                position = 180.0, 96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8416
                scale = -1, 1
            ]

            port Inputs {
                position = -152.0, -120.0
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 9088, 7896
                rotation = right
                scale = -1, 1
            ]

            port Outputs {
                position = 152.0, -120.0
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 9816, 7920
                rotation = left
            ]

            junction Junction118 pe
            [
                position = 8800, 8240
            ]

            junction Junction122 pe
            [
                position = 8800, 8408
            ]

            connect A Ggrid_meas.A as Connection669
            connect B Ggrid_meas.B as Connection670
            connect C Ggrid_meas.C as Connection671
            connect Control.T_out Gen.load_in as Connection611
            connect Control.To_synch_check Sync_Check.From_Gen_Control as Connection673
            connect Gen.r_2 Junction122 as Connection664
            [
                position = 0, 0
                breakpoints = 8864, 8336; 8864, 8408
            ]
            connect Gen.c_in Measurements.c as Connection323
            connect Gen.b_in Measurements.b as Connection318
            connect Gen.a_in Measurements.a as Connection324
            connect Ggrid_meas.b MCB.b_in as Connection481
            connect Ggrid_meas.c MCB.c_in as Connection483
            connect Ggrid_meas.a MCB.a_in as Connection479
            connect If.n_node Junction118 as Connection601
            connect Inputs Control.Inputs as Connection668
            connect Junction118 Gen.r_1 as Connection600
            [
                position = 0, 0
                breakpoints = 8864, 8240; 8864, 8304
            ]
            connect Junction122 Vfield.n_node as Connection665
            connect Measurements.Control_fb Control.Meas_feedback as Connection500
            connect Measurements.B MCB.b_out as Connection613
            connect Measurements.C MCB.c_out as Connection614
            connect Measurements.A MCB.a_out as Connection612
            connect Output.Output Outputs as Connection667
            connect Sync_Check.To_Gen_Control Control.From_synch_check as Connection672
            connect Sync_Check.V_grid Ggrid_meas.V as Connection638
            connect Sync_Check.GCB MCB.ctrl_in as Connection637
            connect Sync_Check.V_gen Measurements.Sync_fb as Connection636
            connect Vfd.in Control.Vf_out as Connection649
            connect Vfd.p_node If.p_node as Connection663
            connect Vfd.n_node Junction122 as Connection666
            connect Vfield.p_node Junction118 as Connection599
            connect Gen.out bus_split.in as Connection674
            [
                position = 0, 0
                breakpoints = 8848, 8232; 8848, 8160
            ]
            connect bus_split.out Control.T_in as Connection675
            connect bus_split.out1 Control.wmeas as Connection676

            Sb = "1e6"
            Ts = "Ts"
            Vn = "480"
            phaseOff = "0.0"

            mask {
                icon = "image(\'diesel_genset.svg\')"
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Diesel Genset with synchronous machine, DEGOV governor, DC4B exciter, frequency setpoint control for w and P, power factor control loop and synch check with grid to close GCB contactor.</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of variable inputs to this block is 9 and they must be sent through a Bus Join in the following order: 0 - Gen_On; 1 - Vref; 2 - wref; 3 - Pref; 4 - pf_ref; 5 - Gen_OP_mode; 6 - Gen_Control_Mode; 7 - Load_share_on; 8 - Load_share.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                                                                                                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of outputs of this block is 14 and they are arranged in the following order: 0 - Gen_On; 1 - wmeas; 2 - GCB_status; 3 - Va; 4 - Vb; 5 - Vc; 6 - Vt; 7 - Ia; 8 - Ib; 9 - Ic; 10 - P; 11 - Q; 12 - S; 13 - pf.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Adjustment of the shunt snubber load is important for simulation stability in multiple time steps.</span></p></body></html>"
                help_file = "diesel_genset.html"

                Sb {
                    label = "Nominal Power"
                    widget = edit
                    type = generic
                    default_value = "2.2e6"
                    unit = "VA"
                    group = "1 - Basic"
                }

                Vn {
                    label = "Phase Nominal Voltage"
                    widget = edit
                    type = generic
                    default_value = "480.0"
                    unit = "V (line to line)"
                    group = "1 - Basic"
                }

                f {
                    label = "Nominal electrical frequency"
                    widget = edit
                    type = generic
                    default_value = "60.0"
                    unit = "Hz"
                    group = "1 - Basic"
                }

                load {
                    label = "Shunt snubber load percentage of nominal power"
                    widget = edit
                    type = generic
                    default_value = "5"
                    unit = "%"
                    group = "1 - Basic"
                }

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                    unit = "s"
                    group = "1 - Basic"
                }

                Rs {
                    label = "Rs"
                    widget = edit
                    type = generic
                    default_value = "9.4035e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Lls {
                    label = "Lls"
                    widget = edit
                    type = generic
                    default_value = "1.389e-5"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmd {
                    label = "Lmd"
                    widget = edit
                    type = generic
                    default_value = "6.5282e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmq {
                    label = "Lmq"
                    widget = edit
                    type = generic
                    default_value = "4.778e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rf_prime {
                    label = "Rf"
                    widget = edit
                    type = generic
                    default_value = "2.1574e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llfd_prime {
                    label = "Llfd"
                    widget = edit
                    type = generic
                    default_value = "1.4195e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkd {
                    label = "Rkd"
                    widget = edit
                    type = generic
                    default_value = "0.0443938909091"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkq {
                    label = "Rkq"
                    widget = edit
                    type = generic
                    default_value = "0.00399796363636"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkd {
                    label = "Llkd"
                    widget = edit
                    type = generic
                    default_value = "0.00155586168397"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkq {
                    label = "Llkq"
                    widget = edit
                    type = generic
                    default_value = "9.96738215238e-05"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nfd {
                    label = "Ns/Nfd"
                    widget = edit
                    type = generic
                    default_value = "0.02512"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkd {
                    label = "Ns/Nkd"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkq {
                    label = "Ns/Nkq"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                pms {
                    label = "pms"
                    widget = edit
                    type = generic
                    default_value = "2.0"
                    group = "3- Synch. mach. - Mec."
                }

                J {
                    label = "Jm"
                    widget = edit
                    type = generic
                    default_value = "42.9467"
                    unit = "kg.m²"
                    group = "3- Synch. mach. - Mec."
                }

                F {
                    label = "Friction coefficient"
                    widget = edit
                    type = generic
                    default_value = "0.572003113298"
                    unit = "Nms"
                    group = "3- Synch. mach. - Mec."
                }

                T1 {
                    label = "Electric control box time constant 1"
                    widget = edit
                    type = generic
                    default_value = "1.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T2 {
                    label = "Electric control box time constant 2"
                    widget = edit
                    type = generic
                    default_value = "1e-6"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T3 {
                    label = "Electric control box time constant 3"
                    widget = edit
                    type = generic
                    default_value = "0.5001"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                K {
                    label = "Actuator gain K"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    group = "4 - Gov. and Eng."
                }

                T4 {
                    label = "Actuator time constant 4"
                    widget = edit
                    type = generic
                    default_value = "25.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T5 {
                    label = "Actuator time constant 5"
                    widget = edit
                    type = generic
                    default_value = "9.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T6 {
                    label = "Actuator time constant 6"
                    widget = edit
                    type = generic
                    default_value = "5.74e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Pm0 {
                    label = "Initial mechanical power"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmax {
                    label = "Maximum torque limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmin {
                    label = "Minimum torque limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Td {
                    label = "Engine time delay"
                    widget = edit
                    type = generic
                    default_value = "24.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Tr {
                    label = "Time constant Tr"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                exc_Kp {
                    label = "Exciter PI proportional gain"
                    widget = edit
                    type = generic
                    default_value = "0.025"
                    group = "5 - Exciter"
                }

                exc_Ki {
                    label = "Exciter PI integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.007"
                    group = "5 - Exciter"
                }

                Ka {
                    label = "Major regulator gain Ka"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Ta {
                    label = "Major regulator time constant Ta"
                    widget = edit
                    type = generic
                    default_value = "2.0e-3"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vrmax {
                    label = "Saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vrmin {
                    label = "Saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Te {
                    label = "Exciter time constant Te"
                    widget = edit
                    type = generic
                    default_value = "1.0e-8"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Ke {
                    label = "Exciter gain Ke"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Kf {
                    label = "Stabilization feedback gain Kf"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "5 - Exciter"
                }

                Tf {
                    label = "Stabilization feedback time constant Tf"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vt0 {
                    label = "Initial terminal voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vf0 {
                    label = "Initial field voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmax {
                    label = "Exciter saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "[\'inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmin {
                    label = "Exciter saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "[\'-inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                delta_f {
                    label = "Synch Check - accepted frequency difference"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                delta_phi {
                    label = "Synch Check - Accepted phase difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                phase_Kp {
                    label = "Synck Check - Phase PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "6 - Adv. 1"
                }

                phase_Ki {
                    label = "Synch Check - Phase PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.00012"
                    group = "6 - Adv. 1"
                }

                phase_upLim {
                    label = "Synch Check - Phase PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "6 - Adv. 1"
                }

                phase_lowLim {
                    label = "Synch Check - Phase PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-0.1"
                    group = "6 - Adv. 1"
                }

                phaseOff {
                    label = "Synch Check - Phase calibration"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                dw_K {
                    label = "Synch Check - delta w gain"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "6 - Adv. 1"
                }

                V_Kp {
                    label = "Synck Check - Voltage PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.0071"
                    group = "6 - Adv. 1"
                }

                V_Ki {
                    label = "Synck Check - Voltage PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.0354"
                    group = "6 - Adv. 1"
                }

                V_upLim {
                    label = "Synck Check - Voltage PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "6 - Adv. 1"
                }

                V_lowLim {
                    label = "Synck Check - Voltage PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-1"
                    group = "6 - Adv. 1"
                }

                delta_V {
                    label = "Synck Check - Accepted voltage difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                w_sp_Kp {
                    label = "Frequency setpoint loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_Ki {
                    label = "Frequency setpoint loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_upLim {
                    label = "Frequency setpoint loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                w_sp_lowLim {
                    label = "Frequency setpoint loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                P_droop {
                    label = "Frequency setpoint loop - P droop"
                    widget = edit
                    type = generic
                    default_value = "2.7"
                    group = "7 - Adv. 2"
                }

                P_rise {
                    label = "Frequency setpoint loop - P rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                P_fall {
                    label = "Frequency setpoint loop - P falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_droop {
                    label = "Frequency setpoint loop - w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                w_rise {
                    label = "Frequency setpoint loop - w rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_fall {
                    label = "Frequency setpoint loop - w falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                gov_Kp {
                    label = "Governor - Proportional gain Kp"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    group = "7 - Adv. 2"
                }

                delta_wn {
                    label = "Governor - Accepted nominal speed difference"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    unit = "%"
                    group = "7 - Adv. 2"
                }

                inner_w_droop {
                    label = "Governor - inner w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                inner_w_rise {
                    label = "Governor - inner w rise"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                inner_w_fall {
                    label = "Governor - inner w fall"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                pf_Kp {
                    label = "Power factor loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.05"
                    group = "8 - Adv. 3"
                }

                pf_Ki {
                    label = "Power factor loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.075"
                    group = "8 - Adv. 3"
                }

                pf_upLim {
                    label = "Power factor loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_lowLim {
                    label = "Power factor loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                pf_rise {
                    label = "Power factor loop - pf rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_fall {
                    label = "Power factor loop - pf falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                exc_dwn {
                    label = "Exciter - start speed"
                    widget = edit
                    type = generic
                    default_value = "75"
                    unit = "%"
                    group = "8 - Adv. 3"
                }

                V_rise {
                    label = "Exciter - V rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_fall {
                    label = "Exciter - V falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_inner_droop {
                    label = "Exciter - V inner droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "8 - Adv. 3"
                }

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, 'diesel_genset.svg')
                ENDCODE

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                
                ENDCODE
            }
        }
        [
            position = 8840, 7184
            rotation = left
            size = 354, 240
        ]

        component "core/Ground" gnd19 {
        }
        [
            position = 8456, 7816
        ]

        component "core/Ground" gnd20 {
        }
        [
            position = 9328, 7816
        ]

        component "core/Transmission Line" "Transmission Line6" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "10"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 9328, 7640
            size = 256, 72
        ]

        component "core/Transmission Line" "Transmission Line7" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "25"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 8456, 7640
            size = 256, 72
        ]

        component "core/Transmission Line" "Transmission Line9" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "110"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 10528, 7632
            size = 256, 72
        ]

        component "core/Ground" gnd22 {
        }
        [
            position = 10528, 7808
        ]

        component "core/Three-phase Meter" "Three-phase at load 9 (area 2)" {
            I_rms = "True"
            P_meas = "True"
            P_method = "RMS based"
            VAB = "True"
            VBC = "True"
            VCA = "True"
            VLL_rms = "True"
            VLn_rms = "True"
            freq = "True"
        }
        [
            position = 9688, 7632
            size = 56, 240
        ]

        component "core/Ground" gnd25 {
        }
        [
            position = 9688, 7840
        ]

        component "core/Parallel RLC Branch" "Parallel RLC Branch2" {
            capacitance = "C_fil2"
            inductance = "L_fil2"
        }
        [
            position = 10136, 7888
            rotation = right
            size = 128, 256
        ]

        component "core/Ground" gnd29 {
        }
        [
            position = 10128, 8064
        ]

        component "core/Voltage Measurement" Vabat10 {
        }
        [
            position = 8776, 7536
            size = 64, 32
        ]

        component "core/Three-phase Meter" "Three-phase at load 8 (mid)" {
            I_rms = "True"
            P_meas = "True"
            P_method = "RMS based"
            VAB = "True"
            VBC = "True"
            VCA = "True"
            VLn_rms = "True"
            freq = "True"
        }
        [
            position = 10848, 7080
            rotation = right
            size = 56, 240
        ]

        component "core/Ground" gnd23 {
        }
        [
            position = 10464, 7088
            rotation = right
        ]

        component "core/Transmission Line" "Transmission Line10" {
            C_metric = "[[Cd, Cnd, Cnd], [Cnd,Cd,Cnd], [Cnd,Cnd,Cd]]"
            L_metric = "[[Ld, Lnd, Lnd], [Lnd,Ld,Lnd], [Lnd,Lnd,Ld]]"
            Length_metric = "110"
            R_metric = "[[Rd, Rnd, Rnd], [Rnd,Rd,Rnd], [Rnd,Rnd,Rd]]"
            model = "PI"
            model_def = "RLC"
            unit_sys = "metric"
        }
        [
            position = 10448, 6496
            size = 256, 72
        ]

        component "core/Ground" gnd30 {
        }
        [
            position = 10448, 6672
        ]

        component "core/Three Phase Two Winding Transformer" Tr5 {
            Sn = "1e6"
            V1 = "339"
            V2 = "5000"
            core_model = "Lm/Rm neglected"
            input = "pu"
            l1 = "0.48e-3"
            l2 = "0.48e-3"
            lm = "156.68213162985495"
            r1 = "1e-5"
            r2 = "1e-5"
            rm = "347.82608695652175"
            winding_1_connection = "D"
            winding_2_connection = "D"
        }
        [
            position = 8040, 7640
            size = 126, 256
        ]

        component "core/Three-phase Meter" "Voltage gen 3" {
            VAB = "True"
            VBC = "True"
            VCA = "True"
        }
        [
            position = 7752, 7640
            scale = -1, 1
            size = 56, 240
        ]

        component "core/Ground" gnd31 {
        }
        [
            position = 7752, 7840
        ]

        component "core/Three Phase Two Winding Transformer" Tr6 {
            Sn = "1e6"
            V1 = "339"
            V2 = "5000"
            core_model = "Lm/Rm neglected"
            input = "pu"
            l1 = "0.48e-3"
            l2 = "0.48e-3"
            lm = "156.68213162985495"
            r1 = "1e-5"
            r2 = "1e-5"
            rm = "347.82608695652175"
            winding_1_connection = "D"
            winding_2_connection = "D"
        }
        [
            position = 8848, 7800
            rotation = left
            size = 126, 256
        ]

        component "core/Three-phase Meter" "Voltage gen 4" {
            VAB = "True"
            VBC = "True"
            VCA = "True"
        }
        [
            position = 8848, 7992
            rotation = left
            size = 56, 240
        ]

        component "core/Ground" gnd32 {
        }
        [
            position = 9144, 7992
            rotation = left
        ]

        component Subsystem DG_in3 {
            layout = dynamic
            component "core/SCADA Input" pf_ref {
                execution_rate = "Ts"
                unit = ""
            }
            [
                position = 8120, 8112
            ]

            component "core/SCADA Input" Gen_OP_mode {
                def_value = "1"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8144
            ]

            component "core/SCADA Input" Gen_On {
                addr = "1427111952"
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 7992
            ]

            component "core/SCADA Input" Load_share {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8112, 8312
            ]

            component "core/SCADA Input" wref {
                addr = "1427111952"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8120, 8056
            ]

            component "core/Bus Join" "Bus Join2" {
                inputs = "9"
            }
            [
                position = 8272, 8392
                rotation = right
                hide_name = True
            ]

            component "core/SCADA Input" Vref {
                addr = "1427111940"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = "pu"
            }
            [
                position = 8160, 8016
            ]

            component "core/SCADA Input" Gen_Control_Mode {
                addr = "1427111944"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 8200
            ]

            component "core/SCADA Input" Pref {
                addr = "1427111936"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8160, 8080
            ]

            component "core/SCADA Input" Load_share_on {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8256
            ]

            port inputs {
                position = right:1
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8272, 8464
                rotation = right
                hide_name = True
            ]

            connect "Bus Join2.out" inputs as Connection828
            connect Gen_Control_Mode.out "Bus Join2.in6" as Connection235
            connect Gen_OP_mode.out "Bus Join2.in5" as Connection565
            connect Gen_On.out "Bus Join2.in" as Connection230
            connect Load_share.out "Bus Join2.in8" as Connection826
            connect Load_share_on.out "Bus Join2.in7" as Connection825
            connect Pref.out "Bus Join2.in3" as Connection233
            connect Vref.out "Bus Join2.in1" as Connection231
            connect pf_ref.out "Bus Join2.in4" as Connection827
            connect wref.out "Bus Join2.in2" as Connection232

            Ts = "Ts"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Scada inputs for the Diesel Genset from the Microgrid Library.</p></body></html>"

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 8656, 8352
            scale = -1, 1
            size = 48, 48
        ]

        component Subsystem Diesel_Gen4 {
            layout = static
            component "core/Signal Controlled Voltage Source" Vfd {
            }
            [
                position = 8672, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" If {
            }
            [
                position = 8736, 8240
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vfield {
            }
            [
                position = 8800, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Triple Pole Single Throw Contactor" MCB {
                ctrl_src = "Model"
            }
            [
                position = 9448, 8320
                scale = -1, 1
                size = 64, 256
            ]

            component "core/Three Phase Wound Rotor Synchronous Machine" Gen {
                Jm = "J"
                Llfd = "Llfd_prime"
                Llkd = "Llkd"
                Llkq = "Llkq"
                Lls = "Lls"
                Lmd = "Lmd"
                Lmq = "Lmq"
                Ns_div_Nfd = "Ns_Nfd"
                Ns_div_Nkd = "Ns_Nkd"
                Ns_div_Nkq = "Ns_Nkq"
                Rf = "Rf_prime"
                Rkd = "Rkd"
                Rkq = "Rkq"
                Rs = "Rs"
                el_torque_out_addr = "8200"
                el_trq_out = "True"
                execution_rate = "Ts"
                friction_coeff = "F"
                load_src = "Model"
                me_speed_out_addr = "8202"
                mech_speed_out = "True"
                pms = "pms"
                res_int_carr_f = "5000.0"
            }
            [
                position = 8984, 8320
                scale = -1, 1
                size = 176, 160
            ]

            component Subsystem Control {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "5"
                }
                [
                    position = 8456, 8192
                    rotation = left
                    hide_name = True
                ]

                component "core/Unit Delay" "Unit Delay2" {
                    execution_rate = "Ts"
                }
                [
                    position = 7920, 8104
                    hide_name = True
                ]

                component "core/Digital Probe" Exciter_on {
                }
                [
                    position = 7800, 7664
                    rotation = left
                ]

                component "core/Unit Delay" "Unit Delay1" {
                }
                [
                    position = 7208, 7696
                    hide_name = True
                ]

                component "core/Probe" Vf {
                    addr = "8978"
                    execution_rate = "Ts"
                }
                [
                    position = 8224, 7768
                    rotation = left
                ]

                component "core/Termination" Termination1 {
                }
                [
                    position = 7384, 8280
                    hide_name = True
                ]

                component "core/Digital Probe" StandBy {
                }
                [
                    position = 7416, 7888
                ]

                component "core/Digital Probe" GridForming {
                }
                [
                    position = 7416, 7952
                ]

                component "core/Unit Delay" "Unit Delay3" {
                    execution_rate = "Ts"
                }
                [
                    position = 8024, 7664
                    hide_name = True
                ]

                component "core/Round" Round1 {
                    round_fn = "round"
                }
                [
                    position = 7208, 7656
                    hide_name = True
                ]

                component "core/Bus Split" "Bus Split2" {
                    outputs = "3"
                }
                [
                    position = 6952, 7856
                    hide_name = True
                ]

                component "core/Digital Probe" GridFollowing {
                }
                [
                    position = 7504, 7928
                ]

                component "core/Bus Split" "Bus Split3" {
                    outputs = "9"
                }
                [
                    position = 6952, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" T {
                }
                [
                    position = 8128, 8184
                    rotation = left
                ]

                component "core/Digital Probe" Gen_On {
                }
                [
                    position = 7120, 8064
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "4"
                }
                [
                    position = 7296, 8104
                    rotation = right
                    hide_name = True
                ]

                component Subsystem check_steady_state_w {
                    layout = dynamic
                    component "core/Gain" speed_diff {
                        gain = "delta_wn/100.0"
                    }
                    [
                        position = 8232, 8208
                    ]

                    component "core/Abs" Abs1 {
                    }
                    [
                        position = 8280, 8160
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator3 {
                    }
                    [
                        position = 8360, 8200
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 8208, 8160
                        hide_name = True
                    ]

                    component "core/Constant" Constant3 {
                        execution_rate = "Ts"
                        value = "2.0*np.pi*f/pms"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    port ss_speed {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8424, 8200
                    ]

                    port w_meas {
                        position = left:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8096, 8152
                    ]

                    junction Junction9 sp
                    [
                        position = 8168, 8208
                    ]

                    connect Abs1.in Sum3.out as Connection5
                    connect Comparator3.in2 Abs1.out as Connection13
                    connect Comparator3.out ss_speed as Connection58
                    connect Constant3.out Junction9 as Connection16
                    connect Junction9 speed_diff.in as Connection39
                    connect Sum3.in1 Junction9 as Connection54
                    connect speed_diff.out Comparator3.in1 as Connection57
                    connect w_meas Sum3.in as Connection59
                }
                [
                    position = 7968, 8440
                    size = 96, 48
                ]

                component Subsystem Governor_and_Engine {
                    layout = dynamic
                    component "core/Signal switch" w_switch1 {
                    }
                    [
                        position = 7832, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum4 {
                        signs = "+--"
                    }
                    [
                        position = 7920, 8000
                        hide_name = True
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "inner_w_fall"
                        rising_limit = "inner_w_rise"
                    }
                    [
                        position = 7568, 7944
                        hide_name = True
                    ]

                    component "core/Probe" wmeas {
                        addr = "8977"
                    }
                    [
                        position = 7832, 8080
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 7352, 7960
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1/Sb"
                    }
                    [
                        position = 7576, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum5 {
                        signs = "3"
                    }
                    [
                        position = 7704, 7984
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7728, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 7496, 7944
                        hide_name = True
                    ]

                    component "core/Gain" "Tpu to T" {
                        execution_rate = "Ts"
                        gain = "-Sb*pms/(2*np.pi*f)"
                    }
                    [
                        position = 8200, 8000
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 7672, 8200
                        hide_name = True
                    ]

                    component "core/Probe" Inner_droop_dw {
                        addr = "8977"
                    }
                    [
                        position = 7936, 8080
                    ]

                    component "core/Probe" wref {
                        addr = "8977"
                    }
                    [
                        position = 7768, 7936
                        rotation = left
                    ]

                    component "core/Constant" Inner_w_droop {
                        execution_rate = "Ts"
                        value = "inner_w_droop"
                    }
                    [
                        position = 7528, 8232
                    ]

                    component Subsystem DEGOV {
                        layout = dynamic
                        component "core/Gain" Kp {
                            gain = "gov_Kp"
                        }
                        [
                            position = 8040, 8160
                        ]

                        component "core/Gain" K {
                            gain = "K"
                        }
                        [
                            position = 8112, 8160
                        ]

                        component "core/Transport Delay" "Transport Delay1" {
                            init_value = "Pm0"
                            time_delay = "Td"
                        }
                        [
                            position = 8392, 8160
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[T5*T6,T5+T6,1]"
                            b_coeff = "[T4,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8176, 8160
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[T1*T2,T1,1]"
                            b_coeff = "[T3,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7960, 8160
                        ]

                        component Subsystem Integrator {
                            layout = dynamic
                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8304
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Tmin"
                                upper_limit = "Tmax"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8216
                                hide_name = True
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "Pm0"
                                limit_lower = "phase_lowLim"
                                limit_upper = "phase_upLim"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                                gain = "1000"
                            }
                            [
                                position = 8216, 8304
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8256
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7968, 8208
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 8368, 8224
                            ]

                            connect In Sum7.in as Connection58
                            connect Integrator1.reset Reset as Connection2
                            connect Junction3 Out as Connection48
                            connect Junction4 Integrator1.out as Connection65
                            connect Junction4 Sum6.in as Connection56
                            connect Kb.in Sum6.out as Connection50
                            connect Limit1.out Junction3 as Connection66
                            connect Limit1.in Junction4 as Connection55
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8264, 8160
                            size = 64, 48
                        ]

                        port T {
                            label = "T"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8488, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8208, 8104
                        ]

                        port w_bias {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7832, 8160
                        ]

                        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Engine</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8368, 8192
                        ]

                        comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Actuator:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">          K (1 + sT4)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">   s(1 + sT5)(1 + sT6)</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8128, 8208
                        ]

                        comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Electric Control Box:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">           (1 + sT3)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">  1 + sT1 + (s^2)T1T2</span></p></body></html> ENDCOMMENT 
                        [
                            position = 7872, 8208
                        ]

                        connect Integrator.In TF2.out as Connection31
                        connect Integrator.Out "Transport Delay1.in" as Connection32
                        connect Kp.out K.in as Connection35
                        connect TF1.out Kp.in as Connection36
                        connect TF2.in K.out as Connection27
                        connect "Transport Delay1.out" T as Connection28
                        connect reset Integrator.Reset as Connection33
                        connect w_bias TF1.in as Connection34
                    }
                    [
                        position = 8072, 8000
                        size = 120, 64
                    ]

                    port w_meas_in {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7656, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    port T_out {
                        label = "T_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8264, 8000
                    ]

                    port "Gen On" {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7448, 7872
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_meas {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7504, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_bias {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7592, 7984
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7784, 8160
                        rotation = down
                        scale = -1, 1
                    ]

                    port dw_synch {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7632, 8000
                    ]

                    port w_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7432, 7928
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7752, 8232
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7440, 7984
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction9 sp
                    [
                        position = 7496, 7872
                    ]

                    junction Junction10 sp
                    [
                        position = 7768, 7984
                    ]

                    junction Junction12 sp
                    [
                        position = 7392, 7960
                    ]

                    junction Junction13 sp
                    [
                        position = 7784, 8080
                    ]

                    junction Junction14 sp
                    [
                        position = 7880, 8080
                    ]

                    connect DEGOV.T "Tpu to T.in" as Connection720
                    connect From1 w_switch1.in1 as Connection695
                    connect GCB_status w_switch1.in2 as Connection691
                    connect "Gen On" Junction9 as Connection678
                    connect Inner_w_droop.out Product1.in1 as Connection764
                    connect Junction10 Sum4.in as Connection684
                    connect Junction12 Goto1 as Connection699
                    connect Junction12 w_switch.in1 as Connection693
                    connect Junction13 wmeas.in as Connection755
                    connect Junction14 Inner_droop_dw.in as Connection758
                    connect Junction9 DEGOV.reset as Connection679
                    connect Product1.in to_pu.out as Connection618
                    connect Product1.out w_switch1.in as Connection712
                    connect Sum4.out DEGOV.w_bias as Connection742
                    connect Sum4.in1 Junction13 as Connection756
                    connect Sum4.in2 Junction14 as Connection759
                    connect Sum5.out Junction10 as Connection683
                    connect "Tpu to T.out" T_out as Connection30
                    connect dw_synch Sum5.in2 as Connection701
                    connect to_pu.in P_meas as Connection619
                    connect "w to wpu.out" Junction13 as Connection754
                    connect "w to wpu.in" w_meas_in as Connection166
                    connect w_bias Sum5.in1 as Connection700
                    connect w_ramp.out Sum5.in as Connection762
                    connect w_ramp.in w_switch.out as Connection761
                    connect w_ref w_switch.in as Connection763
                    connect w_switch.in2 Junction9 as Connection680
                    connect w_switch1.out Junction14 as Connection757
                    connect wref.in Junction10 as Connection685
                    connect zero.out Junction12 as Connection692
                }
                [
                    position = 8016, 8232
                    size = 184, 208
                ]

                component Subsystem Read_Control_mode {
                    layout = dynamic
                    component "core/Digital Probe" PV_mode {
                    }
                    [
                        position = 8264, 8192
                    ]

                    component "core/C function" State {
                        init_fnc = "/*Begin code section*/
Vf = 0;
PV = 0;
PQ = 0;
/*End code section*/"
                        input_terminals = "real enable;inherit P;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;False;"
                        output_fnc = "/*Begin code section*/
if(enable && P && Q){
    Vf = 0;
    PV = 0;
    PQ = 1;
}
else{
    if(enable && P){
        Vf = 0;
        PV = 1;
        PQ = 0;
    }
    else{
        Vf = 1;
        PV = 0;
        PQ = 0;
    }
}
/*End code section*/"
                        output_terminals = "real Vf;inherit PV;inherit PQ;"
                        output_terminals_dimensions = "inherit;inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;False;"
                    }
                    [
                        position = 8144, 8192
                        size = 56, 168
                    ]

                    component "core/Digital Probe" Vf_mode {
                    }
                    [
                        position = 8264, 8128
                    ]

                    component "core/Digital Probe" PQ_mode {
                    }
                    [
                        position = 8264, 8256
                    ]

                    port Enable_outer_loop {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8128
                    ]

                    port P_control_mode {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8192
                    ]

                    port Q_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8256
                    ]

                    connect Enable_outer_loop State.enable as Connection1
                    connect PV_mode.in State.PV as Connection4
                    connect State.PQ PQ_mode.in as Connection6
                    connect State.P P_control_mode as Connection2
                    connect State.Q Q_control_mode as Connection3
                    connect State.Vf Vf_mode.in as Connection5
                }
                [
                    position = 7728, 8448
                    size = 96, 96
                ]

                component Subsystem Start_Exciter {
                    layout = dynamic
                    component "core/Gain" Exciter_start_speed {
                        gain = "exc_dwn/100.0"
                    }
                    [
                        position = 8152, 8248
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8312, 8144
                        hide_name = True
                    ]

                    component "core/Constant" steadyState_w {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8032, 8248
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1.0/(2*np.pi*f/pms)"
                    }
                    [
                        position = 8152, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8224, 8200
                        hide_name = True
                    ]

                    port w_meas {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8192
                    ]

                    port Gen_On {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8136
                    ]

                    port Start {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8144
                    ]

                    connect Comparator1.out and.in1 as Connection73
                    connect Comparator1.in1 "w to wpu.out" as Connection2
                    connect Exciter_start_speed.out Comparator1.in2 as Connection5
                    connect and.in Gen_On as Connection74
                    connect and.out Start as Connection76
                    connect steadyState_w.out Exciter_start_speed.in as Connection56
                    connect "w to wpu.in" w_meas as Connection75
                }
                [
                    position = 7704, 7704
                    size = 104, 64
                ]

                component Subsystem Exciter {
                    layout = dynamic
                    component "core/Gain" one_ov_sqrt_3 {
                        execution_rate = "Ts"
                        gain = "1.0/(3.0**0.5)"
                    }
                    [
                        position = 8032, 8432
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" Vt_to_Vtpu {
                        execution_rate = "Ts"
                        gain = "1.0/(Vn*((2.0/3.0)**0.5))"
                    }
                    [
                        position = 8304, 8248
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8568, 8200
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 8032, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum2 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8184, 8208
                        hide_name = True
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                        value = "1.0"
                    }
                    [
                        position = 8448, 8104
                    ]

                    component "core/Gain" Vfpu_to_Vf {
                        execution_rate = "Ts"
                        gain = "Vn*((2.0/3.0)**0.5)/Ns_Nfd"
                    }
                    [
                        position = 8648, 8200
                    ]

                    component "core/Sum" Sum1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8264, 8104
                        hide_name = True
                    ]

                    component "core/Probe" Vt {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8304
                        rotation = right
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8112, 8272
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Constant" Zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 7680, 8168
                        hide_name = True
                    ]

                    component "core/Probe" V_ref {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8072, 8160
                        rotation = left
                    ]

                    component "core/Signal switch" switch {
                    }
                    [
                        position = 7752, 8184
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" Vpss {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8176, 8128
                    ]

                    component "core/Sum" Sum {
                        execution_rate = "Ts"
                        signs = "3"
                    }
                    [
                        position = 8016, 8200
                        hide_name = True
                    ]

                    component "core/Constant" Const {
                        execution_rate = "Ts"
                        value = "Vf0/Ka"
                    }
                    [
                        position = 8176, 8072
                    ]

                    component "core/Constant" V_inner_droop {
                        execution_rate = "Ts"
                        value = "V_inner_droop"
                    }
                    [
                        position = 7928, 8432
                    ]

                    component "core/Rate Limiter" "Rate Limit" {
                        falling_limit = "V_fall"
                        rising_limit = "V_rise"
                    }
                    [
                        position = 7816, 8184
                        hide_name = True
                    ]

                    component Subsystem DC4B {
                        layout = dynamic
                        component "core/Signal switch" switch {
                        }
                        [
                            position = 8000, 8256
                            hide_name = True
                            scale = 1, -1
                        ]

                        component "core/Product" Product1 {
                        }
                        [
                            position = 8200, 8160
                            hide_name = True
                        ]

                        component "core/Gain" Kf {
                            gain = "Kf"
                        }
                        [
                            position = 8424, 8032
                            scale = -1, 1
                        ]

                        component "core/Discrete Transfer Function" TF4 {
                            a_coeff = "[Tf,1]"
                            b_coeff = "[1,0]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8032
                            scale = -1, 1
                        ]

                        component "core/Gain" KA {
                            gain = "Ka"
                        }
                        [
                            position = 8304, 8160
                        ]

                        component "core/Sum" Sum2 {
                            signs = "-+"
                        }
                        [
                            position = 8000, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF3 {
                            a_coeff = "[Te,Ke]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8552, 8168
                        ]

                        component "core/Constant" One {
                            execution_rate = "Ts"
                        }
                        [
                            position = 7872, 8272
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[Ta,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 8160
                        ]

                        component "core/C function" "Variable Limit" {
                            init_fnc = "/*Begin code section*/
LimitChange = 0;
out = 0;
/*End code section*/"
                            input_terminals = "inherit in;inherit LimitChange;"
                            input_terminals_dimensions = "inherit;inherit"
                            input_terminals_feedthrough = "[u\'\']"
                            input_terminals_show_labels = "True;True;"
                            output_fnc = "/*Begin code section*/
if(LimitChange == 0.0){
    LimitChange = 0.01;
}

if(in>=Vrmax*LimitChange){
    out = Vrmax*LimitChange;
}
else{
    if(in<=Vrmin*LimitChange){
        out = Vrmin*LimitChange;
    }
    else{
        out = in;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[u\'\']"
                            output_terminals_show_labels = "True;"
                            parameters = "real Vrmax;real Vrmin;"
                        }
                        [
                            position = 8464, 8168
                            size = 0, 0
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[Tr,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7768, 8216
                        ]

                        component "core/Sum" Sum1 {
                            signs = "++-"
                        }
                        [
                            position = 7896, 8160
                            hide_name = True
                        ]

                        component "core/Probe" Va {
                        }
                        [
                            position = 8288, 8096
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8312
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Integrator" Integrator1 {
                                limit_lower = "[\'-inf\']"
                                limit_upper = "[\'inf\']"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8232
                                hide_name = True
                            ]

                            component "core/Gain" Kp {
                                gain = "exc_Kp"
                            }
                            [
                                position = 7992, 8152
                            ]

                            component "core/Gain" Ki {
                                gain = "exc_Ki"
                            }
                            [
                                position = 7992, 8216
                            ]

                            component "core/Sum" Sum5 {
                            }
                            [
                                position = 8320, 8224
                                hide_name = True
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Vrmin/Ka"
                                upper_limit = "Vrmax/Ka"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8216, 8312
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8264
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7824, 8184
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8368, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 7928, 8184
                            ]

                            connect Integrator1.reset Reset as Connection2
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction4 In as Connection57
                            connect Kb.in Sum6.out as Connection50
                            connect Ki.in Junction4 as Connection56
                            connect Ki.out Sum7.in as Connection54
                            connect Kp.in Junction4 as Connection58
                            connect Kp.out Sum5.in as Connection59
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.in1 Integrator1.out as Connection5
                            connect Sum5.out Junction2 as Connection44
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8104, 8152
                            size = 64, 48
                        ]

                        port Vfd {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8672, 8168
                        ]

                        port Vref {
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8048, 8088
                        ]

                        port Vpss {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8104
                        ]

                        port Vt {
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8216
                        ]

                        port Linearize {
                            position = top:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8320
                        ]

                        junction Junction6 sp
                        [
                            position = 8248, 8160
                        ]

                        junction Junction10 sp
                        [
                            position = 8160, 8256
                        ]

                        junction Junction13 sp
                        [
                            position = 7816, 8216
                        ]

                        junction Junction14 sp
                        [
                            position = 8608, 8168
                        ]

                        connect Junction10 Product1.in1 as Connection102
                        connect Junction13 Sum1.in2 as Connection114
                        connect Junction14 Vfd as Connection126
                        connect Junction6 KA.in as Connection77
                        connect Kf.in Junction14 as Connection128
                        connect Linearize switch.in2 as Connection74
                        connect One.out switch.in as Connection75
                        connect PI.In Sum2.out as Connection48
                        connect Product1.out Junction6 as Connection76
                        connect Product1.in PI.Out as Connection49
                        connect Sum2.in1 Sum1.out as Connection5
                        connect TF1.out Junction13 as Connection113
                        connect TF2.in KA.out as Connection10
                        connect TF3.out Junction14 as Connection125
                        connect TF3.in "Variable Limit.out" as Connection118
                        connect TF4.in Kf.out as Connection127
                        connect TF4.out Sum2.in as Connection123
                        connect Va.in Junction6 as Connection78
                        connect "Variable Limit.LimitChange" Junction10 as Connection103
                        connect "Variable Limit.in" TF2.out as Connection89
                        connect Vpss Sum1.in as Connection45
                        connect Vref Sum1.in1 as Connection46
                        connect Vt TF1.in as Connection112
                        connect reset PI.Reset as Connection117
                        connect switch.out Junction10 as Connection101
                        connect switch.in1 Junction13 as Connection115

                        Ka = "Ka"
                        Ke = "Ke"
                        Kf = "Kf"
                        Ta = "Ta"
                        Te = "Te"
                        Tf = "Tf"
                        Tr = "Tr"
                        Vf0 = "Vf0"
                        Vfmax = "Efmax"
                        Vfmin = "Efmin"
                        Vrmax = "Vrmax"
                        Vrmin = "Vrmin"
                        exc_Ki = "exc_Ki"
                        exc_Kp = "exc_Kp"

                        mask {
                            description = "IEEE DC1A exciter model."

                            Tr {
                                label = "Time constant Tr"
                                widget = edit
                                type = generic
                                default_value = "2e-6"
                                group = "General"
                            }

                            exc_Kp {
                                label = "Exciter PI proportional gain"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            exc_Ki {
                                label = "Exciter PI integral gain"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Ka {
                                label = "Major regulator gain Ka"
                                widget = edit
                                type = generic
                                default_value = "200"
                                group = "General"
                            }

                            Ta {
                                label = "Major regulator time constant  Ta"
                                widget = edit
                                type = generic
                                default_value = "2e-3"
                                group = "General"
                            }

                            Vrmax {
                                label = "Saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                group = "General"
                            }

                            Vrmin {
                                label = "Saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                group = "General"
                            }

                            Te {
                                label = "Exciter time constant Te"
                                widget = edit
                                type = generic
                                default_value = "1e-8"
                                group = "General"
                            }

                            Ke {
                                label = "Exciter gain Ke"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            Kf {
                                label = "Stabilization feedback gain Kf"
                                widget = edit
                                type = generic
                                default_value = "0.0"
                                group = "General"
                            }

                            Tf {
                                label = "Stabilization feedback time constant Tf"
                                widget = edit
                                type = generic
                                default_value = "1.0e-12"
                                group = "General"
                            }

                            Vf0 {
                                label = "Initial field voltage"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Vfmax {
                                label = "Exciter saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "[\'inf\']"
                                group = "General"
                            }

                            Vfmin {
                                label = "Exciter saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "[\'-inf\']"
                                group = "General"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                                group = "General"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8448, 8208
                        size = 112, 120
                    ]

                    port Delta_V_in {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8200
                    ]

                    port Vf_out {
                        label = "Vf_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8200
                    ]

                    port Vt_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8248
                    ]

                    port Vref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8200
                    ]

                    port dV {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7944, 8216
                    ]

                    port Start {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7696, 8256
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8336
                        rotation = down
                        scale = -1, 1
                    ]

                    port Q_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8072
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7816, 8256
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction112 sp
                    [
                        position = 7752, 8256
                    ]

                    junction Junction116 sp
                    [
                        position = 8072, 8200
                    ]

                    junction Junction117 sp
                    [
                        position = 8416, 8072
                    ]

                    junction Junction118 sp
                    [
                        position = 8360, 8248
                    ]

                    connect Const.out Sum1.in as Connection3
                    connect DC4B.reset Junction117 as Connection743
                    connect DC4B.Vt Junction118 as Connection748
                    connect DC4B.Vfd Product1.in1 as Connection739
                    connect DC4B.Vref Sum2.out as Connection745
                    connect GCB_status Product2.in as Connection709
                    connect Goto1 Junction112 as Connection121
                    connect Junction112 switch.in2 as Connection120
                    connect Junction116 Sum.out as Connection720
                    connect Junction117 From1 as Connection742
                    connect Junction118 Vt.in as Connection747
                    connect One.out DC4B.Linearize as Connection740
                    connect Product1.in Junction117 as Connection741
                    connect Product2.out Sum2.in1 as Connection717
                    connect Product2.in1 to_pu.out as Connection710
                    connect "Rate Limit.out" Sum.in as Connection59
                    connect "Rate Limit.in" switch.out as Connection58
                    connect Start Junction112 as Connection119
                    connect Sum.in1 Delta_V_in as Connection25
                    connect Sum1.out DC4B.Vpss as Connection744
                    connect Sum2.in Junction116 as Connection721
                    connect V_inner_droop.out one_ov_sqrt_3.in as Connection749
                    connect V_ref.in Junction116 as Connection719
                    connect Vf_out Vfpu_to_Vf.out as Connection126
                    connect Vfpu_to_Vf.in Product1.out as Connection125
                    connect Vpss.out Sum1.in1 as Connection32
                    connect Vref switch.in as Connection87
                    connect Vt_to_Vtpu.out Junction118 as Connection746
                    connect Vt_to_Vtpu.in Vt_in as Connection36
                    connect Zero.out switch.in1 as Connection45
                    connect dV Sum.in2 as Connection88
                    connect one_ov_sqrt_3.out Product2.in2 as Connection724
                    connect to_pu.in Q_meas as Connection619
                }
                [
                    position = 8088, 7816
                    size = 192, 200
                ]

                component Subsystem "pf Control" {
                    layout = dynamic
                    component "core/Signal switch" "Signal switch2" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7872, 8192
                        hide_name = True
                    ]

                    component "core/Probe" delta_V {
                        addr = "8972"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8392, 8160
                    ]

                    component "core/Probe" pf_r {
                    }
                    [
                        position = 7808, 8208
                    ]

                    component "core/C function" norm_pf_ref {
                        global_variables = "real u;"
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
/*End code section*/"
                        input_terminals = "real pf;inherit P;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(P>=0){
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7712, 8176
                        size = 48, 48
                    ]

                    component "core/Probe" pf_m {
                    }
                    [
                        position = 7912, 8304
                    ]

                    component "core/Logical operator" "Logical operator5" {
                        inputs = "4"
                    }
                    [
                        position = 7904, 8016
                        rotation = right
                        hide_name = True
                    ]

                    component "core/C function" norm_pf_meas {
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
Q = 0.0;
/*End code section*/"
                        input_terminals = "real pf;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(pf>=0){
    if(Q>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(Q>=0){
        pf_norm = 2+pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7760, 8304
                        size = 48, 48
                    ]

                    component "core/Rate Limiter" "Rate Limiter1" {
                        falling_limit = "pf_fall"
                        rising_limit = "pf_rise"
                    }
                    [
                        position = 7936, 8192
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "0.1/Sb"
                    }
                    [
                        position = 7720, 7992
                        hide_name = True
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7824, 7944
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch4" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8304, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8032, 8200
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8240, 8232
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Ki {
                            gain = "pf_Ki"
                        }
                        [
                            position = 7992, 8216
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "pf_lowLim"
                            upper_limit = "pf_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "pf_Kp"
                        }
                        [
                            position = 7992, 8136
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7824, 8176
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7920, 8176
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection60
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection61
                        connect Kp.in Junction4 as Connection59
                        connect Kp.out Sum5.in as Connection57
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                        connect Sum7.in Ki.out as Connection54
                    }
                    [
                        position = 8144, 8200
                        size = 64, 48
                    ]

                    port Q_meas_in {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8344
                    ]

                    port Q_control_mode {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7792, 7840
                    ]

                    port enable {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7832, 7800
                    ]

                    port dV_out {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8392, 8216
                    ]

                    port P_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7880
                    ]

                    port pf_ref {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8128
                    ]

                    port pf_meas {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8280
                    ]

                    port Pref {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7936
                    ]

                    port P_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8184
                    ]

                    port Q_active {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8000
                    ]

                    tag Goto1 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8072, 8064
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7808, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction75 sp
                    [
                        position = 8344, 8216
                    ]

                    junction Junction81 sp
                    [
                        position = 7872, 8120
                    ]

                    junction Junction84 sp
                    [
                        position = 8144, 8120
                    ]

                    junction Junction85 sp
                    [
                        position = 7840, 8248
                    ]

                    junction Junction86 sp
                    [
                        position = 7840, 8304
                    ]

                    junction Junction87 sp
                    [
                        position = 7768, 8176
                    ]

                    junction Junction88 sp
                    [
                        position = 7984, 8064
                    ]

                    connect Constant1.out greater_equal.in1 as Connection125
                    connect From2 Junction81 as Connection52
                    connect Goto1 Junction88 as Connection128
                    connect Junction75 dV_out as Connection2
                    connect Junction81 Junction84 as Connection79
                    connect Junction81 "Signal switch2.in2" as Connection53
                    connect Junction84 "Signal switch4.in2" as Connection80
                    connect Junction85 "Signal switch2.in1" as Connection99
                    connect Junction86 Junction85 as Connection102
                    connect Junction87 "Signal switch2.in" as Connection108
                    connect Junction88 "Logical operator5.out" as Connection129
                    connect PI.Reset Junction84 as Connection81
                    connect PI.Out "Signal switch4.in" as Connection77
                    connect P_control_mode "Logical operator5.in2" as Connection84
                    connect P_meas norm_pf_ref.P as Connection127
                    connect Q_active Junction88 as Connection130
                    connect Q_control_mode "Logical operator5.in1" as Connection135
                    connect Q_meas_in norm_pf_meas.Q as Connection96
                    connect "Rate Limiter1.out" Sum6.in as Connection134
                    connect "Signal switch2.out" "Rate Limiter1.in" as Connection133
                    connect "Signal switch4.out" Junction75 as Connection17
                    connect Sum6.in1 Junction85 as Connection98
                    connect Sum6.out PI.In as Connection123
                    connect delta_V.in Junction75 as Connection20
                    connect enable "Logical operator5.in" as Connection136
                    connect greater_equal.out "Logical operator5.in3" as Connection126
                    connect greater_equal.in Pref as Connection124
                    connect norm_pf_meas.pf_norm Junction86 as Connection101
                    connect norm_pf_ref.pf_norm Junction87 as Connection107
                    connect norm_pf_ref.pf pf_ref as Connection132
                    connect pf_m.in Junction86 as Connection103
                    connect pf_meas norm_pf_meas.pf as Connection104
                    connect pf_r.in Junction87 as Connection109
                    connect zero1.out "Signal switch4.in1" as Connection75
                }
                [
                    position = 7736, 7912
                    size = 144, 272
                ]

                component Subsystem Output {
                    layout = dynamic

                    port w_meas {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8216
                    ]

                    port Gen_On {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "Gen_On"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto8 {
                        value = "w_meas"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8216
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Gen_On Goto7 as Connection632
                    connect Goto8 w_meas as Connection631
                }
                [
                    position = 8448, 8416
                    size = 56, 72
                ]

                component Subsystem Freq_setpoint_control {
                    layout = dynamic
                    component "core/Gain" P_3ph_to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 7960, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Constant" P_Droop {
                        execution_rate = "Ts"
                        value = "P_droop"
                    }
                    [
                        position = 7864, 7864
                    ]

                    component "core/Sum" Sum5 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8168, 7944
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" w_Droop {
                        execution_rate = "Ts"
                        value = "w_droop"
                    }
                    [
                        position = 8120, 8296
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 9184, 8352
                    ]

                    component "core/Signal switch" load_share_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8888, 8232
                        hide_name = True
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8208, 8344
                        hide_name = True
                    ]

                    component "core/Probe" w_Psp {
                    }
                    [
                        position = 8360, 7904
                        rotation = left
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 8400, 8512
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 8280, 8528
                        hide_name = True
                    ]

                    component "core/Probe" w_Pm {
                    }
                    [
                        position = 8360, 8016
                        rotation = left
                    ]

                    component "core/Signal switch" mode_switch1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 9408, 8368
                        hide_name = True
                    ]

                    component "core/Product" Product3 {
                        signs = "3"
                    }
                    [
                        position = 8152, 8056
                        hide_name = True
                    ]

                    component "core/Signal switch" mode_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8776, 8352
                        hide_name = True
                    ]

                    component "core/Limit" P_limit {
                        lower_limit = "0.0"
                        upper_limit = "1.0/1.25"
                    }
                    [
                        position = 7872, 7936
                        hide_name = True
                    ]

                    component "core/Sum" Sum8 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8608, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" f_droop_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8360
                        hide_name = True
                    ]

                    component "core/Probe" delta_w {
                        addr = "8975"
                        execution_rate = "Ts"
                    }
                    [
                        position = 9056, 8288
                        rotation = left
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8032, 7936
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7880, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum7 {
                    }
                    [
                        position = 8976, 8344
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8616, 7952
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Probe" w_sp {
                    }
                    [
                        position = 8712, 7992
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "w_fall"
                        rising_limit = "w_rise"
                    }
                    [
                        position = 8472, 8512
                        hide_name = True
                    ]

                    component "core/Rate Limiter" P_ramp {
                        falling_limit = "P_fall"
                        rising_limit = "P_rise"
                    }
                    [
                        position = 7936, 7936
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "w_sp_Kp"
                        }
                        [
                            position = 8008, 8152
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Ki {
                            gain = "w_sp_Ki"
                        }
                        [
                            position = 8008, 8216
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "w_sp_lowLim"
                            upper_limit = "w_sp_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7872, 8184
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7928, 8184
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.in Junction4 as Connection57
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 9296, 8352
                        size = 64, 48
                    ]

                    port Pmeas_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7864, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 7936
                    ]

                    port enable {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8280
                    ]

                    port w_meas {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_ref {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8496
                        rotation = down
                        scale = -1, 1
                    ]

                    port Load_Share {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8800, 8200
                    ]

                    port w_bias {
                        position = auto:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 9480, 8368
                    ]

                    port Load_Share_on {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8824, 8136
                    ]

                    port P_mode {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8288
                    ]

                    tag Goto2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8416, 8568
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From5 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9216, 8272
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8280, 8376
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From4 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9096, 8360
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto4 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8440, 8280
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8064, 7864
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto3 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7968, 8040
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From7 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9320, 8416
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8064, 8056
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From6 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From3 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8800, 8248
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction4 sp
                    [
                        position = 8072, 8016
                    ]

                    junction Junction6 sp
                    [
                        position = 8056, 8352
                    ]

                    junction Junction7 sp
                    [
                        position = 8344, 8528
                    ]

                    junction Junction8 sp
                    [
                        position = 7992, 8016
                    ]

                    junction Junction9 sp
                    [
                        position = 8360, 7944
                    ]

                    junction Junction10 sp
                    [
                        position = 8360, 8056
                    ]

                    junction Junction11 sp
                    [
                        position = 8656, 7992
                    ]

                    junction Junction12 sp
                    [
                        position = 9056, 8344
                    ]

                    junction Junction13 sp
                    [
                        position = 7920, 8016
                    ]

                    junction Junction14 sp
                    [
                        position = 8360, 8280
                    ]

                    junction Junction15 sp
                    [
                        position = 9296, 8272
                    ]

                    junction Junction16 sp
                    [
                        position = 7992, 7864
                    ]

                    comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8384, 8328
                    ]

                    comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_P_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8208, 7912
                    ]

                    comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8640, 8376
                    ]

                    comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8512, 8384
                    ]

                    comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Power setpoint loop</span></p></body></html> ENDCOMMENT 
                    [
                        position = 7904, 7816
                    ]

                    comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8656, 8056
                        rotation = right
                    ]

                    comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Frequency setpoint loop</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp = f_rated*Droop*Ppu</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Ppu = Pmeas/Prated</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">f_rated = 1pu</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8008, 8392
                    ]

                    connect From1 Product3.in1 as Connection631
                    connect From2 f_droop_switch.in1 as Connection655
                    connect From3 load_share_switch.in1 as Connection656
                    connect From5 Junction15 as Connection714
                    connect From6 w_switch.in2 as Connection711
                    connect From7 mode_switch1.in1 as Connection717
                    connect Goto2 Junction7 as Connection654
                    connect Goto3 Junction13 as Connection698
                    connect Goto4 Junction14 as Connection710
                    connect Junction10 Sum6.in as Connection682
                    connect Junction11 Sum6.out as Connection685
                    connect Junction12 Sum7.out as Connection693
                    connect Junction13 Junction8 as Connection697
                    connect Junction14 f_droop_switch.in2 as Connection709
                    connect Junction15 PI.Reset as Connection715
                    connect Junction16 Goto1 as Connection725
                    connect Junction4 Junction8 as Connection674
                    connect Junction6 Product1.in1 as Connection648
                    connect Junction7 w_switch.in1 as Connection653
                    connect Junction8 Product2.in2 as Connection675
                    connect Junction9 Sum5.out as Connection679
                    connect Load_Share load_share_switch.in as Connection659
                    connect Load_Share_on load_share_switch.in2 as Connection718
                    connect P_3ph_to_pu.out Junction6 as Connection647
                    connect P_Droop.out Junction16 as Connection726
                    connect P_limit.in P_ref as Connection721
                    connect P_mode mode_switch.in2 as Connection719
                    connect P_ramp.in P_limit.out as Connection720
                    connect Pmeas_in P_3ph_to_pu.in as Connection58
                    connect Product2.in Junction16 as Connection724
                    connect Product2.in1 P_ramp.out as Connection645
                    connect Product3.out Junction10 as Connection681
                    connect Product3.in Junction4 as Connection626
                    connect Product3.in2 Junction6 as Connection649
                    connect Sum3.in1 From4 as Connection707
                    connect Sum3.in Junction12 as Connection694
                    connect Sum3.out PI.In as Connection687
                    connect Sum5.in Junction4 as Connection624
                    connect Sum5.in1 Product2.out as Connection611
                    connect Sum6.in1 Junction9 as Connection678
                    connect Sum8.in f_droop_switch.out as Connection637
                    connect Sum8.in1 w_ramp.out as Connection638
                    connect delta_w.in Junction12 as Connection692
                    connect enable Junction14 as Connection708
                    connect f_droop_switch.in Product1.out as Connection634
                    connect load_share_switch.out Sum7.in as Connection650
                    connect mode_switch.in Junction11 as Connection684
                    connect mode_switch.out Sum7.in1 as Connection644
                    connect mode_switch.in1 Sum8.out as Connection643
                    connect mode_switch1.in2 Junction15 as Connection716
                    connect mode_switch1.in PI.Out as Connection712
                    connect "w to wpu.out" Junction13 as Connection696
                    connect w_Droop.out Product1.in as Connection722
                    connect w_Pm.in Junction10 as Connection683
                    connect w_Psp.in Junction9 as Connection680
                    connect w_bias mode_switch1.out as Connection713
                    connect w_meas "w to wpu.in" as Connection677
                    connect w_ramp.in w_switch.out as Connection103
                    connect w_ref w_switch.in as Connection180
                    connect w_sp.in Junction11 as Connection686
                    connect zero1.out Junction7 as Connection652
                }
                [
                    position = 7696, 8224
                    size = 120, 264
                ]

                component Subsystem Define_control_mode {
                    layout = dynamic
                    component "core/C function" Control_mode {
                        init_fnc = "/*Begin code section*/
P_control = 0;
Q_control = 0;
/*End code section*/"
                        input_terminals = "real Control_mode;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        output_fnc = "/*Begin code section*/
if(Control_mode == 1){
    //PV mode
    P_control = 1;
    Q_control = 0;
}
else{
    if(Control_mode == 2){
        //PQ mode
        P_control = 1;
        Q_control = 1;
    }
    else{
        P_control = 0;
        Q_control = 0;
    }
}
/*End code section*/"
                        output_terminals = "real P_control;inherit Q_control;"
                        output_terminals_dimensions = "inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;"
                    }
                    [
                        position = 8224, 8184
                        size = 176, 96
                    ]

                    port Gen_Control_Mode {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8184
                    ]

                    port P_Control {
                        position = right:11
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8152
                    ]

                    port Q_Control {
                        position = right:12
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8216
                    ]

                    connect Control_mode.Control_mode Gen_Control_Mode as Connection3
                    connect Control_mode.P_control P_Control as Connection2
                    connect Control_mode.Q_control Q_Control as Connection1
                }
                [
                    position = 7328, 8432
                    size = 144, 64
                ]

                component "core/C function" read_OP_mode {
                    init_fnc = "/*Begin code section*/
OP_mode =0;
enable = 0;
StandBy = 1;
GridFollowing = 0;
GridForming = 0;
/*End code section*/"
                    input_terminals = "real OP_mode;inherit GCB_status;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[u\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
if(OP_mode==0){
    StandBy= 1;
    GridFollowing = 0;
    GridForming = 0;
    enable = 0;
}
else{
    if(OP_mode == 1){
        StandBy = 0;
        GridFollowing = 1;
        GridForming = 0;
        if(GCB_status == 0){
            enable = 0;
        }
        else{
            enable = 1;
        }
    }
    else{
        StandBy = 0;
        GridFollowing = 0;
        GridForming = 1;
        enable = 0;
    }
}
/*End code section*/"
                    output_terminals = "real StandBy;inherit GridFollowing;inherit GridForming;inherit enable;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[u\'\']"
                    output_terminals_show_labels = "False;False;False;False;"
                }
                [
                    position = 7288, 7800
                    rotation = right
                    size = 128, 96
                ]

                port wmeas {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7840, 8320
                ]

                port T_in {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7272, 8280
                ]

                port Meas_feedback {
                    position = left:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7208, 8024
                ]

                port From_synch_check {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7856
                ]

                port To_synch_check {
                    position = left:12
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8456, 8112
                    rotation = left
                ]

                port T_out {
                    position = right:14
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8176, 8240
                ]

                port Inputs {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7960
                ]

                port Vf_out {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8272, 7816
                ]

                tag Goto38 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8088, 8440
                    hide_name = True
                    size = 60, 20
                ]

                tag From3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag From12 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From54 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8168
                    hide_name = True
                    size = 60, 20
                ]

                tag From59 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8104
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8256
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto39 {
                    value = "Exciter_on"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7864, 7728
                    hide_name = True
                    size = 60, 20
                ]

                tag From15 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8112
                    hide_name = True
                    size = 60, 20
                ]

                tag From62 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8272
                    hide_name = True
                    size = 60, 20
                ]

                tag From66 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto44 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7952, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag From70 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7928
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7504, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From13 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto45 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7872, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From67 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7192, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From68 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto16 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag From63 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8304
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7800
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto40 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8152
                    hide_name = True
                    size = 60, 20
                ]

                tag From2 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto15 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From61 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto43 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8416
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From65 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7688
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8176
                    hide_name = True
                    size = 58, 20
                ]

                tag Goto11 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8120
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From51 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 8008
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8160
                    hide_name = True
                    size = 60, 20
                ]

                tag From71 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8400
                    hide_name = True
                    size = 60, 20
                ]

                tag From60 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 7664
                    hide_name = True
                    size = 60, 20
                ]

                tag From1 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From64 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto42 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag From69 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7960
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto35 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From16 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8208
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto46 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8224
                    hide_name = True
                    size = 58, 20
                ]

                tag From4 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8176
                    hide_name = True
                    size = 60, 20
                ]

                tag From72 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From58 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto37 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8200
                    hide_name = True
                    size = 58, 20
                ]

                junction Junction13 sp
                [
                    position = 7800, 7704
                ]

                junction Junction14 sp
                [
                    position = 7888, 8392
                ]

                junction Junction15 sp
                [
                    position = 7800, 7704
                ]

                junction Junction18 sp
                [
                    position = 8224, 7816
                ]

                junction Junction22 sp
                [
                    position = 7056, 8120
                ]

                junction Junction23 sp
                [
                    position = 7888, 8320
                ]

                junction Junction24 sp
                [
                    position = 8128, 8240
                ]

                junction Junction25 sp
                [
                    position = 7368, 7888
                ]

                junction Junction26 sp
                [
                    position = 7456, 7928
                ]

                junction Junction27 sp
                [
                    position = 7368, 7952
                ]

                connect "Bus Join1.out" To_synch_check as Connection608
                connect "Bus Split2.in" From_synch_check as Connection205
                connect "Bus Split2.out1" Goto4 as Connection543
                connect "Bus Split3.out2" Goto13 as Connection677
                connect "Bus Split3.out4" Goto15 as Connection679
                connect "Bus Split3.out7" Goto40 as Connection687
                connect "Bus Split3.in" Inputs as Connection672
                connect "Bus Split3.out" Junction22 as Connection675
                connect Exciter_on.in Junction15 as Connection604
                connect Freq_setpoint_control.P_ref From14 as Connection648
                connect Freq_setpoint_control.Pmeas_in From2 as Connection651
                connect Freq_setpoint_control.enable From4 as Connection649
                connect Freq_setpoint_control.w_bias Governor_and_Engine.w_bias as Connection706
                connect From10 "Governor_and_Engine.Gen On" as Connection700
                connect From13 Exciter.Vref as Connection226
                connect From15 Freq_setpoint_control.w_ref as Connection647
                connect From16 "Bus Join1.in" as Connection576
                connect From27 "pf Control.pf_meas" as Connection693
                connect From3 Exciter.Vt_in as Connection179
                connect From45 Round1.in as Connection570
                connect From46 "Unit Delay1.in" as Connection581
                connect From49 "Bus Join1.in1" as Connection609
                connect From5 Read_Control_mode.Enable_outer_loop as Connection187
                connect From50 "Bus Join1.in3" as Connection611
                connect From51 "Bus Join1.in2" as Connection610
                connect From52 Exciter.dV as Connection585
                connect From54 "Bus Join1.in4" as Connection612
                connect From56 Freq_setpoint_control.w_meas as Connection650
                connect From58 Governor_and_Engine.P_meas as Connection697
                connect From59 "Unit Delay2.in" as Connection622
                connect From6 Read_Control_mode.P_control_mode as Connection188
                connect From60 "Unit Delay3.in" as Connection632
                connect From61 Exciter.Q_meas as Connection634
                connect From62 Freq_setpoint_control.P_mode as Connection653
                connect From63 Freq_setpoint_control.Load_Share_on as Connection654
                connect From64 Freq_setpoint_control.Load_Share as Connection655
                connect From65 Read_Control_mode.Q_control_mode as Connection685
                connect From66 "pf Control.P_control_mode" as Connection686
                connect From67 Define_control_mode.Gen_Control_Mode as Connection691
                connect From68 Governor_and_Engine.w_ref as Connection701
                connect From69 "pf Control.P_meas" as Connection709
                connect From7 Start_Exciter.Gen_On as Connection589
                connect From70 "pf Control.pf_ref" as Connection708
                connect From71 Output.Gen_On as Connection713
                connect From72 Output.w_meas as Connection714
                connect From8 Start_Exciter.w_meas as Connection590
                connect From9 Governor_and_Engine.dw_synch as Connection698
                connect Gen_On.in Junction22 as Connection673
                connect Goto1 "Bus Split1.out" as Connection174
                connect Goto10 "Bus Split2.out" as Connection531
                connect Goto12 "Bus Split3.out1" as Connection676
                connect Goto14 "Bus Split3.out3" as Connection678
                connect Goto16 "Bus Split3.out6" as Connection681
                connect Goto2 "Bus Split1.out1" as Connection175
                connect Goto3 "Bus Split1.out2" as Connection176
                connect Goto32 "Bus Split3.out5" as Connection680
                connect Goto37 "Bus Split2.out2" as Connection584
                connect Goto38 check_steady_state_w.ss_speed as Connection602
                connect Goto39 Junction15 as Connection606
                connect Goto42 "Bus Split3.out8" as Connection688
                connect Goto43 Define_control_mode.P_Control as Connection690
                connect Goto44 Define_control_mode.Q_Control as Connection689
                connect Goto45 "pf Control.Q_active" as Connection707
                connect Goto46 "Bus Split1.out3" as Connection711
                connect Goto9 Junction14 as Connection599
                connect Governor_and_Engine.w_meas_in Junction23 as Connection696
                connect Governor_and_Engine.T_out Junction24 as Connection705
                connect Junction13 Exciter.Start as Connection596
                connect Junction15 Junction13 as Connection605
                connect Junction18 Exciter.Vf_out as Connection645
                connect Junction22 Goto11 as Connection674
                connect Junction23 Junction14 as Connection695
                connect Junction24 T.in as Connection704
                connect Meas_feedback "Bus Split1.in" as Connection712
                connect Start_Exciter.Start Junction13 as Connection595
                connect T_in Termination1.in as Connection166
                connect T_out Junction24 as Connection703
                connect "Unit Delay2.out" Governor_and_Engine.GCB_status as Connection702
                connect "Unit Delay3.out" Exciter.GCB_status as Connection633
                connect Vf.in Junction18 as Connection644
                connect Vf_out Junction18 as Connection646
                connect check_steady_state_w.w_meas Junction14 as Connection601
                connect "pf Control.dV_out" Exciter.Delta_V_in as Connection710
                connect "pf Control.Q_meas_in" From1 as Connection552
                connect "pf Control.Q_control_mode" From11 as Connection549
                connect "pf Control.Pref" From12 as Connection551
                connect "pf Control.enable" From47 as Connection550
                connect wmeas Junction23 as Connection694
                connect Goto35 Junction25 as Connection718
                connect Junction25 StandBy.in as Connection719
                connect read_OP_mode.StandBy Junction25 as Connection720
                connect Goto36 Junction26 as Connection721
                connect Junction26 GridFollowing.in as Connection722
                connect read_OP_mode.GridFollowing Junction26 as Connection723
                connect GridForming.in Junction27 as Connection724
                connect Junction27 Goto34 as Connection725
                connect read_OP_mode.GridForming Junction27 as Connection726
                connect read_OP_mode.enable Goto33 as Connection727
                connect read_OP_mode.GCB_status "Unit Delay1.out" as Connection728
                connect Round1.out read_OP_mode.OP_mode as Connection729
            }
            [
                position = 9088, 8056
                scale = -1, 1
                size = 208, 200
            ]

            component Subsystem Sync_Check {
                layout = dynamic
                component "core/Logical operator" not {
                    operator = "NOT"
                }
                [
                    position = 9032, 8632
                    hide_name = True
                ]

                component "core/Probe" dw_f {
                }
                [
                    position = 8744, 8096
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join2" {
                    inputs = "3"
                }
                [
                    position = 8704, 8664
                    hide_name = True
                ]

                component "core/Digital Probe" V_match {
                }
                [
                    position = 8728, 7968
                    rotation = left
                ]

                component "core/Digital Probe" Speed_ss {
                }
                [
                    position = 9160, 8280
                    rotation = left
                ]

                component "core/Digital Probe" Phase_match {
                }
                [
                    position = 8720, 8400
                    rotation = right
                ]

                component "core/Digital Probe" dw_synch_ON {
                }
                [
                    position = 9248, 8536
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "5"
                }
                [
                    position = 8632, 8560
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dV {
                }
                [
                    position = 8608, 7928
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join" {
                    inputs = "3"
                }
                [
                    position = 9192, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dw_phase {
                }
                [
                    position = 8744, 8256
                    rotation = left
                ]

                component "core/Digital Probe" f_match {
                }
                [
                    position = 8624, 8176
                    rotation = left
                ]

                component "core/Digital Probe" Check_phase_ON {
                }
                [
                    position = 8592, 8440
                ]

                component "core/Logical operator" and1 {
                }
                [
                    position = 8464, 8440
                    hide_name = True
                ]

                component "core/Probe" dw_synch {
                }
                [
                    position = 9056, 8168
                    rotation = left
                ]

                component "core/Logical operator" and2 {
                    inputs = "5"
                }
                [
                    position = 9120, 8576
                    rotation = left
                    hide_name = True
                ]

                component Subsystem check_V_diff {
                    layout = dynamic
                    component "core/Abs" Abs4 {
                    }
                    [
                        position = 7816, 8176
                        hide_name = True
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8144
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8264, 8216
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8432, 8160
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8048, 8248
                        hide_name = True
                    ]

                    component "core/Gain" Volt_diff {
                        gain = "delta_V/100.0"
                    }
                    [
                        position = 8264, 8256
                    ]

                    component "core/Gain" Vgrid_lowLim {
                        gain = "0.9"
                    }
                    [
                        position = 7864, 8280
                    ]

                    component "core/Probe" V_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    component "core/Gain" Vgrid_upLim {
                        gain = "1.1"
                    }
                    [
                        position = 7864, 8224
                    ]

                    component "core/Constant" one1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7776, 8224
                    ]

                    component "core/Constant" one {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8200, 8256
                    ]

                    component "core/Gain" pu {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 8128, 8144
                    ]

                    component "core/Gain" pu1 {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 7880, 8176
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8360, 8176
                        hide_name = True
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8144, 8064
                        hide_name = True
                    ]

                    component "core/Relational operator" less_equal {
                        relational_op = "<="
                    }
                    [
                        position = 7960, 8216
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8336, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7960, 8272
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "-1"
                            limit_upper = "1"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "V_lowLim"
                            upper_limit = "V_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Kp {
                            gain = "V_Kp"
                        }
                        [
                            position = 8024, 8168
                        ]

                        component "core/Gain" Ki {
                            gain = "V_Ki"
                        }
                        [
                            position = 7976, 8216
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7888, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7944, 8168
                        ]

                        connect In Junction4 as Connection58
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection59
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection60
                        connect Ki.out Sum7.in as Connection56
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8272, 8144
                        size = 64, 48
                    ]

                    port Vgrid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8136
                    ]

                    port Vgen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8152
                    ]

                    port dV {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8160
                    ]

                    port Activate {
                        position = top:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8064
                    ]

                    port V_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8400, 8224
                    ]

                    port Grid_On {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8128, 8248
                    ]

                    junction Junction2 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction3 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction4 sp
                    [
                        position = 8272, 8064
                    ]

                    junction Junction5 sp
                    [
                        position = 7776, 8136
                    ]

                    junction Junction6 sp
                    [
                        position = 7912, 8208
                    ]

                    junction Junction7 sp
                    [
                        position = 7816, 8224
                    ]

                    connect Abs3.in Junction2 as Connection202
                    connect Abs4.in Junction5 as Connection227
                    connect Abs4.out pu1.in as Connection235
                    connect Activate "Unit Delay1.in" as Connection208
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Grid_On and.out as Connection241
                    connect Junction2 pu.out as Connection201
                    connect Junction3 Junction2 as Connection216
                    connect Junction4 "Unit Delay1.out" as Connection219
                    connect Junction5 Vgrid as Connection226
                    connect Junction6 less_equal.in as Connection232
                    connect Junction7 Vgrid_upLim.in as Connection239
                    connect PI.In Junction3 as Connection217
                    connect PI.Reset Junction4 as Connection220
                    connect PI.Out "Signal switch1.in" as Connection214
                    connect "Signal switch1.in2" Junction4 as Connection218
                    connect Sum1.in Junction5 as Connection225
                    connect Sum1.in1 Vgen as Connection60
                    connect V_diff.in Junction3 as Connection215
                    connect V_match Comparator1.out as Connection187
                    connect Vgrid_lowLim.in Junction7 as Connection240
                    connect Vgrid_lowLim.out greater_equal.in1 as Connection237
                    connect Vgrid_upLim.out less_equal.in1 as Connection234
                    connect Volt_diff.out Comparator1.in1 as Connection17
                    connect dV "Signal switch1.out" as Connection181
                    connect greater_equal.in Junction6 as Connection233
                    connect greater_equal.out and.in1 as Connection229
                    connect less_equal.out and.in as Connection228
                    connect one.out Volt_diff.in as Connection14
                    connect one1.out Junction7 as Connection238
                    connect pu.in Sum1.out as Connection198
                    connect pu1.out Junction6 as Connection236
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8520, 8016
                    size = 144, 120
                ]

                component Subsystem PLLs {
                    layout = dynamic
                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8464, 8216
                        hide_name = True
                    ]

                    component "core/Probe" V_grid {
                    }
                    [
                        position = 8296, 8096
                    ]

                    component "core/Probe" wt_grid {
                    }
                    [
                        position = 8464, 8144
                    ]

                    component "core/Bus Split" split1 {
                        outputs = "3"
                    }
                    [
                        position = 8072, 8360
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Probe" wt_gen {
                    }
                    [
                        position = 8464, 8280
                    ]

                    component "core/Bus Split" split {
                        outputs = "3"
                    }
                    [
                        position = 8096, 7936
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" V_gen {
                    }
                    [
                        position = 8216, 8352
                    ]

                    component "core/Gain" Gain1 {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    component Subsystem PLL_Grid {
                        layout = dynamic
                        component "core/Termination" Term1 {
                        }
                        [
                            position = 8128, 8152
                            rotation = left
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_Vt {
                            a_coeff = "[1.0/(2*np.pi*fc_vt),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8224
                        ]

                        component "core/Discrete Transfer Function" LPF_f {
                            a_coeff = "[1.0/(2*np.pi*fc_f),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8216, 8248
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 8104, 8112
                            rotation = left
                            hide_name = True
                        ]

                        component Subsystem PLL {
                            layout = dynamic
                            component "core/Gain" rads_to_Hz {
                                gain = "1/(2*np.pi)"
                            }
                            [
                                position = 8360, 8056
                            ]

                            component "core/Termination" Term {
                            }
                            [
                                position = 8008, 8216
                                rotation = right
                            ]

                            component "core/Unit Delay" "Unit Delay1" {
                            }
                            [
                                position = 8480, 8272
                                rotation = right
                            ]

                            component "core/C function" integrator {
                                global_variables = "real out;"
                                init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                                input_terminals_dimensions = "inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                output_fnc = "/*Begin code section*/
output = out+0.0;
/*End code section*/"
                                output_terminals = "inherit output;"
                                output_terminals_dimensions = "inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                parameters = "real Ts;"
                                update_fnc = "/*Begin code section*/
out += Ts*in;

if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            }
                            [
                                position = 8424, 8136
                                size = 0, 0
                            ]

                            component Subsystem Normalize {
                                layout = dynamic
                                component "core/C function" V_terminal {
                                    init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                    input_terminals = "real d;inherit q;"
                                    input_terminals_dimensions = "inherit;inherit"
                                    input_terminals_feedthrough = "[u\'\']"
                                    input_terminals_show_labels = "False;False;"
                                    output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                    output_terminals = "real t;inherit q_pu;"
                                    output_terminals_dimensions = "inherit;inherit"
                                    output_terminals_feedthrough = "[u\'\']"
                                    output_terminals_show_labels = "False;False;"
                                }
                                [
                                    position = 8192, 8192
                                    size = 0, 0
                                ]

                                port d {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8152
                                ]

                                port q {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8216
                                ]

                                port q_pu {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8352, 8200
                                ]

                                port Vt {
                                    position = top:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8280, 8104
                                    rotation = left
                                ]

                                connect V_terminal.t Vt as Connection8
                                connect V_terminal.d d as Connection1
                                connect V_terminal.q q as Connection3
                                connect q_pu V_terminal.q_pu as Connection9
                            }
                            [
                                position = 8128, 8136
                                size = 64, 64
                            ]

                            component Subsystem PI {
                                layout = dynamic
                                component "core/Sum" Sum6 {
                                    signs = "-+"
                                }
                                [
                                    position = 8304, 8304
                                    hide_name = True
                                    scale = -1, 1
                                ]

                                component "core/Gain" Ki {
                                    gain = "Ki"
                                }
                                [
                                    position = 7960, 8208
                                ]

                                component "core/Limit" Limit1 {
                                    lower_limit = "0.7*2*np.pi*f"
                                    upper_limit = "1.4*2*np.pi*f"
                                }
                                [
                                    position = 8416, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum8 {
                                }
                                [
                                    position = 8272, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum7 {
                                }
                                [
                                    position = 8072, 8216
                                    hide_name = True
                                ]

                                component "core/Gain" Kp {
                                    gain = "Kp"
                                }
                                [
                                    position = 8088, 8144
                                ]

                                component "core/Gain" Kb {
                                    gain = "1000"
                                }
                                [
                                    position = 8200, 8304
                                    scale = -1, 1
                                ]

                                component "core/Integrator" Integrator1 {
                                    init_value = "[2*np.pi*f]"
                                }
                                [
                                    position = 8176, 8216
                                    hide_name = True
                                ]

                                port In {
                                    position = right:auto
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7840, 8144
                                    rotation = down
                                    scale = -1, 1
                                ]

                                port Out {
                                    position = left:auto
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8544, 8176
                                    rotation = down
                                    scale = -1, 1
                                ]

                                junction Junction161 sp
                                [
                                    position = 7904, 8144
                                ]

                                junction Junction162 sp
                                [
                                    position = 8368, 8176
                                ]

                                junction Junction163 sp
                                [
                                    position = 8456, 8176
                                ]

                                connect Integrator1.out Sum8.in1 as Connection352
                                connect Junction161 In as Connection360
                                connect Junction161 Ki.in as Connection359
                                connect Junction161 Kp.in as Connection358
                                connect Junction162 Limit1.in as Connection369
                                connect Junction163 Out as Connection372
                                connect Kb.in Sum6.out as Connection50
                                connect Kp.out Sum8.in as Connection350
                                connect Limit1.out Junction163 as Connection371
                                connect Sum6.in Junction162 as Connection370
                                connect Sum6.in1 Junction163 as Connection373
                                connect Sum7.out Integrator1.in as Connection365
                                connect Sum7.in1 Kb.out as Connection53
                                connect Sum7.in Ki.out as Connection364
                                connect Sum8.out Junction162 as Connection368
                            }
                            [
                                position = 8256, 8136
                                scale = -1, -1
                                size = 48, 48
                            ]

                            component Subsystem ABC_dqz {
                                layout = dynamic
                                component "core/alpha beta to dq" "alpha beta to dq" {
                                }
                                [
                                    position = 8248, 8192
                                ]

                                component "core/abc to alpha beta" "abc to alpha beta" {
                                }
                                [
                                    position = 8024, 8192
                                ]

                                port A {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7952, 8104
                                    rotation = right
                                ]

                                port B {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7904, 8104
                                    rotation = right
                                ]

                                port C {
                                    position = left:3
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7856, 8104
                                    rotation = right
                                ]

                                port wt {
                                    position = left:4
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8176, 8288
                                    rotation = left
                                ]

                                port d {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8320, 8136
                                    rotation = left
                                ]

                                port q {
                                    position = right:2
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8368, 8136
                                    rotation = left
                                ]

                                port z {
                                    position = right:3
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8096, 8288
                                    rotation = right
                                ]

                                connect "abc to alpha beta.A" A as Connection2685
                                connect "abc to alpha beta.B" B as Connection2686
                                connect "abc to alpha beta.C" C as Connection2687
                                connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                                connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                                connect "alpha beta to dq.wt" wt as Connection2690
                                connect d "alpha beta to dq.d" as Connection2692
                                connect q "alpha beta to dq.q" as Connection2693
                                connect z "abc to alpha beta.gamma" as Connection2691
                            }
                            [
                                position = 7912, 8152
                                size = 48, 104
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7736, 8152
                                rotation = left
                            ]

                            port B {
                                label = "B"
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7776, 8176
                                rotation = left
                            ]

                            port C {
                                label = "C"
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7816, 8200
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8008
                            ]

                            port q {
                                label = "q"
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8056
                            ]

                            port Vt {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8192, 8064
                            ]

                            port wt {
                                position = right:5
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8528, 8136
                            ]

                            port f {
                                position = right:4
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8424, 8056
                            ]

                            junction Junction4 sp
                            [
                                position = 8480, 8136
                            ]

                            junction Junction5 sp
                            [
                                position = 8320, 8136
                            ]

                            junction Junction6 sp
                            [
                                position = 8008, 8120
                            ]

                            junction Junction7 sp
                            [
                                position = 8024, 8152
                            ]

                            connect ABC_dqz.A A as Connection233
                            connect ABC_dqz.C C as Connection231
                            connect ABC_dqz.d Junction6 as Connection225
                            connect ABC_dqz.q Junction7 as Connection228
                            connect ABC_dqz.z Term.in as Connection229
                            connect B ABC_dqz.B as Connection232
                            connect Junction4 "Unit Delay1.in" as Connection213
                            connect Junction5 integrator.in as Connection218
                            connect Junction6 d as Connection224
                            [
                                position = 0, 0
                            ]
                            connect Junction7 Normalize.q as Connection227
                            [
                                position = 0, 0
                            ]
                            connect Normalize.d Junction6 as Connection223
                            connect PI.Out Junction5 as Connection219
                            connect PI.In Normalize.q_pu as Connection220
                            connect "Unit Delay1.out" ABC_dqz.wt as Connection230
                            connect Vt Normalize.Vt as Connection184
                            connect f rads_to_Hz.out as Connection199
                            connect integrator.output Junction4 as Connection214
                            connect q Junction7 as Connection226
                            connect rads_to_Hz.in Junction5 as Connection217
                            connect wt Junction4 as Connection212

                            f = "f"

                            mask {
                                description = "Simple PLL with wrapped wt"

                                Kp {
                                    label = "Proportional gain"
                                    widget = edit
                                    type = generic
                                    default_value = "100"
                                }

                                Ki {
                                    label = "Integral gain"
                                    widget = edit
                                    type = generic
                                    default_value = "3200"
                                }

                                f {
                                    label = "Target frequency"
                                    widget = edit
                                    type = generic
                                    default_value = "60"
                                    unit = "Hz"
                                }

                                Ts {
                                    label = "Execution rate"
                                    widget = edit
                                    type = generic
                                    default_value = "Ts"
                                }

                                CODE open
                                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                                
                                    dialog = RegularComponentPropertiesDialog(
                                        component=component,
                                        property_container=component.masks[-1],
                                        current_diagram=current_diagram
                                    )
                                    dialog.exec_()
                                
                                ENDCODE
                            }
                        }
                        [
                            position = 8048, 8224
                            rotation = down
                            scale = -1, -1
                            size = 64, 136
                        ]

                        port f {
                            label = "f"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8280, 8248
                        ]

                        port wt {
                            label = "wt"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8152, 8272
                        ]

                        port Va {
                            label = "Va"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8176
                        ]

                        port Vb {
                            label = "Vb"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8224
                        ]

                        port Vc {
                            label = "Vc"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8272
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8392, 8224
                        ]

                        connect LPF_Vt.in PLL.Vt as Connection12
                        connect LPF_f.in PLL.f as Connection10
                        connect PLL.A Va as Connection1
                        connect PLL.C Vc as Connection3
                        connect Term.in PLL.d as Connection7
                        connect Term1.in PLL.q as Connection8
                        connect Vb PLL.B as Connection2
                        connect Vt LPF_Vt.out as Connection11
                        connect f LPF_f.out as Connection9
                        connect wt PLL.wt as Connection6

                        fc_f = "10.0"
                        fc_vt = "10.0"

                        mask {
                            fc_vt {
                                label = "Vt channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            fc_f {
                                label = "f channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8184, 8024
                        size = 72, 120
                    ]

                    port f_Gen {
                        label = "f_Gen"
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8208
                    ]

                    port f_Grid {
                        label = "f_Grid"
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 7984
                    ]

                    port Vgrid {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8064
                    ]

                    port Vgen {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8288
                    ]

                    port V_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7888
                    ]

                    port V_Gen {
                        label = "V_Gen"
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8416
                    ]

                    port "Phase diff" {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8544, 8216
                    ]

                    tag From2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8352, 8208
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8288, 8024
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction15 sp
                    [
                        position = 8400, 8208
                    ]

                    junction Junction23 sp
                    [
                        position = 8264, 8064
                    ]

                    junction Junction27 sp
                    [
                        position = 8400, 8248
                    ]

                    junction Junction28 sp
                    [
                        position = 8160, 8288
                    ]

                    connect From2 Junction15 as Connection270
                    connect Gain1.out f_Gen as Connection342
                    connect Gain1.in split1.out as Connection349
                    connect Junction15 Sum1.in as Connection271
                    connect Junction23 V_grid.in as Connection329
                    connect Junction27 Sum1.in1 as Connection352
                    connect Junction28 V_gen.in as Connection356
                    connect PLL_Grid.wt Goto2 as Connection294
                    connect PLL_Grid.Vt Junction23 as Connection328
                    connect PLL_Grid.Vb split.out1 as Connection324
                    connect "Phase diff" Sum1.out as Connection336
                    connect V_Grid split.in as Connection134
                    connect Vgen Junction28 as Connection355
                    connect Vgrid Junction23 as Connection330
                    connect f_Grid PLL_Grid.f as Connection327
                    connect split.out2 PLL_Grid.Vc as Connection322
                    connect split.out PLL_Grid.Va as Connection325
                    connect split1.out1 Junction27 as Connection353
                    connect split1.out2 Junction28 as Connection357
                    connect split1.in V_Gen as Connection348
                    connect wt_gen.in Junction27 as Connection351
                    connect wt_grid.in Junction15 as Connection272
                }
                [
                    position = 8288, 8136
                    size = 104, 360
                ]

                component Subsystem Calculate_dw_synch {
                    layout = dynamic
                    component "core/Discrete Transfer Function" LPF_dw {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8200, 8104
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8456, 8120
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8384, 8136
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8400, 8040
                        hide_name = True
                    ]

                    component "core/Gain" dw_K {
                        gain = "dw_K"
                    }
                    [
                        position = 8272, 8104
                    ]

                    component "core/Sum" Sum4 {
                    }
                    [
                        position = 8112, 8104
                        hide_name = True
                    ]

                    port dw_f {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8048
                    ]

                    port dw_phase {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8112
                    ]

                    port dw_synch {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8528, 8120
                    ]

                    port Activate {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8328, 8040
                    ]

                    connect Sum4.out LPF_dw.in as Connection240
                    connect Sum4.in1 dw_phase as Connection231
                    connect "Unit Delay1.in" Activate as Connection180
                    connect "Unit Delay1.out" "Signal switch1.in2" as Connection181
                    connect dw_K.in LPF_dw.out as Connection241
                    connect dw_K.out "Signal switch1.in" as Connection242
                    connect dw_f Sum4.in as Connection239
                    connect dw_synch "Signal switch1.out" as Connection177
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8952, 8216
                    size = 128, 208
                ]

                component Subsystem check_f_diff {
                    layout = dynamic
                    component "core/Gain" Freq_diff {
                        gain = "delta_f/100.0"
                    }
                    [
                        position = 8208, 8256
                    ]

                    component "core/Gain" toPU {
                        gain = "[1.0/(2.0*f)]"
                    }
                    [
                        position = 8216, 8152
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8152
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8208, 8216
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "f"
                    }
                    [
                        position = 8120, 8256
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8280, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Discrete Transfer Function" LPF_dwf {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8128, 8152
                    ]

                    component "core/Probe" f_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    port dw_f {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8152
                    ]

                    port f_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8144
                    ]

                    port f_Gen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8160
                    ]

                    port f_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8224
                    ]

                    junction Junction1 sp
                    [
                        position = 8168, 8152
                    ]

                    connect Abs3.in Junction1 as Connection7
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Comparator1.out f_match as Connection59
                    connect Constant1.out Freq_diff.in as Connection14
                    connect Freq_diff.out Comparator1.in1 as Connection17
                    connect Junction1 LPF_dwf.out as Connection61
                    connect LPF_dwf.in Sum1.out as Connection62
                    connect Sum1.in1 f_Gen as Connection60
                    connect Sum1.in f_Grid as Connection57
                    connect f_diff.in Junction1 as Connection56
                    connect toPU.in Junction1 as Connection40
                    connect toPU.out dw_f as Connection63
                }
                [
                    position = 8520, 8176
                    size = 144, 120
                ]

                component Subsystem check_phase_diff {
                    layout = dynamic
                    component "core/Abs" Abs2 {
                    }
                    [
                        position = 8064, 8096
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" phase_filter {
                    }
                    [
                        position = 8112, 8040
                    ]

                    component "core/Probe" phase_diff {
                    }
                    [
                        position = 7992, 7928
                        rotation = left
                    ]

                    component "core/Discrete Transfer Function" LPF {
                        a_coeff = "[1.0/(2*np.pi*0.5),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8032, 7976
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8024, 8160
                    ]

                    component "core/Gain" Phase_diff {
                        gain = "delta_phi*np.pi/180.0"
                    }
                    [
                        position = 8088, 8160
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8384, 7968
                        hide_name = True
                    ]

                    component "core/C function" confine_phase {
                        init_fnc = "/*Begin code section*/
dtheta = 0;
dtheta_confined = 0;
/*End code section*/"
                        input_terminals = "real dtheta;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        output_fnc = "/*Begin code section*/
if (dtheta > 3.14159265359) {//confine theta to +/- 2*pi;
    dtheta_confined = dtheta - 6.28318530718;
}
else{
    if (dtheta < -3.14159265359){
        dtheta_confined = dtheta + 6.28318530718;
    }
    else{
        dtheta_confined = dtheta;
    }
}
/*End code section*/"
                        output_terminals = "real dtheta_confined;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7776, 7976
                        size = 0, 0
                    ]

                    component "core/Comparator" Comparator2 {
                    }
                    [
                        position = 8160, 8152
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" to_pu {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 7976
                    ]

                    component "core/C function" offset_phase {
                        global_variables = "real off1;real off2;"
                        init_fnc = "/*Begin code section*/
phase_out = 0;
off1 = execution_rate*6.2831853071*f;
off2 = phaseOff*3.141592653589793/180.0;
/*End code section*/"
                        input_terminals = "inherit phase;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "[(\'phase\', True)]"
                        output_fnc = "/*Begin code section*/
phase_out = phase - off1 + off2;
/*End code section*/"
                        output_terminals = "real phase_out;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                        output_terminals_show_labels = "[(\'phase_out\', True)]"
                        parameters = "real f;real phaseOff;"
                    }
                    [
                        position = 7888, 7976
                        size = 0, 0
                    ]

                    component Subsystem Counter {
                        layout = dynamic
                        component "core/Logical operator" not {
                            operator = "NOT"
                        }
                        [
                            position = 8104, 8248
                        ]

                        component "core/C function" c_function {
                            input_terminals = "real counter;"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
if(counter>=0.1/execution_rate){
    out = 1;
}
else{
    out = 0;
}
/*End code section*/"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8288, 8200
                            size = 0, 0
                        ]

                        component "core/Counter" Counter1 {
                        }
                        [
                            position = 8192, 8200
                            size = 48, 48
                        ]

                        port In {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8008, 8192
                        ]

                        port Out {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8368, 8200
                        ]

                        junction Junction14 sp
                        [
                            position = 8056, 8192
                        ]

                        connect Counter1.en Junction14 as Connection559
                        connect Junction14 In as Connection562
                        connect Junction14 not.in as Connection560
                        connect c_function.counter Counter1.out as Connection563
                        connect c_function.out Out as Connection564
                        connect not.out Counter1.reset as Connection88
                    }
                    [
                        position = 8256, 8152
                        size = 48, 48
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Limit" Limit1 {
                            lower_limit = "phase_lowLim"
                            upper_limit = "phase_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Ki {
                            gain = "phase_Ki"
                        }
                        [
                            position = 7984, 8216
                        ]

                        component "core/Gain" Kp {
                            gain = "phase_Kp"
                        }
                        [
                            position = 8032, 8168
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "phase_lowLim"
                            limit_upper = "phase_upLim"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7912, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7952, 8168
                        ]

                        connect In Junction4 as Connection57
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8240, 7976
                        size = 64, 48
                    ]

                    port phase_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8152
                    ]

                    port Activate {
                        position = bottom:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 7864
                        rotation = left
                        scale = 1, -1
                    ]

                    port dw_phase {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8464, 7968
                    ]

                    port phase_Diff {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7688, 7976
                    ]

                    junction Junction15 sp
                    [
                        position = 8064, 7976
                    ]

                    junction Junction17 sp
                    [
                        position = 8064, 8040
                    ]

                    junction Junction21 sp
                    [
                        position = 8240, 7912
                    ]

                    junction Junction22 sp
                    [
                        position = 7992, 7976
                    ]

                    connect Abs2.in Junction17 as Connection590
                    connect Activate Junction21 as Connection622
                    connect Comparator2.in2 Abs2.out as Connection712
                    connect Comparator2.out Counter.In as Connection674
                    connect Junction15 LPF.out as Connection582
                    connect Junction17 Junction15 as Connection591
                    connect Junction21 PI.Reset as Connection693
                    connect Junction21 Product1.in as Connection623
                    connect Junction22 LPF.in as Connection732
                    connect One.out Phase_diff.in as Connection15
                    connect Phase_diff.out Comparator2.in1 as Connection49
                    connect Product1.in1 PI.Out as Connection692
                    connect confine_phase.dtheta phase_Diff as Connection721
                    connect dw_phase Product1.out as Connection714
                    connect offset_phase.phase_out Junction22 as Connection733
                    connect offset_phase.phase confine_phase.dtheta_confined as Connection734
                    connect phase_diff.in Junction22 as Connection731
                    connect phase_filter.in Junction17 as Connection592
                    connect phase_match Counter.Out as Connection673
                    connect to_pu.in Junction15 as Connection581
                    connect to_pu.out PI.In as Connection713
                }
                [
                    position = 8528, 8328
                    size = 168, 112
                ]

                component Subsystem Contactor_Control {
                    layout = dynamic
                    component "core/Digital Probe" GCB_cmd {
                    }
                    [
                        position = 8256, 8224
                        rotation = left
                    ]

                    component "core/C function" wait_to_trip {
                        global_variables = "real time_acc;"
                        init_fnc = "/*Begin code section*/
time_acc = 0;
Trip = 0;
/*End code section*/"
                        input_terminals = "inherit boolean;inherit Reset;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(time_acc>=3.0){
    Trip = 1;
}
else{
    time_acc += execution_rate*boolean;
}
if(Reset ==1){
    time_acc = 0;
    Trip = 0;
}
/*End code section*/"
                        output_terminals = "real Trip;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7616, 8296
                        size = 48, 48
                    ]

                    component "core/Digital Probe" GCB_control {
                    }
                    [
                        position = 7848, 8248
                        rotation = left
                    ]

                    component "core/Constant" Close {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7992, 8248
                    ]

                    component "core/Logical operator" not {
                        operator = "NOT"
                    }
                    [
                        position = 7968, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8072, 8280
                        hide_name = True
                    ]

                    component "core/Logical operator" or {
                        operator = "OR"
                    }
                    [
                        position = 8072, 8400
                        hide_name = True
                    ]

                    component "core/SR Flip Flop" "SR Flip Flop1" {
                    }
                    [
                        position = 8168, 8296
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                        inputs = "5"
                    }
                    [
                        position = 7792, 8296
                    ]

                    component "core/Termination" Termination12 {
                    }
                    [
                        position = 8248, 8312
                        hide_name = True
                    ]

                    component "core/Bus Split" "Bus Split1" {
                        outputs = "3"
                    }
                    [
                        position = 7488, 8032
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Edge Detection" "Edge Detection1" {
                    }
                    [
                        position = 7536, 8320
                        hide_name = True
                        size = 32, 32
                    ]

                    port ss_speed {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8200
                        rotation = right
                    ]

                    port phase_match {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8232
                        rotation = right
                    ]

                    port Gen_on {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8368
                    ]

                    port f_match {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8432
                        rotation = left
                    ]

                    port GCB {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8304, 8280
                    ]

                    port GCB_Control {
                        position = top:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7488, 7960
                        rotation = right
                    ]

                    port V_match {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8408
                        rotation = left
                    ]

                    tag Goto31 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto30 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8096
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From36 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7432, 8288
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto29 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8072
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From35 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7888, 8432
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From34 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8000, 8184
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction32 sp
                    [
                        position = 8256, 8280
                    ]

                    junction Junction34 sp
                    [
                        position = 7848, 8296
                    ]

                    junction Junction35 sp
                    [
                        position = 7488, 8288
                    ]

                    connect "Bus Split1.in" GCB_Control as Connection541
                    connect "Bus Split1.out" Goto29 as Connection542
                    connect Close.out "Signal switch1.in" as Connection129
                    connect "Edge Detection1.In1" Junction35 as Connection559
                    connect From34 "Signal switch1.in2" as Connection534
                    connect From35 or.in1 as Connection535
                    connect GCB_cmd.in Junction32 as Connection528
                    connect Gen_on not.in as Connection517
                    connect Goto30 "Bus Split1.out1" as Connection543
                    connect Goto31 "Bus Split1.out2" as Connection544
                    connect Junction32 GCB as Connection529
                    connect Junction34 GCB_control.in as Connection551
                    connect Junction35 From36 as Connection560
                    connect "SR Flip Flop1.out" Junction32 as Connection530
                    connect "Signal switch1.in1" Junction34 as Connection550
                    connect "Signal switch1.out" "SR Flip Flop1.s_in" as Connection527
                    connect Termination12.in "SR Flip Flop1.out_n" as Connection55
                    connect V_match and.in4 as Connection557
                    connect and.out Junction34 as Connection552
                    connect f_match and.in3 as Connection556
                    connect or.out "SR Flip Flop1.r_in" as Connection501
                    connect or.in not.out as Connection499
                    connect phase_match and.in1 as Connection554
                    connect ss_speed and.in as Connection553
                    connect wait_to_trip.Reset "Edge Detection1.Out1" as Connection562
                    connect wait_to_trip.boolean Junction35 as Connection561
                    connect wait_to_trip.Trip and.in2 as Connection555
                }
                [
                    position = 9280, 8392
                    size = 176, 168
                ]

                component Subsystem Output {
                    layout = dynamic

                    port GCB_status {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "GCB_status"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto7 GCB_status as Connection630
                }
                [
                    position = 9392, 8624
                    size = 48, 48
                ]

                port V_grid {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 7976
                ]

                port GCB {
                    position = bottom:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9464, 8392
                ]

                port To_Gen_Control {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9248, 8104
                ]

                port From_Gen_Control {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8512, 8512
                ]

                port V_gen {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 8296
                ]

                tag From42 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7944
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8656, 8056
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto25 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8608
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8328
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8664, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto28 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8456
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8824, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From48 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8456, 7936
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto31 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9176, 8512
                    hide_name = True
                    size = 60, 20
                ]

                tag From44 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9280, 8240
                    rotation = right
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto29 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8792, 8664
                    hide_name = True
                    size = 60, 20
                ]

                tag From53 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From55 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8784, 8016
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8672
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7968
                    hide_name = True
                    size = 60, 20
                ]

                tag From37 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto30 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From39 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9296, 8624
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8632
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto20 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9480, 8352
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto22 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8680, 8216
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction26 sp
                [
                    position = 9424, 8392
                ]

                junction Junction32 sp
                [
                    position = 9056, 8216
                ]

                junction Junction34 sp
                [
                    position = 8744, 8136
                ]

                junction Junction35 sp
                [
                    position = 8624, 8216
                ]

                junction Junction39 sp
                [
                    position = 9120, 8536
                ]

                junction Junction40 sp
                [
                    position = 8728, 8016
                ]

                junction Junction41 sp
                [
                    position = 8608, 7976
                ]

                junction Junction42 sp
                [
                    position = 9160, 8328
                ]

                junction Junction43 sp
                [
                    position = 8616, 8680
                ]

                junction Junction44 sp
                [
                    position = 8744, 8296
                ]

                junction Junction45 sp
                [
                    position = 8720, 8360
                ]

                junction Junction46 sp
                [
                    position = 8528, 8440
                ]

                connect "Bus Join2.in1" "Bus Split1.out2" as Connection601
                connect "Bus Join2.in" "Bus Split1.out1" as Connection600
                connect "Bus Join2.in2" Junction43 as Connection603
                connect "Bus Split1.in" From_Gen_Control as Connection598
                connect "Bus Split1.out" Goto25 as Connection546
                connect Check_phase_ON.in Junction46 as Connection622
                connect Contactor_Control.ss_speed Junction42 as Connection594
                connect Contactor_Control.phase_match Junction45 as Connection618
                connect From37 Contactor_Control.f_match as Connection270
                connect From39 Contactor_Control.Gen_on as Connection271
                connect From40 Junction42 as Connection596
                connect From41 "Bus Join.in1" as Connection528
                connect From42 "Bus Join.in" as Connection527
                connect From44 Contactor_Control.GCB_Control as Connection541
                connect From47 Calculate_dw_synch.Activate as Connection556
                connect From48 check_V_diff.Activate as Connection586
                connect From49 "Bus Join.in2" as Connection569
                connect From50 Contactor_Control.V_match as Connection574
                connect From52 and2.in3 as Connection584
                connect From53 and1.in1 as Connection585
                connect From55 and2.in4 as Connection609
                connect From56 Output.GCB_status as Connection625
                connect GCB Junction26 as Connection141
                connect Goto20 Junction26 as Connection143
                connect Goto28 Junction32 as Connection250
                connect Goto29 "Bus Join2.out" as Connection540
                connect Goto30 Junction43 as Connection605
                connect Goto31 Junction39 as Connection561
                connect Goto32 Junction41 as Connection575
                connect Goto33 Junction40 as Connection571
                connect Goto34 "Bus Split1.out4" as Connection606
                connect Goto36 check_V_diff.Grid_On as Connection608
                connect Junction26 Contactor_Control.GCB as Connection204
                connect Junction32 Calculate_dw_synch.dw_synch as Connection249
                connect Junction34 Calculate_dw_synch.dw_f as Connection280
                connect Junction35 Goto22 as Connection283
                connect Junction39 and2.out as Connection562
                connect Junction40 check_V_diff.V_match as Connection572
                connect Junction41 check_V_diff.dV as Connection576
                connect Junction42 Speed_ss.in as Connection595
                connect Junction43 "Bus Split1.out3" as Connection604
                connect Junction44 Calculate_dw_synch.dw_phase as Connection616
                connect Junction45 Phase_match.in as Connection619
                connect Junction46 and1.out as Connection623
                connect To_Gen_Control "Bus Join.out" as Connection259
                connect V_gen PLLs.V_Gen as Connection587
                connect V_grid PLLs.V_Grid as Connection588
                connect V_match.in Junction40 as Connection573
                connect and1.in From30 as Connection273
                connect and2.in1 From45 as Connection553
                connect and2.in2 From46 as Connection554
                connect and2.in not.out as Connection552
                connect check_V_diff.Vgen PLLs.Vgen as Connection565
                connect check_V_diff.Vgrid PLLs.Vgrid as Connection566
                connect check_f_diff.dw_f Junction34 as Connection281
                connect check_f_diff.f_match Junction35 as Connection284
                connect check_f_diff.f_Grid PLLs.f_Grid as Connection278
                connect check_f_diff.f_Gen PLLs.f_Gen as Connection277
                connect check_phase_diff.dw_phase Junction44 as Connection617
                connect check_phase_diff.phase_match Junction45 as Connection620
                connect check_phase_diff.Activate Junction46 as Connection624
                connect check_phase_diff.phase_Diff "PLLs.Phase diff" as Connection621
                connect dV.in Junction41 as Connection577
                connect dw_f.in Junction34 as Connection279
                connect dw_phase.in Junction44 as Connection615
                connect dw_synch.in Junction32 as Connection248
                connect dw_synch_ON.in Junction39 as Connection563
                connect f_match.in Junction35 as Connection282
                connect not.in From33 as Connection551
            }
            [
                position = 9448, 8056
                scale = -1, 1
                size = 144, 200
            ]

            component Subsystem Output {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "14"
                }
                [
                    position = 8008, 8216
                    rotation = down
                    hide_name = True
                    scale = -1, -1
                ]

                port Output {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8112, 8216
                ]

                tag From32 {
                    value = "GCB_status"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7680, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "w_meas"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7656, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Gen_On"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7632, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7872, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7776, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7920, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7728, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From22 {
                    value = "Vc"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7752, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7704, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7896, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7800, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                connect "Bus Join1.out" Output as Connection4
                connect From21 "Bus Join1.in8" as Connection572
                connect From22 "Bus Join1.in5" as Connection569
                connect From23 "Bus Join1.in4" as Connection568
                connect From24 "Bus Join1.in7" as Connection571
                connect From25 "Bus Join1.in3" as Connection567
                connect From26 "Bus Join1.in9" as Connection573
                connect From27 "Bus Join1.in13" as Connection577
                connect From28 "Bus Join1.in12" as Connection576
                connect From29 "Bus Join1.in11" as Connection575
                connect From30 "Bus Join1.in10" as Connection574
                connect From31 "Bus Join1.in6" as Connection570
                connect From32 "Bus Join1.in2" as Connection578
                connect From33 "Bus Join1.in1" as Connection580
                connect From34 "Bus Join1.in" as Connection579
            }
            [
                position = 9696, 7968
                size = 104, 96
            ]

            component Subsystem Measurements {
                layout = dynamic
                component "core/Gain" Gain8 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7568
                    hide_name = True
                ]

                component "core/Probe" e_f {
                }
                [
                    position = 7760, 7776
                ]

                component "core/Gain" Gain7 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7632
                    hide_name = True
                ]

                component "core/Bus Join" "Bus Join3" {
                    inputs = "3"
                }
                [
                    position = 8080, 7792
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Bus Join" "Bus Join1" {
                    inputs = "4"
                }
                [
                    position = 8016, 7544
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Probe" pf {
                    addr = "17951"
                }
                [
                    position = 7704, 7696
                ]

                component "core/Probe" P {
                    addr = "17965"
                }
                [
                    position = 7704, 7504
                ]

                component "core/Probe" Q {
                    addr = "17938"
                }
                [
                    position = 7704, 7568
                ]

                component "core/Probe" S {
                    addr = "17951"
                }
                [
                    position = 7704, 7632
                ]

                component "core/Gain" Gain10 {
                    gain = "1.0/(2*np.pi*f)"
                }
                [
                    position = 7696, 7776
                    hide_name = True
                ]

                component "core/Gain" Gain9 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7504
                    hide_name = True
                ]

                component "core/Current Measurement" Ib {
                    addr = "24"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8176
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Current Measurement" Ic {
                    addr = "26"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8272
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7944, 8336
                    rotation = right
                    size = 64, 32
                ]

                component "core/Current Measurement" Ia {
                    addr = "22"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8080
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7856, 8432
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7904, 8384
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Output {
                    layout = dynamic

                    port Va {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8120
                    ]

                    port Vb {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8152
                    ]

                    port Vc {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8192
                    ]

                    port Vt {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8224
                    ]

                    port Ia {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8264
                    ]

                    port Ib {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8296
                    ]

                    port Ic {
                        position = left:7
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8336
                    ]

                    port P {
                        position = left:8
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8368
                    ]

                    port Q {
                        position = left:9
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8408
                    ]

                    port S {
                        position = left:10
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8440
                    ]

                    port pf {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8480
                    ]

                    tag Goto8 {
                        value = "Vb"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8152
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto9 {
                        value = "Vc"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8192
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto10 {
                        value = "Vt"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8224
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto11 {
                        value = "Ib"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8296
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto12 {
                        value = "P"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8368
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto13 {
                        value = "Ic"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8336
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto14 {
                        value = "Ia"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8264
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto15 {
                        value = "Q"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8408
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto16 {
                        value = "S"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto17 {
                        value = "pf"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8480
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto7 {
                        value = "Va"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto10 Vt as Connection4
                    connect Goto13 Ic as Connection7
                    connect Goto14 Ia as Connection5
                    connect Goto15 Q as Connection9
                    connect Goto17 pf as Connection11
                    connect Goto8 Vb as Connection2
                    connect Goto9 Vc as Connection3
                    connect Ib Goto11 as Connection6
                    connect P Goto12 as Connection8
                    connect S Goto16 as Connection10
                    connect Va Goto7 as Connection1
                }
                [
                    position = 8416, 7720
                    size = 96, 328
                ]

                component Subsystem "PQ measure" {
                    layout = dynamic
                    component "core/Power Meter" "PQ Power Meter1" {
                    }
                    [
                        position = 8096, 8192
                    ]

                    component "core/Termination" Termination2 {
                    }
                    [
                        position = 8264, 8232
                        rotation = left
                        hide_name = True
                        scale = -1, -1
                    ]

                    component "core/Termination" Termination1 {
                    }
                    [
                        position = 8264, 8152
                        rotation = left
                        hide_name = True
                        scale = -1, 1
                    ]

                    port S {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8264
                        rotation = right
                        scale = -1, 1
                    ]

                    port pf {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8288
                        rotation = right
                        scale = -1, 1
                    ]

                    port Q {
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8120
                        rotation = left
                        scale = -1, 1
                    ]

                    port P {
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8088
                        rotation = left
                        scale = -1, 1
                    ]

                    port Va {
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8088
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vb {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8120
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vc {
                        position = right:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8152
                        rotation = right
                        scale = -1, 1
                    ]

                    port Ia {
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8224
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ib {
                        position = right:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8256
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ic {
                        position = right:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8288
                        rotation = left
                        scale = -1, 1
                    ]

                    connect "PQ Power Meter1.ia" Ia as Connection1
                    connect "PQ Power Meter1.ib" Ib as Connection2
                    connect "PQ Power Meter1.ic" Ic as Connection3
                    connect "PQ Power Meter1.Pdc" P as Connection4
                    connect "PQ Power Meter1.Qdc" Q as Connection5
                    connect S "PQ Power Meter1.apparent" as Connection9
                    connect Termination1.in "PQ Power Meter1.Pac" as Connection10
                    connect Termination2.in "PQ Power Meter1.Qac" as Connection11
                    connect Va "PQ Power Meter1.va" as Connection13
                    connect Vb "PQ Power Meter1.vb" as Connection14
                    connect Vc "PQ Power Meter1.vc" as Connection15
                    connect pf "PQ Power Meter1.k_factor" as Connection12
                }
                [
                    position = 7424, 7600
                    scale = -1, 1
                    size = 128, 232
                ]

                component Subsystem 3ph_PLL_Gen {
                    layout = dynamic
                    component "core/Termination" Term {
                    }
                    [
                        position = 8080, 8144
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Termination" Term1 {
                    }
                    [
                        position = 8112, 8184
                        rotation = left
                        hide_name = True
                    ]

                    component Subsystem PLL {
                        layout = dynamic
                        component "core/Rate Limiter" "Rate Limiter1" {
                            falling_limit = "2*np.pi*w_fall"
                            rising_limit = "2*np.pi*w_rise"
                        }
                        [
                            position = 8304, 7984
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q1 {
                            a_coeff = "[1,2*zeta*(2*np.pi*fc_w),(2*np.pi*fc_w)**2.0]"
                            b_coeff = "(2*np.pi*fc_w)**2.0"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 7984
                            hide_name = True
                        ]

                        component "core/C function" integrator {
                            init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
out += execution_rate*in;
if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8352, 8136
                            size = 0, 0
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 7864, 8208
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Unit Delay" "Unit Delay1" {
                        }
                        [
                            position = 8432, 8224
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q {
                            a_coeff = "[1.0/(2*np.pi*fc_q),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7912, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_d {
                            a_coeff = "[1.0/(2*np.pi*fc_d),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7856, 8120
                            hide_name = True
                        ]

                        component Subsystem Normalize {
                            layout = dynamic
                            component "core/C function" V_terminal {
                                init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                input_terminals = "real d;inherit q;"
                                input_terminals_dimensions = "inherit;inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                input_terminals_show_labels = "False;False;"
                                output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                output_terminals = "real t;inherit q_pu;"
                                output_terminals_dimensions = "inherit;inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                output_terminals_show_labels = "False;False;"
                            }
                            [
                                position = 8192, 8192
                                size = 0, 0
                            ]

                            port d {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8152
                            ]

                            port q {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8216
                            ]

                            port q_pu {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8352, 8200
                            ]

                            port Vt {
                                position = top:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8280, 8104
                                rotation = left
                            ]

                            connect V_terminal.t Vt as Connection8
                            connect V_terminal.d d as Connection1
                            connect V_terminal.q q as Connection3
                            connect q_pu V_terminal.q_pu as Connection9
                        }
                        [
                            position = 8096, 8136
                            size = 64, 64
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8072, 8400
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "lowLim*2*np.pi*f/100.0"
                                upper_limit = "upLim*2*np.pi*f/100.0"
                            }
                            [
                                position = 8416, 8224
                            ]

                            component "core/Gain" Kp {
                                gain = "Kp"
                            }
                            [
                                position = 7928, 8136
                            ]

                            component "core/Integrator" Integrator2 {
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8112, 8304
                                scale = -1, 1
                            ]

                            component "core/Sum" Sum8 {
                                signs = "+-"
                            }
                            [
                                position = 8032, 8224
                            ]

                            component "core/Gain" Gain1 {
                                gain = "2*np.pi*fc_Kd"
                            }
                            [
                                position = 8152, 8224
                            ]

                            component "core/Gain" Ki {
                                gain = "Ki"
                            }
                            [
                                position = 7928, 8392
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "2*np.pi*f"
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8200, 8400
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8200, 8488
                                scale = -1, 1
                            ]

                            component "core/Gain" Kd {
                                gain = "Kd"
                            }
                            [
                                position = 7928, 8216
                            ]

                            component "core/Sum" Sum5 {
                                signs = "3"
                            }
                            [
                                position = 8328, 8224
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8328, 8488
                                scale = -1, 1
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7752, 8216
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8480, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8376, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8448, 8224
                            ]

                            junction Junction7 sp
                            [
                                position = 8224, 8224
                            ]

                            junction Junction8 sp
                            [
                                position = 7792, 8216
                            ]

                            junction Junction9 sp
                            [
                                position = 7792, 8216
                            ]

                            connect Gain1.out Junction7 as Connection85
                            connect Gain1.in Sum8.out as Connection61
                            connect In Junction9 as Connection94
                            connect Integrator1.out Sum5.in2 as Connection95
                            connect Integrator2.out Sum8.in1 as Connection66
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction7 Integrator2.in as Connection86
                            connect Junction8 Kd.in as Connection90
                            connect Junction9 Junction8 as Connection93
                            connect Kb.in Sum6.out as Connection50
                            connect Kd.out Sum8.in as Connection80
                            connect Ki.in Junction9 as Connection92
                            connect Kp.in Junction8 as Connection89
                            connect Kp.out Sum5.in as Connection68
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.out Junction2 as Connection44
                            connect Sum5.in1 Junction7 as Connection87
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                            connect Sum7.in Ki.out as Connection69
                        }
                        [
                            position = 8200, 8136
                            size = 64, 48
                        ]

                        component Subsystem ABC_dqz {
                            layout = dynamic
                            component "core/abc to alpha beta" "abc to alpha beta" {
                            }
                            [
                                position = 8024, 8192
                            ]

                            component "core/alpha beta to dq" "alpha beta to dq" {
                            }
                            [
                                position = 8248, 8192
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7952, 8104
                                rotation = right
                            ]

                            port B {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7904, 8104
                                rotation = right
                            ]

                            port C {
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7856, 8104
                                rotation = right
                            ]

                            port wt {
                                position = left:4
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8176, 8288
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8320, 8136
                                rotation = left
                            ]

                            port q {
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8368, 8136
                                rotation = left
                            ]

                            port z {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8096, 8288
                                rotation = right
                            ]

                            connect "abc to alpha beta.A" A as Connection2685
                            connect "abc to alpha beta.B" B as Connection2686
                            connect "abc to alpha beta.C" C as Connection2687
                            connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                            connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                            connect "alpha beta to dq.wt" wt as Connection2690
                            connect d "alpha beta to dq.d" as Connection2692
                            connect q "alpha beta to dq.q" as Connection2693
                            connect z "abc to alpha beta.gamma" as Connection2691
                        }
                        [
                            position = 7776, 8152
                            size = 48, 104
                        ]

                        port A {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7608, 8152
                            rotation = left
                        ]

                        port B {
                            label = "B"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8176
                            rotation = left
                        ]

                        port C {
                            label = "C"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7688, 8200
                            rotation = left
                        ]

                        port d {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8024
                        ]

                        port q {
                            label = "q"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8080
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8160, 8072
                        ]

                        port wt {
                            position = right:5
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8072
                        ]

                        port w {
                            position = right:4
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 7984
                        ]

                        junction Junction6 sp
                        [
                            position = 8408, 8136
                        ]

                        junction Junction13 sp
                        [
                            position = 8264, 8136
                        ]

                        junction Junction14 sp
                        [
                            position = 7960, 8120
                        ]

                        junction Junction15 sp
                        [
                            position = 8000, 8152
                        ]

                        connect ABC_dqz.A A as Connection266
                        connect ABC_dqz.B B as Connection267
                        connect ABC_dqz.C C as Connection268
                        connect ABC_dqz.d LPF_d.in as Connection263
                        connect ABC_dqz.q LPF_q.in as Connection264
                        connect ABC_dqz.z Term.in as Connection265
                        connect Junction13 integrator.in as Connection246
                        connect Junction14 Normalize.d as Connection253
                        connect Junction14 d as Connection262
                        connect Junction15 q as Connection261
                        connect Junction6 integrator.out as Connection195
                        connect LPF_d.out Junction14 as Connection254
                        connect LPF_q.out Junction15 as Connection257
                        connect LPF_q1.in "Rate Limiter1.out" as Connection259
                        connect Normalize.q Junction15 as Connection255
                        connect Normalize.Vt Vt as Connection211
                        connect PI.Out Junction13 as Connection247
                        connect PI.In Normalize.q_pu as Connection244
                        connect "Rate Limiter1.in" Junction13 as Connection260
                        connect "Unit Delay1.out" ABC_dqz.wt as Connection269
                        connect "Unit Delay1.in" Junction6 as Connection194
                        connect w LPF_q1.out as Connection258
                        connect wt Junction6 as Connection196

                        f = "f"
                        lowLim = "70"
                        upLim = "140"
                        w_fall = "-f/5"
                        w_rise = "f/5"

                        mask {
                            description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Simple PLL with wrapped wt</span></p></body></html>"

                            Kp {
                                label = "Proportional gain"
                                widget = edit
                                type = generic
                                default_value = "100.0"
                            }

                            Ki {
                                label = "Integral gain"
                                widget = edit
                                type = generic
                                default_value = "3200.0"
                            }

                            Kd {
                                label = "Differential gain"
                                widget = edit
                                type = generic
                                default_value = "1.0"
                            }

                            fc_Kd {
                                label = "Derivative control LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "113.6821"
                            }

                            fc_d {
                                label = "d channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            fc_q {
                                label = "q channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            f {
                                label = "Target frequency"
                                widget = edit
                                type = generic
                                default_value = "60.0"
                                unit = "Hz"
                            }

                            upLim {
                                label = "Frequency deviation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                unit = "%"
                            }

                            lowLim {
                                label = "Frequency deviation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                unit = "%"
                            }

                            zeta {
                                label = "w 2nd order LPF damping ratio"
                                widget = edit
                                type = generic
                                default_value = "0.707"
                            }

                            fc_w {
                                label = "w 2nd order LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "25.0"
                                unit = "Hz"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                            }

                            w_rise {
                                label = "w Rising rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            w_fall {
                                label = "w Falling rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 7984, 8240
                        rotation = down
                        scale = -1, -1
                        size = 72, 152
                    ]

                    port Va {
                        label = "Va"
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8184
                    ]

                    port Vb {
                        label = "Vb"
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8240
                    ]

                    port Vc {
                        label = "Vc"
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8296
                    ]

                    port Vt {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8136, 8240
                    ]

                    port w {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8104, 8264
                    ]

                    port wt {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8072, 8288
                    ]

                    connect PLL.d Term.in as Connection4
                    connect PLL.A Va as Connection1
                    connect PLL.C Vc as Connection3
                    connect PLL.Vt Vt as Connection6
                    connect PLL.wt wt as Connection8
                    connect Term1.in PLL.q as Connection5
                    connect Vb PLL.B as Connection2
                    connect w PLL.w as Connection7
                }
                [
                    position = 7480, 7824
                    size = 72, 120
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R21 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8232, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R20 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8304, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R22 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8376, 7944
                        rotation = right
                    ]

                    port G {
                        position = bottom:3
                        kind = pe
                    }
                    [
                        position = 8304, 8112
                        rotation = left
                    ]

                    port A {
                        position = top:4
                        kind = pe
                    }
                    [
                        position = 8232, 7848
                        rotation = right
                    ]

                    port B {
                        position = top:5
                        kind = pe
                    }
                    [
                        position = 8304, 7848
                        rotation = right
                    ]

                    port C {
                        position = top:6
                        kind = pe
                    }
                    [
                        position = 8376, 7848
                        rotation = right
                    ]

                    junction Junction1516 pe
                    [
                        position = 8304, 8032
                    ]

                    junction Junction1517 pe
                    [
                        position = 8304, 8032
                    ]

                    connect A R21.p_node as Connection758
                    connect B R20.p_node as Connection759
                    connect G Junction1517 as Connection764
                    connect Junction1516 Junction1517 as Connection762
                    connect Junction1516 R21.n_node as Connection755
                    connect Junction1517 R22.n_node as Connection763
                    connect R20.n_node Junction1516 as Connection698
                    connect R22.p_node C as Connection760
                }
                [
                    position = 7664, 8384
                    size = 88, 80
                ]

                port a {
                    label = "a"
                    position = right:1
                    kind = pe
                }
                [
                    position = 8208, 8080
                    rotation = down
                ]

                port b {
                    label = "b"
                    position = right:2
                    kind = pe
                }
                [
                    position = 8208, 8176
                    rotation = down
                ]

                port c {
                    label = "c"
                    position = right:3
                    kind = pe
                }
                [
                    position = 8208, 8272
                    rotation = down
                ]

                port A {
                    label = "A"
                    position = left:1
                    kind = pe
                }
                [
                    position = 7520, 8080
                ]

                port B {
                    label = "B"
                    position = left:2
                    kind = pe
                }
                [
                    position = 7520, 8176
                ]

                port C {
                    label = "C"
                    position = left:3
                    kind = pe
                }
                [
                    position = 7520, 8272
                ]

                port Sync_fb {
                    position = top:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8080, 7728
                    rotation = left
                    scale = -1, 1
                ]

                port Control_fb {
                    position = top:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8016, 7472
                    rotation = left
                    scale = -1, 1
                ]

                tag From22 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8032
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7608
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8384
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7600
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7672
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7624
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto11 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag From43 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag From32 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7632
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7704, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto5 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8136
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7912
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto8 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7520
                    hide_name = True
                    size = 60, 20
                ]

                tag From35 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7848
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7840
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto7 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7488
                    hide_name = True
                    size = 60, 20
                ]

                tag From42 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7744
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7792
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto6 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8232
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7816
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction1497 pe
                [
                    position = 7856, 8080
                ]

                junction Junction1518 sp
                [
                    position = 7520, 7504
                ]

                junction Junction1519 sp
                [
                    position = 7520, 7568
                ]

                junction Junction1520 sp
                [
                    position = 7520, 7632
                ]

                junction Junction1521 sp
                [
                    position = 7520, 7696
                ]

                junction Junction1525 pe
                [
                    position = 7904, 8176
                ]

                junction Junction1528 pe
                [
                    position = 7944, 8272
                ]

                junction Junction1534 pe
                [
                    position = 7904, 8504
                ]

                junction Junction1535 pe
                [
                    position = 7856, 8504
                ]

                junction Junction1536 pe
                [
                    position = 7640, 8080
                ]

                junction Junction1537 pe
                [
                    position = 7664, 8176
                ]

                junction Junction1538 pe
                [
                    position = 7688, 8272
                ]

                junction Junction1540 sp
                [
                    position = 7648, 7824
                ]

                connect 3ph_PLL_Gen.Va From42 as Connection925
                connect 3ph_PLL_Gen.Vt Goto11 as Connection924
                connect 3ph_PLL_Gen.w Junction1540 as Connection926
                connect B Junction1537 as Connection888
                connect "Bus Join1.in" From10 as Connection911
                connect "Bus Join1.in1" From11 as Connection908
                connect "Bus Join1.in2" From32 as Connection910
                connect C Junction1538 as Connection891
                connect Control_fb "Bus Join1.out" as Connection912
                connect From21 Output.Ib as Connection914
                connect From22 Output.Vc as Connection921
                connect From23 Output.Vb as Connection913
                connect From24 Output.Ia as Connection916
                connect From25 Output.Va as Connection918
                connect From26 Output.Ic as Connection920
                connect From27 Output.pf as Connection917
                connect From28 Output.S as Connection919
                connect From29 Output.Q as Connection922
                connect From30 Output.P as Connection915
                connect From31 Output.Vt as Connection923
                connect From33 "Bus Join3.in1" as Connection783
                connect From34 "Bus Join3.in2" as Connection784
                connect From35 "Bus Join3.in" as Connection782
                connect From4 "PQ measure.Va" as Connection714
                connect From40 3ph_PLL_Gen.Vc as Connection899
                connect From41 3ph_PLL_Gen.Vb as Connection898
                connect From43 "Bus Join1.in3" as Connection909
                connect From5 "PQ measure.Vc" as Connection716
                connect From6 "PQ measure.Vb" as Connection715
                connect From7 "PQ measure.Ia" as Connection717
                connect From8 "PQ measure.Ib" as Connection718
                connect From9 "PQ measure.Ic" as Connection719
                connect Gain10.in Junction1540 as Connection904
                connect Goto1 Va.out as Connection703
                connect Goto10 Junction1521 as Connection734
                connect Goto12 Junction1540 as Connection906
                connect Goto13 3ph_PLL_Gen.wt as Connection907
                connect Goto2 Vb.out as Connection705
                connect Goto3 Vc.out as Connection707
                connect Goto4 Ia.out as Connection708
                connect Goto5 Ib.out as Connection709
                connect Goto6 Ic.out as Connection710
                connect Goto7 Junction1518 as Connection725
                connect Goto8 Junction1519 as Connection728
                connect Goto9 Junction1520 as Connection731
                connect Ia.p_node a as Connection218
                connect Ib.p_node b as Connection212
                connect Ic.p_node c as Connection217
                connect Junction1497 Ia.n_node as Connection871
                connect Junction1497 Junction1536 as Connection885
                connect Junction1518 Gain9.in as Connection724
                connect Junction1519 Gain8.in as Connection727
                connect Junction1520 Gain7.in as Connection730
                connect Junction1521 "PQ measure.pf" as Connection733
                connect Junction1525 Ib.n_node as Connection870
                connect Junction1528 Ic.n_node as Connection867
                connect Junction1534 Junction1535 as Connection882
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Va.n_node as Connection883
                connect Junction1536 A as Connection886
                connect Junction1537 Junction1525 as Connection889
                connect Junction1538 Junction1528 as Connection892
                connect P.in Gain9.out as Connection158
                connect "PQ measure.P" Junction1518 as Connection723
                connect "PQ measure.Q" Junction1519 as Connection726
                connect "PQ measure.S" Junction1520 as Connection729
                connect Q.in Gain8.out as Connection161
                connect S.in Gain7.out as Connection192
                connect Snubber.G Junction1535 as Connection884
                connect Snubber.A Junction1536 as Connection887
                connect Snubber.B Junction1537 as Connection890
                connect Snubber.C Junction1538 as Connection893
                connect Sync_fb "Bus Join3.out" as Connection781
                connect Va.p_node Junction1497 as Connection487
                connect Vb.p_node Junction1525 as Connection833
                connect Vb.n_node Junction1534 as Connection839
                connect Vc.p_node Junction1528 as Connection806
                connect e_f.in Gain10.out as Connection824
                connect pf.in Junction1521 as Connection732
            }
            [
                position = 9248, 8320
                scale = -1, 1
                size = 112, 112
            ]

            component Subsystem Ggrid_meas {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "3"
                }
                [
                    position = 8744, 7984
                    rotation = left
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8336, 8168
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8248, 8264
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8296, 8216
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R1 {
                        resistance = "1e5"
                    }
                    [
                        position = 8120, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R2 {
                        resistance = "1e5"
                    }
                    [
                        position = 8192, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R3 {
                        resistance = "1e5"
                    }
                    [
                        position = 8264, 8144
                        rotation = right
                    ]

                    port G {
                        position = bottom:1
                        kind = pe
                    }
                    [
                        position = 8192, 8296
                        rotation = left
                    ]

                    port A {
                        position = top:1
                        kind = pe
                    }
                    [
                        position = 8120, 8064
                        rotation = right
                    ]

                    port B {
                        position = top:2
                        kind = pe
                    }
                    [
                        position = 8192, 8064
                        rotation = right
                    ]

                    port C {
                        position = top:3
                        kind = pe
                    }
                    [
                        position = 8264, 8064
                        rotation = right
                    ]

                    junction Junction1490 pe
                    [
                        position = 8192, 8248
                    ]

                    junction Junction1491 pe
                    [
                        position = 8192, 8248
                    ]

                    connect G Junction1491 as Connection403
                    connect Junction1490 R1.n_node as Connection395
                    connect Junction1491 Junction1490 as Connection402
                    connect R1.p_node A as Connection399
                    connect R2.p_node B as Connection397
                    connect R2.n_node Junction1490 as Connection385
                    connect R3.p_node C as Connection398
                    connect R3.n_node Junction1491 as Connection401
                }
                [
                    position = 8104, 8248
                    size = 64, 48
                ]

                port V {
                    position = top:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8744, 7912
                    rotation = left
                ]

                port A {
                    position = left:1
                    kind = pe
                }
                [
                    position = 7992, 7912
                ]

                port B {
                    position = left:2
                    kind = pe
                }
                [
                    position = 7992, 8016
                ]

                port C {
                    position = left:3
                    kind = pe
                }
                [
                    position = 7992, 8120
                ]

                port a {
                    position = right:1
                    kind = pe
                }
                [
                    position = 8504, 7912
                    rotation = down
                ]

                port b {
                    position = right:2
                    kind = pe
                }
                [
                    position = 8504, 8016
                    rotation = down
                ]

                port c {
                    position = right:3
                    kind = pe
                }
                [
                    position = 8504, 8120
                    rotation = down
                ]

                tag From1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8040
                    hide_name = True
                    size = 0, 0
                ]

                tag From2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8080
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8216
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8264
                    hide_name = True
                    size = 0, 0
                ]

                tag From3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8120
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8168
                    hide_name = True
                    size = 0, 0
                ]

                junction Junction1492 pe
                [
                    position = 8088, 7912
                ]

                junction Junction1493 pe
                [
                    position = 8104, 8016
                ]

                junction Junction1494 pe
                [
                    position = 8120, 8120
                ]

                junction Junction1534 pe
                [
                    position = 8296, 8336
                ]

                junction Junction1535 pe
                [
                    position = 8336, 8120
                ]

                junction Junction1536 pe
                [
                    position = 8296, 8016
                ]

                junction Junction1537 pe
                [
                    position = 8248, 7912
                ]

                junction Junction1538 pe
                [
                    position = 8248, 8336
                ]

                connect A Junction1492 as Connection402
                connect B Junction1493 as Connection405
                connect "Bus Join1.in1" From2 as Connection431
                connect "Bus Join1.in2" From3 as Connection432
                connect C Junction1494 as Connection408
                connect From1 "Bus Join1.in" as Connection430
                connect Goto4 Va.out as Connection703
                connect Goto5 Vc.out as Connection707
                connect Goto6 Vb.out as Connection705
                connect Junction1492 Junction1537 as Connection855
                connect Junction1492 Snubber.A as Connection412
                connect Junction1493 Junction1536 as Connection852
                connect Junction1493 Snubber.B as Connection410
                connect Junction1494 Snubber.C as Connection411
                connect Junction1534 Junction1538 as Connection858
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Junction1494 as Connection850
                connect Junction1536 b as Connection853
                connect Junction1537 a as Connection856
                connect Junction1538 Va.n_node as Connection859
                connect Snubber.G Junction1538 as Connection860
                connect V "Bus Join1.out" as Connection366
                connect Va.p_node Junction1537 as Connection857
                connect Vb.n_node Junction1534 as Connection839
                connect Vb.p_node Junction1536 as Connection854
                connect Vc.p_node Junction1535 as Connection851
                connect c Junction1535 as Connection849
            }
            [
                position = 9608, 8320
                scale = -1, 1
                size = 56, 232
            ]

            component "core/Bus Split" bus_split {
            }
            [
                position = 8888, 8112
            ]

            port A {
                position = 180.0, -96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8224
                scale = -1, 1
            ]

            port B {
                position = 180.0, -0.1
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8320
                scale = -1, 1
            ]

            port C {
                position = 180.0, 96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8416
                scale = -1, 1
            ]

            port Inputs {
                position = -152.0, -120.0
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 9088, 7896
                rotation = right
                scale = -1, 1
            ]

            port Outputs {
                position = 152.0, -120.0
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 9816, 7920
                rotation = left
            ]

            junction Junction118 pe
            [
                position = 8800, 8240
            ]

            junction Junction122 pe
            [
                position = 8800, 8408
            ]

            connect A Ggrid_meas.A as Connection669
            connect B Ggrid_meas.B as Connection670
            connect C Ggrid_meas.C as Connection671
            connect Control.T_out Gen.load_in as Connection611
            connect Control.To_synch_check Sync_Check.From_Gen_Control as Connection673
            connect Gen.r_2 Junction122 as Connection664
            [
                position = 0, 0
                breakpoints = 8864, 8336; 8864, 8408
            ]
            connect Gen.c_in Measurements.c as Connection323
            connect Gen.b_in Measurements.b as Connection318
            connect Gen.a_in Measurements.a as Connection324
            connect Ggrid_meas.b MCB.b_in as Connection481
            connect Ggrid_meas.c MCB.c_in as Connection483
            connect Ggrid_meas.a MCB.a_in as Connection479
            connect If.n_node Junction118 as Connection601
            connect Inputs Control.Inputs as Connection668
            connect Junction118 Gen.r_1 as Connection600
            [
                position = 0, 0
                breakpoints = 8864, 8240; 8864, 8304
            ]
            connect Junction122 Vfield.n_node as Connection665
            connect Measurements.Control_fb Control.Meas_feedback as Connection500
            connect Measurements.B MCB.b_out as Connection613
            connect Measurements.C MCB.c_out as Connection614
            connect Measurements.A MCB.a_out as Connection612
            connect Output.Output Outputs as Connection667
            connect Sync_Check.To_Gen_Control Control.From_synch_check as Connection672
            connect Sync_Check.V_grid Ggrid_meas.V as Connection638
            connect Sync_Check.GCB MCB.ctrl_in as Connection637
            connect Sync_Check.V_gen Measurements.Sync_fb as Connection636
            connect Vfd.in Control.Vf_out as Connection649
            connect Vfd.p_node If.p_node as Connection663
            connect Vfd.n_node Junction122 as Connection666
            connect Vfield.p_node Junction118 as Connection599
            connect Gen.out bus_split.in as Connection674
            [
                position = 0, 0
                breakpoints = 8848, 8232; 8848, 8160
            ]
            connect bus_split.out Control.T_in as Connection675
            connect bus_split.out1 Control.wmeas as Connection676

            Sb = "1e6"
            Ts = "Ts"
            Vn = "480"
            phaseOff = "0.0"

            mask {
                icon = "image(\'diesel_genset.svg\')"
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Diesel Genset with synchronous machine, DEGOV governor, DC4B exciter, frequency setpoint control for w and P, power factor control loop and synch check with grid to close GCB contactor.</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of variable inputs to this block is 9 and they must be sent through a Bus Join in the following order: 0 - Gen_On; 1 - Vref; 2 - wref; 3 - Pref; 4 - pf_ref; 5 - Gen_OP_mode; 6 - Gen_Control_Mode; 7 - Load_share_on; 8 - Load_share.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                                                                                                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of outputs of this block is 14 and they are arranged in the following order: 0 - Gen_On; 1 - wmeas; 2 - GCB_status; 3 - Va; 4 - Vb; 5 - Vc; 6 - Vt; 7 - Ia; 8 - Ib; 9 - Ic; 10 - P; 11 - Q; 12 - S; 13 - pf.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Adjustment of the shunt snubber load is important for simulation stability in multiple time steps.</span></p></body></html>"
                help_file = "diesel_genset.html"

                Sb {
                    label = "Nominal Power"
                    widget = edit
                    type = generic
                    default_value = "2.2e6"
                    unit = "VA"
                    group = "1 - Basic"
                }

                Vn {
                    label = "Phase Nominal Voltage"
                    widget = edit
                    type = generic
                    default_value = "480.0"
                    unit = "V (line to line)"
                    group = "1 - Basic"
                }

                f {
                    label = "Nominal electrical frequency"
                    widget = edit
                    type = generic
                    default_value = "60.0"
                    unit = "Hz"
                    group = "1 - Basic"
                }

                load {
                    label = "Shunt snubber load percentage of nominal power"
                    widget = edit
                    type = generic
                    default_value = "5"
                    unit = "%"
                    group = "1 - Basic"
                }

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                    unit = "s"
                    group = "1 - Basic"
                }

                Rs {
                    label = "Rs"
                    widget = edit
                    type = generic
                    default_value = "9.4035e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Lls {
                    label = "Lls"
                    widget = edit
                    type = generic
                    default_value = "1.389e-5"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmd {
                    label = "Lmd"
                    widget = edit
                    type = generic
                    default_value = "6.5282e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmq {
                    label = "Lmq"
                    widget = edit
                    type = generic
                    default_value = "4.778e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rf_prime {
                    label = "Rf"
                    widget = edit
                    type = generic
                    default_value = "2.1574e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llfd_prime {
                    label = "Llfd"
                    widget = edit
                    type = generic
                    default_value = "1.4195e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkd {
                    label = "Rkd"
                    widget = edit
                    type = generic
                    default_value = "0.0443938909091"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkq {
                    label = "Rkq"
                    widget = edit
                    type = generic
                    default_value = "0.00399796363636"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkd {
                    label = "Llkd"
                    widget = edit
                    type = generic
                    default_value = "0.00155586168397"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkq {
                    label = "Llkq"
                    widget = edit
                    type = generic
                    default_value = "9.96738215238e-05"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nfd {
                    label = "Ns/Nfd"
                    widget = edit
                    type = generic
                    default_value = "0.02512"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkd {
                    label = "Ns/Nkd"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkq {
                    label = "Ns/Nkq"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                pms {
                    label = "pms"
                    widget = edit
                    type = generic
                    default_value = "2.0"
                    group = "3- Synch. mach. - Mec."
                }

                J {
                    label = "Jm"
                    widget = edit
                    type = generic
                    default_value = "42.9467"
                    unit = "kg.m²"
                    group = "3- Synch. mach. - Mec."
                }

                F {
                    label = "Friction coefficient"
                    widget = edit
                    type = generic
                    default_value = "0.572003113298"
                    unit = "Nms"
                    group = "3- Synch. mach. - Mec."
                }

                T1 {
                    label = "Electric control box time constant 1"
                    widget = edit
                    type = generic
                    default_value = "1.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T2 {
                    label = "Electric control box time constant 2"
                    widget = edit
                    type = generic
                    default_value = "1e-6"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T3 {
                    label = "Electric control box time constant 3"
                    widget = edit
                    type = generic
                    default_value = "0.5001"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                K {
                    label = "Actuator gain K"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    group = "4 - Gov. and Eng."
                }

                T4 {
                    label = "Actuator time constant 4"
                    widget = edit
                    type = generic
                    default_value = "25.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T5 {
                    label = "Actuator time constant 5"
                    widget = edit
                    type = generic
                    default_value = "9.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T6 {
                    label = "Actuator time constant 6"
                    widget = edit
                    type = generic
                    default_value = "5.74e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Pm0 {
                    label = "Initial mechanical power"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmax {
                    label = "Maximum torque limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmin {
                    label = "Minimum torque limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Td {
                    label = "Engine time delay"
                    widget = edit
                    type = generic
                    default_value = "24.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Tr {
                    label = "Time constant Tr"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                exc_Kp {
                    label = "Exciter PI proportional gain"
                    widget = edit
                    type = generic
                    default_value = "0.025"
                    group = "5 - Exciter"
                }

                exc_Ki {
                    label = "Exciter PI integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.007"
                    group = "5 - Exciter"
                }

                Ka {
                    label = "Major regulator gain Ka"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Ta {
                    label = "Major regulator time constant Ta"
                    widget = edit
                    type = generic
                    default_value = "2.0e-3"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vrmax {
                    label = "Saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vrmin {
                    label = "Saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Te {
                    label = "Exciter time constant Te"
                    widget = edit
                    type = generic
                    default_value = "1.0e-8"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Ke {
                    label = "Exciter gain Ke"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Kf {
                    label = "Stabilization feedback gain Kf"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "5 - Exciter"
                }

                Tf {
                    label = "Stabilization feedback time constant Tf"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vt0 {
                    label = "Initial terminal voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vf0 {
                    label = "Initial field voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmax {
                    label = "Exciter saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "[\'inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmin {
                    label = "Exciter saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "[\'-inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                delta_f {
                    label = "Synch Check - accepted frequency difference"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                delta_phi {
                    label = "Synch Check - Accepted phase difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                phase_Kp {
                    label = "Synck Check - Phase PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "6 - Adv. 1"
                }

                phase_Ki {
                    label = "Synch Check - Phase PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.00012"
                    group = "6 - Adv. 1"
                }

                phase_upLim {
                    label = "Synch Check - Phase PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "6 - Adv. 1"
                }

                phase_lowLim {
                    label = "Synch Check - Phase PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-0.1"
                    group = "6 - Adv. 1"
                }

                phaseOff {
                    label = "Synch Check - Phase calibration"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                dw_K {
                    label = "Synch Check - delta w gain"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "6 - Adv. 1"
                }

                V_Kp {
                    label = "Synck Check - Voltage PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.0071"
                    group = "6 - Adv. 1"
                }

                V_Ki {
                    label = "Synck Check - Voltage PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.0354"
                    group = "6 - Adv. 1"
                }

                V_upLim {
                    label = "Synck Check - Voltage PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "6 - Adv. 1"
                }

                V_lowLim {
                    label = "Synck Check - Voltage PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-1"
                    group = "6 - Adv. 1"
                }

                delta_V {
                    label = "Synck Check - Accepted voltage difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                w_sp_Kp {
                    label = "Frequency setpoint loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_Ki {
                    label = "Frequency setpoint loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_upLim {
                    label = "Frequency setpoint loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                w_sp_lowLim {
                    label = "Frequency setpoint loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                P_droop {
                    label = "Frequency setpoint loop - P droop"
                    widget = edit
                    type = generic
                    default_value = "2.7"
                    group = "7 - Adv. 2"
                }

                P_rise {
                    label = "Frequency setpoint loop - P rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                P_fall {
                    label = "Frequency setpoint loop - P falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_droop {
                    label = "Frequency setpoint loop - w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                w_rise {
                    label = "Frequency setpoint loop - w rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_fall {
                    label = "Frequency setpoint loop - w falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                gov_Kp {
                    label = "Governor - Proportional gain Kp"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    group = "7 - Adv. 2"
                }

                delta_wn {
                    label = "Governor - Accepted nominal speed difference"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    unit = "%"
                    group = "7 - Adv. 2"
                }

                inner_w_droop {
                    label = "Governor - inner w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                inner_w_rise {
                    label = "Governor - inner w rise"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                inner_w_fall {
                    label = "Governor - inner w fall"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                pf_Kp {
                    label = "Power factor loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.05"
                    group = "8 - Adv. 3"
                }

                pf_Ki {
                    label = "Power factor loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.075"
                    group = "8 - Adv. 3"
                }

                pf_upLim {
                    label = "Power factor loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_lowLim {
                    label = "Power factor loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                pf_rise {
                    label = "Power factor loop - pf rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_fall {
                    label = "Power factor loop - pf falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                exc_dwn {
                    label = "Exciter - start speed"
                    widget = edit
                    type = generic
                    default_value = "75"
                    unit = "%"
                    group = "8 - Adv. 3"
                }

                V_rise {
                    label = "Exciter - V rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_fall {
                    label = "Exciter - V falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_inner_droop {
                    label = "Exciter - V inner droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "8 - Adv. 3"
                }

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, 'diesel_genset.svg')
                ENDCODE

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                
                ENDCODE
            }
        }
        [
            position = 8848, 8288
            rotation = left
            size = 354, 240
        ]

        component Subsystem DG_in4 {
            layout = dynamic
            component "core/SCADA Input" pf_ref {
                execution_rate = "Ts"
                unit = ""
            }
            [
                position = 8120, 8112
            ]

            component "core/SCADA Input" Gen_OP_mode {
                def_value = "1"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8144
            ]

            component "core/SCADA Input" Gen_On {
                addr = "1427111952"
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 7992
            ]

            component "core/SCADA Input" Load_share {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8112, 8312
            ]

            component "core/SCADA Input" wref {
                addr = "1427111952"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8120, 8056
            ]

            component "core/Bus Join" "Bus Join2" {
                inputs = "9"
            }
            [
                position = 8272, 8392
                rotation = right
                hide_name = True
            ]

            component "core/SCADA Input" Vref {
                addr = "1427111940"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = "pu"
            }
            [
                position = 8160, 8016
            ]

            component "core/SCADA Input" Gen_Control_Mode {
                addr = "1427111944"
                execution_rate = "Ts"
                max = "2"
                min = "0"
                unit = ""
            }
            [
                position = 8120, 8200
            ]

            component "core/SCADA Input" Pref {
                addr = "1427111936"
                def_value = "1"
                execution_rate = "Ts"
                max = "1000000.0"
                min = "-1000000.0"
                unit = ""
            }
            [
                position = 8160, 8080
            ]

            component "core/SCADA Input" Load_share_on {
                execution_rate = "Ts"
                max = "1"
                min = "0"
                unit = ""
            }
            [
                position = 8160, 8256
            ]

            port inputs {
                position = right:1
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8272, 8464
                rotation = right
                hide_name = True
            ]

            connect "Bus Join2.out" inputs as Connection828
            connect Gen_Control_Mode.out "Bus Join2.in6" as Connection235
            connect Gen_OP_mode.out "Bus Join2.in5" as Connection565
            connect Gen_On.out "Bus Join2.in" as Connection230
            connect Load_share.out "Bus Join2.in8" as Connection826
            connect Load_share_on.out "Bus Join2.in7" as Connection825
            connect Pref.out "Bus Join2.in3" as Connection233
            connect Vref.out "Bus Join2.in1" as Connection231
            connect pf_ref.out "Bus Join2.in4" as Connection827
            connect wref.out "Bus Join2.in2" as Connection232

            Ts = "Ts"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Scada inputs for the Diesel Genset from the Microgrid Library.</p></body></html>"

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 7288, 7408
            rotation = right
            scale = -1, 1
            size = 48, 48
        ]

        component Subsystem Diesel_Gen3 {
            layout = static
            component "core/Signal Controlled Voltage Source" Vfd {
            }
            [
                position = 8672, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" If {
            }
            [
                position = 8736, 8240
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vfield {
            }
            [
                position = 8800, 8328
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Triple Pole Single Throw Contactor" MCB {
                ctrl_src = "Model"
            }
            [
                position = 9448, 8320
                scale = -1, 1
                size = 64, 256
            ]

            component "core/Three Phase Wound Rotor Synchronous Machine" Gen {
                Jm = "J"
                Llfd = "Llfd_prime"
                Llkd = "Llkd"
                Llkq = "Llkq"
                Lls = "Lls"
                Lmd = "Lmd"
                Lmq = "Lmq"
                Ns_div_Nfd = "Ns_Nfd"
                Ns_div_Nkd = "Ns_Nkd"
                Ns_div_Nkq = "Ns_Nkq"
                Rf = "Rf_prime"
                Rkd = "Rkd"
                Rkq = "Rkq"
                Rs = "Rs"
                el_torque_out_addr = "8200"
                el_trq_out = "True"
                execution_rate = "Ts"
                friction_coeff = "F"
                load_src = "Model"
                me_speed_out_addr = "8202"
                mech_speed_out = "True"
                pms = "pms"
                res_int_carr_f = "5000.0"
            }
            [
                position = 8984, 8320
                scale = -1, 1
                size = 176, 160
            ]

            component Subsystem Control {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "5"
                }
                [
                    position = 8456, 8192
                    rotation = left
                    hide_name = True
                ]

                component "core/Unit Delay" "Unit Delay2" {
                    execution_rate = "Ts"
                }
                [
                    position = 7920, 8104
                    hide_name = True
                ]

                component "core/Digital Probe" Exciter_on {
                }
                [
                    position = 7800, 7664
                    rotation = left
                ]

                component "core/Unit Delay" "Unit Delay1" {
                }
                [
                    position = 7208, 7696
                    hide_name = True
                ]

                component "core/Probe" Vf {
                    addr = "8978"
                    execution_rate = "Ts"
                }
                [
                    position = 8224, 7768
                    rotation = left
                ]

                component "core/Termination" Termination1 {
                }
                [
                    position = 7384, 8280
                    hide_name = True
                ]

                component "core/Digital Probe" StandBy {
                }
                [
                    position = 7416, 7888
                ]

                component "core/Digital Probe" GridForming {
                }
                [
                    position = 7416, 7952
                ]

                component "core/Unit Delay" "Unit Delay3" {
                    execution_rate = "Ts"
                }
                [
                    position = 8024, 7664
                    hide_name = True
                ]

                component "core/Round" Round1 {
                    round_fn = "round"
                }
                [
                    position = 7208, 7656
                    hide_name = True
                ]

                component "core/Bus Split" "Bus Split2" {
                    outputs = "3"
                }
                [
                    position = 6952, 7856
                    hide_name = True
                ]

                component "core/Digital Probe" GridFollowing {
                }
                [
                    position = 7504, 7928
                ]

                component "core/Bus Split" "Bus Split3" {
                    outputs = "9"
                }
                [
                    position = 6952, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" T {
                }
                [
                    position = 8128, 8184
                    rotation = left
                ]

                component "core/Digital Probe" Gen_On {
                }
                [
                    position = 7120, 8064
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "4"
                }
                [
                    position = 7296, 8104
                    rotation = right
                    hide_name = True
                ]

                component Subsystem check_steady_state_w {
                    layout = dynamic
                    component "core/Gain" speed_diff {
                        gain = "delta_wn/100.0"
                    }
                    [
                        position = 8232, 8208
                    ]

                    component "core/Abs" Abs1 {
                    }
                    [
                        position = 8280, 8160
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator3 {
                    }
                    [
                        position = 8360, 8200
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 8208, 8160
                        hide_name = True
                    ]

                    component "core/Constant" Constant3 {
                        execution_rate = "Ts"
                        value = "2.0*np.pi*f/pms"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    port ss_speed {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8424, 8200
                    ]

                    port w_meas {
                        position = left:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8096, 8152
                    ]

                    junction Junction9 sp
                    [
                        position = 8168, 8208
                    ]

                    connect Abs1.in Sum3.out as Connection5
                    connect Comparator3.in2 Abs1.out as Connection13
                    connect Comparator3.out ss_speed as Connection58
                    connect Constant3.out Junction9 as Connection16
                    connect Junction9 speed_diff.in as Connection39
                    connect Sum3.in1 Junction9 as Connection54
                    connect speed_diff.out Comparator3.in1 as Connection57
                    connect w_meas Sum3.in as Connection59
                }
                [
                    position = 7968, 8440
                    size = 96, 48
                ]

                component Subsystem Governor_and_Engine {
                    layout = dynamic
                    component "core/Signal switch" w_switch1 {
                    }
                    [
                        position = 7832, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum4 {
                        signs = "+--"
                    }
                    [
                        position = 7920, 8000
                        hide_name = True
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "inner_w_fall"
                        rising_limit = "inner_w_rise"
                    }
                    [
                        position = 7568, 7944
                        hide_name = True
                    ]

                    component "core/Probe" wmeas {
                        addr = "8977"
                    }
                    [
                        position = 7832, 8080
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 7352, 7960
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1/Sb"
                    }
                    [
                        position = 7576, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum5 {
                        signs = "3"
                    }
                    [
                        position = 7704, 7984
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7728, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 7496, 7944
                        hide_name = True
                    ]

                    component "core/Gain" "Tpu to T" {
                        execution_rate = "Ts"
                        gain = "-Sb*pms/(2*np.pi*f)"
                    }
                    [
                        position = 8200, 8000
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 7672, 8200
                        hide_name = True
                    ]

                    component "core/Probe" Inner_droop_dw {
                        addr = "8977"
                    }
                    [
                        position = 7936, 8080
                    ]

                    component "core/Probe" wref {
                        addr = "8977"
                    }
                    [
                        position = 7768, 7936
                        rotation = left
                    ]

                    component "core/Constant" Inner_w_droop {
                        execution_rate = "Ts"
                        value = "inner_w_droop"
                    }
                    [
                        position = 7528, 8232
                    ]

                    component Subsystem DEGOV {
                        layout = dynamic
                        component "core/Gain" Kp {
                            gain = "gov_Kp"
                        }
                        [
                            position = 8040, 8160
                        ]

                        component "core/Gain" K {
                            gain = "K"
                        }
                        [
                            position = 8112, 8160
                        ]

                        component "core/Transport Delay" "Transport Delay1" {
                            init_value = "Pm0"
                            time_delay = "Td"
                        }
                        [
                            position = 8392, 8160
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[T5*T6,T5+T6,1]"
                            b_coeff = "[T4,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8176, 8160
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[T1*T2,T1,1]"
                            b_coeff = "[T3,1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7960, 8160
                        ]

                        component Subsystem Integrator {
                            layout = dynamic
                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8304
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Tmin"
                                upper_limit = "Tmax"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8216
                                hide_name = True
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "Pm0"
                                limit_lower = "phase_lowLim"
                                limit_upper = "phase_upLim"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                                gain = "1000"
                            }
                            [
                                position = 8216, 8304
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8256
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7968, 8208
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 8368, 8224
                            ]

                            connect In Sum7.in as Connection58
                            connect Integrator1.reset Reset as Connection2
                            connect Junction3 Out as Connection48
                            connect Junction4 Integrator1.out as Connection65
                            connect Junction4 Sum6.in as Connection56
                            connect Kb.in Sum6.out as Connection50
                            connect Limit1.out Junction3 as Connection66
                            connect Limit1.in Junction4 as Connection55
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8264, 8160
                            size = 64, 48
                        ]

                        port T {
                            label = "T"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8488, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8208, 8104
                        ]

                        port w_bias {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7832, 8160
                        ]

                        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Engine</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8368, 8192
                        ]

                        comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Actuator:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">          K (1 + sT4)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">   s(1 + sT5)(1 + sT6)</span></p></body></html> ENDCOMMENT 
                        [
                            position = 8128, 8208
                        ]

                        comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Electric Control Box:</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">           (1 + sT3)</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">----------------------------------</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">  1 + sT1 + (s^2)T1T2</span></p></body></html> ENDCOMMENT 
                        [
                            position = 7872, 8208
                        ]

                        connect Integrator.In TF2.out as Connection31
                        connect Integrator.Out "Transport Delay1.in" as Connection32
                        connect Kp.out K.in as Connection35
                        connect TF1.out Kp.in as Connection36
                        connect TF2.in K.out as Connection27
                        connect "Transport Delay1.out" T as Connection28
                        connect reset Integrator.Reset as Connection33
                        connect w_bias TF1.in as Connection34
                    }
                    [
                        position = 8072, 8000
                        size = 120, 64
                    ]

                    port w_meas_in {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7656, 8080
                        rotation = down
                        scale = -1, 1
                    ]

                    port T_out {
                        label = "T_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8264, 8000
                    ]

                    port "Gen On" {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7448, 7872
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_meas {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7504, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_bias {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7592, 7984
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7784, 8160
                        rotation = down
                        scale = -1, 1
                    ]

                    port dw_synch {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7632, 8000
                    ]

                    port w_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7432, 7928
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7752, 8232
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7440, 7984
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction9 sp
                    [
                        position = 7496, 7872
                    ]

                    junction Junction10 sp
                    [
                        position = 7768, 7984
                    ]

                    junction Junction12 sp
                    [
                        position = 7392, 7960
                    ]

                    junction Junction13 sp
                    [
                        position = 7784, 8080
                    ]

                    junction Junction14 sp
                    [
                        position = 7880, 8080
                    ]

                    connect DEGOV.T "Tpu to T.in" as Connection720
                    connect From1 w_switch1.in1 as Connection695
                    connect GCB_status w_switch1.in2 as Connection691
                    connect "Gen On" Junction9 as Connection678
                    connect Inner_w_droop.out Product1.in1 as Connection764
                    connect Junction10 Sum4.in as Connection684
                    connect Junction12 Goto1 as Connection699
                    connect Junction12 w_switch.in1 as Connection693
                    connect Junction13 wmeas.in as Connection755
                    connect Junction14 Inner_droop_dw.in as Connection758
                    connect Junction9 DEGOV.reset as Connection679
                    connect Product1.in to_pu.out as Connection618
                    connect Product1.out w_switch1.in as Connection712
                    connect Sum4.out DEGOV.w_bias as Connection742
                    connect Sum4.in1 Junction13 as Connection756
                    connect Sum4.in2 Junction14 as Connection759
                    connect Sum5.out Junction10 as Connection683
                    connect "Tpu to T.out" T_out as Connection30
                    connect dw_synch Sum5.in2 as Connection701
                    connect to_pu.in P_meas as Connection619
                    connect "w to wpu.out" Junction13 as Connection754
                    connect "w to wpu.in" w_meas_in as Connection166
                    connect w_bias Sum5.in1 as Connection700
                    connect w_ramp.out Sum5.in as Connection762
                    connect w_ramp.in w_switch.out as Connection761
                    connect w_ref w_switch.in as Connection763
                    connect w_switch.in2 Junction9 as Connection680
                    connect w_switch1.out Junction14 as Connection757
                    connect wref.in Junction10 as Connection685
                    connect zero.out Junction12 as Connection692
                }
                [
                    position = 8016, 8232
                    size = 184, 208
                ]

                component Subsystem Read_Control_mode {
                    layout = dynamic
                    component "core/Digital Probe" PV_mode {
                    }
                    [
                        position = 8264, 8192
                    ]

                    component "core/C function" State {
                        init_fnc = "/*Begin code section*/
Vf = 0;
PV = 0;
PQ = 0;
/*End code section*/"
                        input_terminals = "real enable;inherit P;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;False;"
                        output_fnc = "/*Begin code section*/
if(enable && P && Q){
    Vf = 0;
    PV = 0;
    PQ = 1;
}
else{
    if(enable && P){
        Vf = 0;
        PV = 1;
        PQ = 0;
    }
    else{
        Vf = 1;
        PV = 0;
        PQ = 0;
    }
}
/*End code section*/"
                        output_terminals = "real Vf;inherit PV;inherit PQ;"
                        output_terminals_dimensions = "inherit;inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;False;"
                    }
                    [
                        position = 8144, 8192
                        size = 56, 168
                    ]

                    component "core/Digital Probe" Vf_mode {
                    }
                    [
                        position = 8264, 8128
                    ]

                    component "core/Digital Probe" PQ_mode {
                    }
                    [
                        position = 8264, 8256
                    ]

                    port Enable_outer_loop {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8128
                    ]

                    port P_control_mode {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8192
                    ]

                    port Q_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7992, 8256
                    ]

                    connect Enable_outer_loop State.enable as Connection1
                    connect PV_mode.in State.PV as Connection4
                    connect State.PQ PQ_mode.in as Connection6
                    connect State.P P_control_mode as Connection2
                    connect State.Q Q_control_mode as Connection3
                    connect State.Vf Vf_mode.in as Connection5
                }
                [
                    position = 7728, 8448
                    size = 96, 96
                ]

                component Subsystem Start_Exciter {
                    layout = dynamic
                    component "core/Gain" Exciter_start_speed {
                        gain = "exc_dwn/100.0"
                    }
                    [
                        position = 8152, 8248
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8312, 8144
                        hide_name = True
                    ]

                    component "core/Constant" steadyState_w {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8032, 8248
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1.0/(2*np.pi*f/pms)"
                    }
                    [
                        position = 8152, 8192
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8224, 8200
                        hide_name = True
                    ]

                    port w_meas {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8192
                    ]

                    port Gen_On {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8032, 8136
                    ]

                    port Start {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8144
                    ]

                    connect Comparator1.out and.in1 as Connection73
                    connect Comparator1.in1 "w to wpu.out" as Connection2
                    connect Exciter_start_speed.out Comparator1.in2 as Connection5
                    connect and.in Gen_On as Connection74
                    connect and.out Start as Connection76
                    connect steadyState_w.out Exciter_start_speed.in as Connection56
                    connect "w to wpu.in" w_meas as Connection75
                }
                [
                    position = 7704, 7704
                    size = 104, 64
                ]

                component Subsystem Exciter {
                    layout = dynamic
                    component "core/Gain" one_ov_sqrt_3 {
                        execution_rate = "Ts"
                        gain = "1.0/(3.0**0.5)"
                    }
                    [
                        position = 8032, 8432
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" Vt_to_Vtpu {
                        execution_rate = "Ts"
                        gain = "1.0/(Vn*((2.0/3.0)**0.5))"
                    }
                    [
                        position = 8304, 8248
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8568, 8200
                        hide_name = True
                    ]

                    component "core/Gain" to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 8032, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum2 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8184, 8208
                        hide_name = True
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                        value = "1.0"
                    }
                    [
                        position = 8448, 8104
                    ]

                    component "core/Gain" Vfpu_to_Vf {
                        execution_rate = "Ts"
                        gain = "Vn*((2.0/3.0)**0.5)/Ns_Nfd"
                    }
                    [
                        position = 8648, 8200
                    ]

                    component "core/Sum" Sum1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8264, 8104
                        hide_name = True
                    ]

                    component "core/Probe" Vt {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8304
                        rotation = right
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8112, 8272
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Constant" Zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 7680, 8168
                        hide_name = True
                    ]

                    component "core/Probe" V_ref {
                        addr = "8978"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8072, 8160
                        rotation = left
                    ]

                    component "core/Signal switch" switch {
                    }
                    [
                        position = 7752, 8184
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" Vpss {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8176, 8128
                    ]

                    component "core/Sum" Sum {
                        execution_rate = "Ts"
                        signs = "3"
                    }
                    [
                        position = 8016, 8200
                        hide_name = True
                    ]

                    component "core/Constant" Const {
                        execution_rate = "Ts"
                        value = "Vf0/Ka"
                    }
                    [
                        position = 8176, 8072
                    ]

                    component "core/Constant" V_inner_droop {
                        execution_rate = "Ts"
                        value = "V_inner_droop"
                    }
                    [
                        position = 7928, 8432
                    ]

                    component "core/Rate Limiter" "Rate Limit" {
                        falling_limit = "V_fall"
                        rising_limit = "V_rise"
                    }
                    [
                        position = 7816, 8184
                        hide_name = True
                    ]

                    component Subsystem DC4B {
                        layout = dynamic
                        component "core/Signal switch" switch {
                        }
                        [
                            position = 8000, 8256
                            hide_name = True
                            scale = 1, -1
                        ]

                        component "core/Product" Product1 {
                        }
                        [
                            position = 8200, 8160
                            hide_name = True
                        ]

                        component "core/Gain" Kf {
                            gain = "Kf"
                        }
                        [
                            position = 8424, 8032
                            scale = -1, 1
                        ]

                        component "core/Discrete Transfer Function" TF4 {
                            a_coeff = "[Tf,1]"
                            b_coeff = "[1,0]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8032
                            scale = -1, 1
                        ]

                        component "core/Gain" KA {
                            gain = "Ka"
                        }
                        [
                            position = 8304, 8160
                        ]

                        component "core/Sum" Sum2 {
                            signs = "-+"
                        }
                        [
                            position = 8000, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" TF3 {
                            a_coeff = "[Te,Ke]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8552, 8168
                        ]

                        component "core/Constant" One {
                            execution_rate = "Ts"
                        }
                        [
                            position = 7872, 8272
                        ]

                        component "core/Discrete Transfer Function" TF2 {
                            a_coeff = "[Ta,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 8160
                        ]

                        component "core/C function" "Variable Limit" {
                            init_fnc = "/*Begin code section*/
LimitChange = 0;
out = 0;
/*End code section*/"
                            input_terminals = "inherit in;inherit LimitChange;"
                            input_terminals_dimensions = "inherit;inherit"
                            input_terminals_feedthrough = "[u\'\']"
                            input_terminals_show_labels = "True;True;"
                            output_fnc = "/*Begin code section*/
if(LimitChange == 0.0){
    LimitChange = 0.01;
}

if(in>=Vrmax*LimitChange){
    out = Vrmax*LimitChange;
}
else{
    if(in<=Vrmin*LimitChange){
        out = Vrmin*LimitChange;
    }
    else{
        out = in;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[u\'\']"
                            output_terminals_show_labels = "True;"
                            parameters = "real Vrmax;real Vrmin;"
                        }
                        [
                            position = 8464, 8168
                            size = 0, 0
                        ]

                        component "core/Discrete Transfer Function" TF1 {
                            a_coeff = "[Tr,1]"
                            b_coeff = "[1]"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7768, 8216
                        ]

                        component "core/Sum" Sum1 {
                            signs = "++-"
                        }
                        [
                            position = 7896, 8160
                            hide_name = True
                        ]

                        component "core/Probe" Va {
                        }
                        [
                            position = 8288, 8096
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8088, 8224
                                hide_name = True
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8320, 8312
                                hide_name = True
                                scale = -1, 1
                            ]

                            component "core/Integrator" Integrator1 {
                                limit_lower = "[\'-inf\']"
                                limit_upper = "[\'inf\']"
                                show_reset = "either"
                            }
                            [
                                position = 8216, 8232
                                hide_name = True
                            ]

                            component "core/Gain" Kp {
                                gain = "exc_Kp"
                            }
                            [
                                position = 7992, 8152
                            ]

                            component "core/Gain" Ki {
                                gain = "exc_Ki"
                            }
                            [
                                position = 7992, 8216
                            ]

                            component "core/Sum" Sum5 {
                            }
                            [
                                position = 8320, 8224
                                hide_name = True
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "Vrmin/Ka"
                                upper_limit = "Vrmax/Ka"
                            }
                            [
                                position = 8408, 8224
                                hide_name = True
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8216, 8312
                                scale = -1, 1
                            ]

                            port Reset {
                                label = "Reset"
                                position = top:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8144, 8264
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7824, 8184
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8472, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8368, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8440, 8224
                            ]

                            junction Junction4 sp
                            [
                                position = 7928, 8184
                            ]

                            connect Integrator1.reset Reset as Connection2
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction4 In as Connection57
                            connect Kb.in Sum6.out as Connection50
                            connect Ki.in Junction4 as Connection56
                            connect Ki.out Sum7.in as Connection54
                            connect Kp.in Junction4 as Connection58
                            connect Kp.out Sum5.in as Connection59
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.in1 Integrator1.out as Connection5
                            connect Sum5.out Junction2 as Connection44
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                        }
                        [
                            position = 8104, 8152
                            size = 64, 48
                        ]

                        port Vfd {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8672, 8168
                        ]

                        port Vref {
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8160
                        ]

                        port reset {
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8048, 8088
                        ]

                        port Vpss {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8104
                        ]

                        port Vt {
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7696, 8216
                        ]

                        port Linearize {
                            position = top:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8320
                        ]

                        junction Junction6 sp
                        [
                            position = 8248, 8160
                        ]

                        junction Junction10 sp
                        [
                            position = 8160, 8256
                        ]

                        junction Junction13 sp
                        [
                            position = 7816, 8216
                        ]

                        junction Junction14 sp
                        [
                            position = 8608, 8168
                        ]

                        connect Junction10 Product1.in1 as Connection102
                        connect Junction13 Sum1.in2 as Connection114
                        connect Junction14 Vfd as Connection126
                        connect Junction6 KA.in as Connection77
                        connect Kf.in Junction14 as Connection128
                        connect Linearize switch.in2 as Connection74
                        connect One.out switch.in as Connection75
                        connect PI.In Sum2.out as Connection48
                        connect Product1.out Junction6 as Connection76
                        connect Product1.in PI.Out as Connection49
                        connect Sum2.in1 Sum1.out as Connection5
                        connect TF1.out Junction13 as Connection113
                        connect TF2.in KA.out as Connection10
                        connect TF3.out Junction14 as Connection125
                        connect TF3.in "Variable Limit.out" as Connection118
                        connect TF4.in Kf.out as Connection127
                        connect TF4.out Sum2.in as Connection123
                        connect Va.in Junction6 as Connection78
                        connect "Variable Limit.LimitChange" Junction10 as Connection103
                        connect "Variable Limit.in" TF2.out as Connection89
                        connect Vpss Sum1.in as Connection45
                        connect Vref Sum1.in1 as Connection46
                        connect Vt TF1.in as Connection112
                        connect reset PI.Reset as Connection117
                        connect switch.out Junction10 as Connection101
                        connect switch.in1 Junction13 as Connection115

                        Ka = "Ka"
                        Ke = "Ke"
                        Kf = "Kf"
                        Ta = "Ta"
                        Te = "Te"
                        Tf = "Tf"
                        Tr = "Tr"
                        Vf0 = "Vf0"
                        Vfmax = "Efmax"
                        Vfmin = "Efmin"
                        Vrmax = "Vrmax"
                        Vrmin = "Vrmin"
                        exc_Ki = "exc_Ki"
                        exc_Kp = "exc_Kp"

                        mask {
                            description = "IEEE DC1A exciter model."

                            Tr {
                                label = "Time constant Tr"
                                widget = edit
                                type = generic
                                default_value = "2e-6"
                                group = "General"
                            }

                            exc_Kp {
                                label = "Exciter PI proportional gain"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            exc_Ki {
                                label = "Exciter PI integral gain"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Ka {
                                label = "Major regulator gain Ka"
                                widget = edit
                                type = generic
                                default_value = "200"
                                group = "General"
                            }

                            Ta {
                                label = "Major regulator time constant  Ta"
                                widget = edit
                                type = generic
                                default_value = "2e-3"
                                group = "General"
                            }

                            Vrmax {
                                label = "Saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                group = "General"
                            }

                            Vrmin {
                                label = "Saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                group = "General"
                            }

                            Te {
                                label = "Exciter time constant Te"
                                widget = edit
                                type = generic
                                default_value = "1e-8"
                                group = "General"
                            }

                            Ke {
                                label = "Exciter gain Ke"
                                widget = edit
                                type = generic
                                default_value = "1"
                                group = "General"
                            }

                            Kf {
                                label = "Stabilization feedback gain Kf"
                                widget = edit
                                type = generic
                                default_value = "0.0"
                                group = "General"
                            }

                            Tf {
                                label = "Stabilization feedback time constant Tf"
                                widget = edit
                                type = generic
                                default_value = "1.0e-12"
                                group = "General"
                            }

                            Vf0 {
                                label = "Initial field voltage"
                                widget = edit
                                type = generic
                                default_value = "0"
                                group = "General"
                            }

                            Vfmax {
                                label = "Exciter saturation upper limit"
                                widget = edit
                                type = generic
                                default_value = "[\'inf\']"
                                group = "General"
                            }

                            Vfmin {
                                label = "Exciter saturation lower limit"
                                widget = edit
                                type = generic
                                default_value = "[\'-inf\']"
                                group = "General"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                                group = "General"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8448, 8208
                        size = 112, 120
                    ]

                    port Delta_V_in {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8200
                    ]

                    port Vf_out {
                        label = "Vf_out"
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8200
                    ]

                    port Vt_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 8248
                    ]

                    port Vref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8200
                    ]

                    port dV {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7944, 8216
                    ]

                    port Start {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7696, 8256
                    ]

                    port GCB_status {
                        position = top:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8336
                        rotation = down
                        scale = -1, 1
                    ]

                    port Q_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7928, 8384
                        rotation = down
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8072
                        hide_name = True
                        size = 60, 20
                    ]

                    tag Goto1 {
                        value = "start"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7816, 8256
                        hide_name = True
                        size = 60, 20
                    ]

                    junction Junction112 sp
                    [
                        position = 7752, 8256
                    ]

                    junction Junction116 sp
                    [
                        position = 8072, 8200
                    ]

                    junction Junction117 sp
                    [
                        position = 8416, 8072
                    ]

                    junction Junction118 sp
                    [
                        position = 8360, 8248
                    ]

                    connect Const.out Sum1.in as Connection3
                    connect DC4B.reset Junction117 as Connection743
                    connect DC4B.Vt Junction118 as Connection748
                    connect DC4B.Vfd Product1.in1 as Connection739
                    connect DC4B.Vref Sum2.out as Connection745
                    connect GCB_status Product2.in as Connection709
                    connect Goto1 Junction112 as Connection121
                    connect Junction112 switch.in2 as Connection120
                    connect Junction116 Sum.out as Connection720
                    connect Junction117 From1 as Connection742
                    connect Junction118 Vt.in as Connection747
                    connect One.out DC4B.Linearize as Connection740
                    connect Product1.in Junction117 as Connection741
                    connect Product2.out Sum2.in1 as Connection717
                    connect Product2.in1 to_pu.out as Connection710
                    connect "Rate Limit.out" Sum.in as Connection59
                    connect "Rate Limit.in" switch.out as Connection58
                    connect Start Junction112 as Connection119
                    connect Sum.in1 Delta_V_in as Connection25
                    connect Sum1.out DC4B.Vpss as Connection744
                    connect Sum2.in Junction116 as Connection721
                    connect V_inner_droop.out one_ov_sqrt_3.in as Connection749
                    connect V_ref.in Junction116 as Connection719
                    connect Vf_out Vfpu_to_Vf.out as Connection126
                    connect Vfpu_to_Vf.in Product1.out as Connection125
                    connect Vpss.out Sum1.in1 as Connection32
                    connect Vref switch.in as Connection87
                    connect Vt_to_Vtpu.out Junction118 as Connection746
                    connect Vt_to_Vtpu.in Vt_in as Connection36
                    connect Zero.out switch.in1 as Connection45
                    connect dV Sum.in2 as Connection88
                    connect one_ov_sqrt_3.out Product2.in2 as Connection724
                    connect to_pu.in Q_meas as Connection619
                }
                [
                    position = 8088, 7816
                    size = 192, 200
                ]

                component Subsystem "pf Control" {
                    layout = dynamic
                    component "core/Signal switch" "Signal switch2" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7872, 8192
                        hide_name = True
                    ]

                    component "core/Probe" delta_V {
                        addr = "8972"
                        execution_rate = "Ts"
                    }
                    [
                        position = 8392, 8160
                    ]

                    component "core/Probe" pf_r {
                    }
                    [
                        position = 7808, 8208
                    ]

                    component "core/C function" norm_pf_ref {
                        global_variables = "real u;"
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
/*End code section*/"
                        input_terminals = "real pf;inherit P;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(P>=0){
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(pf>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7712, 8176
                        size = 48, 48
                    ]

                    component "core/Probe" pf_m {
                    }
                    [
                        position = 7912, 8304
                    ]

                    component "core/Logical operator" "Logical operator5" {
                        inputs = "4"
                    }
                    [
                        position = 7904, 8016
                        rotation = right
                        hide_name = True
                    ]

                    component "core/C function" norm_pf_meas {
                        init_fnc = "/*Begin code section*/
pf = 1.0;
pf_norm = 1.0;
Q = 0.0;
/*End code section*/"
                        input_terminals = "real pf;inherit Q;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(pf>=0){
    if(Q>=0){
        pf_norm = 2-pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = pf; // normalized pf ranges from 0 to 1
    }
}
else{
    if(Q>=0){
        pf_norm = 2+pf; // normalized pf ranges from 1 to 2
    }
    else{
        pf_norm = -pf; // normalized pf ranges from  0 to 1
    }
}
/*End code section*/"
                        output_terminals = "real pf_norm;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[u\'\']"
                    }
                    [
                        position = 7760, 8304
                        size = 48, 48
                    ]

                    component "core/Rate Limiter" "Rate Limiter1" {
                        falling_limit = "pf_fall"
                        rising_limit = "pf_rise"
                    }
                    [
                        position = 7936, 8192
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "0.1/Sb"
                    }
                    [
                        position = 7720, 7992
                        hide_name = True
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7824, 7944
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch4" {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8304, 8216
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "+-"
                    }
                    [
                        position = 8032, 8200
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "[0]"
                    }
                    [
                        position = 8240, 8232
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Ki {
                            gain = "pf_Ki"
                        }
                        [
                            position = 7992, 8216
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "pf_lowLim"
                            upper_limit = "pf_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "pf_Kp"
                        }
                        [
                            position = 7992, 8136
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7824, 8176
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7920, 8176
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection60
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection61
                        connect Kp.in Junction4 as Connection59
                        connect Kp.out Sum5.in as Connection57
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                        connect Sum7.in Ki.out as Connection54
                    }
                    [
                        position = 8144, 8200
                        size = 64, 48
                    ]

                    port Q_meas_in {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8344
                    ]

                    port Q_control_mode {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7792, 7840
                    ]

                    port enable {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7832, 7800
                    ]

                    port dV_out {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8392, 8216
                    ]

                    port P_control_mode {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7880
                    ]

                    port pf_ref {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8128
                    ]

                    port pf_meas {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7640, 8280
                    ]

                    port Pref {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7720, 7936
                    ]

                    port P_meas {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7616, 8184
                    ]

                    port Q_active {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8000
                    ]

                    tag Goto1 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8072, 8064
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "Q_mode"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7808, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction75 sp
                    [
                        position = 8344, 8216
                    ]

                    junction Junction81 sp
                    [
                        position = 7872, 8120
                    ]

                    junction Junction84 sp
                    [
                        position = 8144, 8120
                    ]

                    junction Junction85 sp
                    [
                        position = 7840, 8248
                    ]

                    junction Junction86 sp
                    [
                        position = 7840, 8304
                    ]

                    junction Junction87 sp
                    [
                        position = 7768, 8176
                    ]

                    junction Junction88 sp
                    [
                        position = 7984, 8064
                    ]

                    connect Constant1.out greater_equal.in1 as Connection125
                    connect From2 Junction81 as Connection52
                    connect Goto1 Junction88 as Connection128
                    connect Junction75 dV_out as Connection2
                    connect Junction81 Junction84 as Connection79
                    connect Junction81 "Signal switch2.in2" as Connection53
                    connect Junction84 "Signal switch4.in2" as Connection80
                    connect Junction85 "Signal switch2.in1" as Connection99
                    connect Junction86 Junction85 as Connection102
                    connect Junction87 "Signal switch2.in" as Connection108
                    connect Junction88 "Logical operator5.out" as Connection129
                    connect PI.Reset Junction84 as Connection81
                    connect PI.Out "Signal switch4.in" as Connection77
                    connect P_control_mode "Logical operator5.in2" as Connection84
                    connect P_meas norm_pf_ref.P as Connection127
                    connect Q_active Junction88 as Connection130
                    connect Q_control_mode "Logical operator5.in1" as Connection135
                    connect Q_meas_in norm_pf_meas.Q as Connection96
                    connect "Rate Limiter1.out" Sum6.in as Connection134
                    connect "Signal switch2.out" "Rate Limiter1.in" as Connection133
                    connect "Signal switch4.out" Junction75 as Connection17
                    connect Sum6.in1 Junction85 as Connection98
                    connect Sum6.out PI.In as Connection123
                    connect delta_V.in Junction75 as Connection20
                    connect enable "Logical operator5.in" as Connection136
                    connect greater_equal.out "Logical operator5.in3" as Connection126
                    connect greater_equal.in Pref as Connection124
                    connect norm_pf_meas.pf_norm Junction86 as Connection101
                    connect norm_pf_ref.pf_norm Junction87 as Connection107
                    connect norm_pf_ref.pf pf_ref as Connection132
                    connect pf_m.in Junction86 as Connection103
                    connect pf_meas norm_pf_meas.pf as Connection104
                    connect pf_r.in Junction87 as Connection109
                    connect zero1.out "Signal switch4.in1" as Connection75
                }
                [
                    position = 7736, 7912
                    size = 144, 272
                ]

                component Subsystem Output {
                    layout = dynamic

                    port w_meas {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8216
                    ]

                    port Gen_On {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "Gen_On"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto8 {
                        value = "w_meas"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8216
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Gen_On Goto7 as Connection632
                    connect Goto8 w_meas as Connection631
                }
                [
                    position = 8448, 8416
                    size = 56, 72
                ]

                component Subsystem Freq_setpoint_control {
                    layout = dynamic
                    component "core/Gain" P_3ph_to_pu {
                        execution_rate = "Ts"
                        gain = "1.0/Sb"
                    }
                    [
                        position = 7960, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Constant" P_Droop {
                        execution_rate = "Ts"
                        value = "P_droop"
                    }
                    [
                        position = 7864, 7864
                    ]

                    component "core/Sum" Sum5 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8168, 7944
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Constant" w_Droop {
                        execution_rate = "Ts"
                        value = "w_droop"
                    }
                    [
                        position = 8120, 8296
                    ]

                    component "core/Sum" Sum3 {
                        signs = "+-"
                    }
                    [
                        position = 9184, 8352
                    ]

                    component "core/Signal switch" load_share_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8888, 8232
                        hide_name = True
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8208, 8344
                        hide_name = True
                    ]

                    component "core/Probe" w_Psp {
                    }
                    [
                        position = 8360, 7904
                        rotation = left
                    ]

                    component "core/Signal switch" w_switch {
                    }
                    [
                        position = 8400, 8512
                        hide_name = True
                    ]

                    component "core/Constant" zero1 {
                        execution_rate = "Ts"
                        value = "0.0"
                    }
                    [
                        position = 8280, 8528
                        hide_name = True
                    ]

                    component "core/Probe" w_Pm {
                    }
                    [
                        position = 8360, 8016
                        rotation = left
                    ]

                    component "core/Signal switch" mode_switch1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 9408, 8368
                        hide_name = True
                    ]

                    component "core/Product" Product3 {
                        signs = "3"
                    }
                    [
                        position = 8152, 8056
                        hide_name = True
                    ]

                    component "core/Signal switch" mode_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8776, 8352
                        hide_name = True
                    ]

                    component "core/Limit" P_limit {
                        lower_limit = "0.0"
                        upper_limit = "1.0/1.25"
                    }
                    [
                        position = 7872, 7936
                        hide_name = True
                    ]

                    component "core/Sum" Sum8 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8608, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" f_droop_switch {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8360, 8360
                        hide_name = True
                    ]

                    component "core/Probe" delta_w {
                        addr = "8975"
                        execution_rate = "Ts"
                    }
                    [
                        position = 9056, 8288
                        rotation = left
                    ]

                    component "core/Product" Product2 {
                        signs = "3"
                    }
                    [
                        position = 8032, 7936
                        hide_name = True
                    ]

                    component "core/Gain" "w to wpu" {
                        execution_rate = "Ts"
                        gain = "1/(2*np.pi*f/pms)"
                    }
                    [
                        position = 7880, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    component "core/Sum" Sum7 {
                    }
                    [
                        position = 8976, 8344
                        hide_name = True
                    ]

                    component "core/Sum" Sum6 {
                        execution_rate = "Ts"
                        signs = "-+"
                    }
                    [
                        position = 8616, 7952
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Probe" w_sp {
                    }
                    [
                        position = 8712, 7992
                    ]

                    component "core/Rate Limiter" w_ramp {
                        falling_limit = "w_fall"
                        rising_limit = "w_rise"
                    }
                    [
                        position = 8472, 8512
                        hide_name = True
                    ]

                    component "core/Rate Limiter" P_ramp {
                        falling_limit = "P_fall"
                        rising_limit = "P_rise"
                    }
                    [
                        position = 7936, 7936
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                            hide_name = True
                        ]

                        component "core/Gain" Kp {
                            gain = "w_sp_Kp"
                        }
                        [
                            position = 8008, 8152
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "[\'-inf\']"
                            limit_upper = "[\'inf\']"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                            hide_name = True
                        ]

                        component "core/Gain" Ki {
                            gain = "w_sp_Ki"
                        }
                        [
                            position = 8008, 8216
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                            hide_name = True
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "w_sp_lowLim"
                            upper_limit = "w_sp_upLim"
                        }
                        [
                            position = 8408, 8224
                            hide_name = True
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7872, 8184
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7928, 8184
                        ]

                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 In as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.in Junction4 as Connection57
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 9296, 8352
                        size = 64, 48
                    ]

                    port Pmeas_in {
                        position = left:15
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7864, 8352
                        rotation = down
                        scale = -1, 1
                    ]

                    port P_ref {
                        position = left:12
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 7936
                    ]

                    port enable {
                        position = left:13
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8312, 8280
                    ]

                    port w_meas {
                        position = left:14
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7808, 8016
                        rotation = down
                        scale = -1, 1
                    ]

                    port w_ref {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8320, 8496
                        rotation = down
                        scale = -1, 1
                    ]

                    port Load_Share {
                        position = left:18
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8800, 8200
                    ]

                    port w_bias {
                        position = auto:auto
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 9480, 8368
                    ]

                    port Load_Share_on {
                        position = left:17
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8824, 8136
                    ]

                    port P_mode {
                        position = left:16
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8712, 8288
                    ]

                    tag Goto2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8416, 8568
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From5 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9216, 8272
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From2 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8280, 8376
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From4 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9096, 8360
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto4 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8440, 8280
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8064, 7864
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto3 {
                        value = "w_meas"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7968, 8040
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From7 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 9320, 8416
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From1 {
                        value = "P_droop"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8064, 8056
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From6 {
                        value = "enable"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8344, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From3 {
                        value = "zero"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8800, 8248
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction4 sp
                    [
                        position = 8072, 8016
                    ]

                    junction Junction6 sp
                    [
                        position = 8056, 8352
                    ]

                    junction Junction7 sp
                    [
                        position = 8344, 8528
                    ]

                    junction Junction8 sp
                    [
                        position = 7992, 8016
                    ]

                    junction Junction9 sp
                    [
                        position = 8360, 7944
                    ]

                    junction Junction10 sp
                    [
                        position = 8360, 8056
                    ]

                    junction Junction11 sp
                    [
                        position = 8656, 7992
                    ]

                    junction Junction12 sp
                    [
                        position = 9056, 8344
                    ]

                    junction Junction13 sp
                    [
                        position = 7920, 8016
                    ]

                    junction Junction14 sp
                    [
                        position = 8360, 8280
                    ]

                    junction Junction15 sp
                    [
                        position = 9296, 8272
                    ]

                    junction Junction16 sp
                    [
                        position = 7992, 7864
                    ]

                    comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8384, 8328
                    ]

                    comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_P_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8208, 7912
                    ]

                    comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8640, 8376
                    ]

                    comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8512, 8384
                    ]

                    comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Power setpoint loop</span></p></body></html> ENDCOMMENT 
                    [
                        position = 7904, 7816
                    ]

                    comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w''_sp</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8656, 8056
                        rotation = right
                    ]

                    comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Frequency setpoint loop</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">w'_sp = f_rated*Droop*Ppu</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt;"><br /></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">Ppu = Pmeas/Prated</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:10pt;">f_rated = 1pu</span></p></body></html> ENDCOMMENT 
                    [
                        position = 8008, 8392
                    ]

                    connect From1 Product3.in1 as Connection631
                    connect From2 f_droop_switch.in1 as Connection655
                    connect From3 load_share_switch.in1 as Connection656
                    connect From5 Junction15 as Connection714
                    connect From6 w_switch.in2 as Connection711
                    connect From7 mode_switch1.in1 as Connection717
                    connect Goto2 Junction7 as Connection654
                    connect Goto3 Junction13 as Connection698
                    connect Goto4 Junction14 as Connection710
                    connect Junction10 Sum6.in as Connection682
                    connect Junction11 Sum6.out as Connection685
                    connect Junction12 Sum7.out as Connection693
                    connect Junction13 Junction8 as Connection697
                    connect Junction14 f_droop_switch.in2 as Connection709
                    connect Junction15 PI.Reset as Connection715
                    connect Junction16 Goto1 as Connection725
                    connect Junction4 Junction8 as Connection674
                    connect Junction6 Product1.in1 as Connection648
                    connect Junction7 w_switch.in1 as Connection653
                    connect Junction8 Product2.in2 as Connection675
                    connect Junction9 Sum5.out as Connection679
                    connect Load_Share load_share_switch.in as Connection659
                    connect Load_Share_on load_share_switch.in2 as Connection718
                    connect P_3ph_to_pu.out Junction6 as Connection647
                    connect P_Droop.out Junction16 as Connection726
                    connect P_limit.in P_ref as Connection721
                    connect P_mode mode_switch.in2 as Connection719
                    connect P_ramp.in P_limit.out as Connection720
                    connect Pmeas_in P_3ph_to_pu.in as Connection58
                    connect Product2.in Junction16 as Connection724
                    connect Product2.in1 P_ramp.out as Connection645
                    connect Product3.out Junction10 as Connection681
                    connect Product3.in Junction4 as Connection626
                    connect Product3.in2 Junction6 as Connection649
                    connect Sum3.in1 From4 as Connection707
                    connect Sum3.in Junction12 as Connection694
                    connect Sum3.out PI.In as Connection687
                    connect Sum5.in Junction4 as Connection624
                    connect Sum5.in1 Product2.out as Connection611
                    connect Sum6.in1 Junction9 as Connection678
                    connect Sum8.in f_droop_switch.out as Connection637
                    connect Sum8.in1 w_ramp.out as Connection638
                    connect delta_w.in Junction12 as Connection692
                    connect enable Junction14 as Connection708
                    connect f_droop_switch.in Product1.out as Connection634
                    connect load_share_switch.out Sum7.in as Connection650
                    connect mode_switch.in Junction11 as Connection684
                    connect mode_switch.out Sum7.in1 as Connection644
                    connect mode_switch.in1 Sum8.out as Connection643
                    connect mode_switch1.in2 Junction15 as Connection716
                    connect mode_switch1.in PI.Out as Connection712
                    connect "w to wpu.out" Junction13 as Connection696
                    connect w_Droop.out Product1.in as Connection722
                    connect w_Pm.in Junction10 as Connection683
                    connect w_Psp.in Junction9 as Connection680
                    connect w_bias mode_switch1.out as Connection713
                    connect w_meas "w to wpu.in" as Connection677
                    connect w_ramp.in w_switch.out as Connection103
                    connect w_ref w_switch.in as Connection180
                    connect w_sp.in Junction11 as Connection686
                    connect zero1.out Junction7 as Connection652
                }
                [
                    position = 7696, 8224
                    size = 120, 264
                ]

                component Subsystem Define_control_mode {
                    layout = dynamic
                    component "core/C function" Control_mode {
                        init_fnc = "/*Begin code section*/
P_control = 0;
Q_control = 0;
/*End code section*/"
                        input_terminals = "real Control_mode;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[u\'\']"
                        output_fnc = "/*Begin code section*/
if(Control_mode == 1){
    //PV mode
    P_control = 1;
    Q_control = 0;
}
else{
    if(Control_mode == 2){
        //PQ mode
        P_control = 1;
        Q_control = 1;
    }
    else{
        P_control = 0;
        Q_control = 0;
    }
}
/*End code section*/"
                        output_terminals = "real P_control;inherit Q_control;"
                        output_terminals_dimensions = "inherit;inherit"
                        output_terminals_feedthrough = "[u\'\']"
                        output_terminals_show_labels = "False;False;"
                    }
                    [
                        position = 8224, 8184
                        size = 176, 96
                    ]

                    port Gen_Control_Mode {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8184
                    ]

                    port P_Control {
                        position = right:11
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8152
                    ]

                    port Q_Control {
                        position = right:12
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8432, 8216
                    ]

                    connect Control_mode.Control_mode Gen_Control_Mode as Connection3
                    connect Control_mode.P_control P_Control as Connection2
                    connect Control_mode.Q_control Q_Control as Connection1
                }
                [
                    position = 7328, 8432
                    size = 144, 64
                ]

                component "core/C function" read_OP_mode {
                    init_fnc = "/*Begin code section*/
OP_mode =0;
enable = 0;
StandBy = 1;
GridFollowing = 0;
GridForming = 0;
/*End code section*/"
                    input_terminals = "real OP_mode;inherit GCB_status;"
                    input_terminals_dimensions = "inherit;inherit"
                    input_terminals_feedthrough = "[u\'\']"
                    input_terminals_show_labels = "False;False;"
                    output_fnc = "/*Begin code section*/
if(OP_mode==0){
    StandBy= 1;
    GridFollowing = 0;
    GridForming = 0;
    enable = 0;
}
else{
    if(OP_mode == 1){
        StandBy = 0;
        GridFollowing = 1;
        GridForming = 0;
        if(GCB_status == 0){
            enable = 0;
        }
        else{
            enable = 1;
        }
    }
    else{
        StandBy = 0;
        GridFollowing = 0;
        GridForming = 1;
        enable = 0;
    }
}
/*End code section*/"
                    output_terminals = "real StandBy;inherit GridFollowing;inherit GridForming;inherit enable;"
                    output_terminals_dimensions = "inherit;inherit;inherit;inherit"
                    output_terminals_feedthrough = "[u\'\']"
                    output_terminals_show_labels = "False;False;False;False;"
                }
                [
                    position = 7288, 7800
                    rotation = right
                    size = 128, 96
                ]

                port wmeas {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7840, 8320
                ]

                port T_in {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7272, 8280
                ]

                port Meas_feedback {
                    position = left:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7208, 8024
                ]

                port From_synch_check {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7856
                ]

                port To_synch_check {
                    position = left:12
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8456, 8112
                    rotation = left
                ]

                port T_out {
                    position = right:14
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8176, 8240
                ]

                port Inputs {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6864, 7960
                ]

                port Vf_out {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8272, 7816
                ]

                tag Goto38 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8088, 8440
                    hide_name = True
                    size = 60, 20
                ]

                tag From3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag From12 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From54 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8168
                    hide_name = True
                    size = 60, 20
                ]

                tag From59 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8104
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto14 {
                    value = "P_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8256
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto39 {
                    value = "Exciter_on"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7864, 7728
                    hide_name = True
                    size = 60, 20
                ]

                tag From15 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8112
                    hide_name = True
                    size = 60, 20
                ]

                tag From62 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8272
                    hide_name = True
                    size = 60, 20
                ]

                tag From66 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto44 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7952, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "dw_Synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag From70 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7928
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7504, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag From13 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto45 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7872, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From67 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7192, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From68 {
                    value = "w_ref"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8192
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto16 {
                    value = "Gen_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8264
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag From63 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8304
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7800
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto40 {
                    value = "Load_Share_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8152
                    hide_name = True
                    size = 60, 20
                ]

                tag From2 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto15 {
                    value = "pf_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From61 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7896
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto43 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7464, 8416
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From65 {
                    value = "Q_active"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7576, 7688
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8176
                    hide_name = True
                    size = 58, 20
                ]

                tag Goto11 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8120
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From51 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "P_control_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8448
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_OP_mode"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7128, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "GridForm"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 8008
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8160
                    hide_name = True
                    size = 60, 20
                ]

                tag From71 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8400
                    hide_name = True
                    size = 60, 20
                ]

                tag From60 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 7664
                    hide_name = True
                    size = 60, 20
                ]

                tag From1 {
                    value = "Q_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8024
                    hide_name = True
                    size = 60, 20
                ]

                tag From64 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto42 {
                    value = "Load_Share"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8312
                    hide_name = True
                    size = 60, 20
                ]

                tag From69 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 7960
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "V_ref"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7120, 8144
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto35 {
                    value = "StandBy"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7416, 7856
                    hide_name = True
                    size = 60, 20
                ]

                tag From16 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8240
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8208
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto46 {
                    value = "pf_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8224
                    hide_name = True
                    size = 58, 20
                ]

                tag From4 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7552, 8176
                    hide_name = True
                    size = 60, 20
                ]

                tag From72 {
                    value = "w_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8336, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From58 {
                    value = "P_meas"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8288
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "enable_outer_loop"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 7832
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto37 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7048, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vt_meas"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8200
                    hide_name = True
                    size = 58, 20
                ]

                junction Junction13 sp
                [
                    position = 7800, 7704
                ]

                junction Junction14 sp
                [
                    position = 7888, 8392
                ]

                junction Junction15 sp
                [
                    position = 7800, 7704
                ]

                junction Junction18 sp
                [
                    position = 8224, 7816
                ]

                junction Junction22 sp
                [
                    position = 7056, 8120
                ]

                junction Junction23 sp
                [
                    position = 7888, 8320
                ]

                junction Junction24 sp
                [
                    position = 8128, 8240
                ]

                junction Junction25 sp
                [
                    position = 7368, 7888
                ]

                junction Junction26 sp
                [
                    position = 7456, 7928
                ]

                junction Junction27 sp
                [
                    position = 7368, 7952
                ]

                connect "Bus Join1.out" To_synch_check as Connection608
                connect "Bus Split2.in" From_synch_check as Connection205
                connect "Bus Split2.out1" Goto4 as Connection543
                connect "Bus Split3.out2" Goto13 as Connection677
                connect "Bus Split3.out4" Goto15 as Connection679
                connect "Bus Split3.out7" Goto40 as Connection687
                connect "Bus Split3.in" Inputs as Connection672
                connect "Bus Split3.out" Junction22 as Connection675
                connect Exciter_on.in Junction15 as Connection604
                connect Freq_setpoint_control.P_ref From14 as Connection648
                connect Freq_setpoint_control.Pmeas_in From2 as Connection651
                connect Freq_setpoint_control.enable From4 as Connection649
                connect Freq_setpoint_control.w_bias Governor_and_Engine.w_bias as Connection706
                connect From10 "Governor_and_Engine.Gen On" as Connection700
                connect From13 Exciter.Vref as Connection226
                connect From15 Freq_setpoint_control.w_ref as Connection647
                connect From16 "Bus Join1.in" as Connection576
                connect From27 "pf Control.pf_meas" as Connection693
                connect From3 Exciter.Vt_in as Connection179
                connect From45 Round1.in as Connection570
                connect From46 "Unit Delay1.in" as Connection581
                connect From49 "Bus Join1.in1" as Connection609
                connect From5 Read_Control_mode.Enable_outer_loop as Connection187
                connect From50 "Bus Join1.in3" as Connection611
                connect From51 "Bus Join1.in2" as Connection610
                connect From52 Exciter.dV as Connection585
                connect From54 "Bus Join1.in4" as Connection612
                connect From56 Freq_setpoint_control.w_meas as Connection650
                connect From58 Governor_and_Engine.P_meas as Connection697
                connect From59 "Unit Delay2.in" as Connection622
                connect From6 Read_Control_mode.P_control_mode as Connection188
                connect From60 "Unit Delay3.in" as Connection632
                connect From61 Exciter.Q_meas as Connection634
                connect From62 Freq_setpoint_control.P_mode as Connection653
                connect From63 Freq_setpoint_control.Load_Share_on as Connection654
                connect From64 Freq_setpoint_control.Load_Share as Connection655
                connect From65 Read_Control_mode.Q_control_mode as Connection685
                connect From66 "pf Control.P_control_mode" as Connection686
                connect From67 Define_control_mode.Gen_Control_Mode as Connection691
                connect From68 Governor_and_Engine.w_ref as Connection701
                connect From69 "pf Control.P_meas" as Connection709
                connect From7 Start_Exciter.Gen_On as Connection589
                connect From70 "pf Control.pf_ref" as Connection708
                connect From71 Output.Gen_On as Connection713
                connect From72 Output.w_meas as Connection714
                connect From8 Start_Exciter.w_meas as Connection590
                connect From9 Governor_and_Engine.dw_synch as Connection698
                connect Gen_On.in Junction22 as Connection673
                connect Goto1 "Bus Split1.out" as Connection174
                connect Goto10 "Bus Split2.out" as Connection531
                connect Goto12 "Bus Split3.out1" as Connection676
                connect Goto14 "Bus Split3.out3" as Connection678
                connect Goto16 "Bus Split3.out6" as Connection681
                connect Goto2 "Bus Split1.out1" as Connection175
                connect Goto3 "Bus Split1.out2" as Connection176
                connect Goto32 "Bus Split3.out5" as Connection680
                connect Goto37 "Bus Split2.out2" as Connection584
                connect Goto38 check_steady_state_w.ss_speed as Connection602
                connect Goto39 Junction15 as Connection606
                connect Goto42 "Bus Split3.out8" as Connection688
                connect Goto43 Define_control_mode.P_Control as Connection690
                connect Goto44 Define_control_mode.Q_Control as Connection689
                connect Goto45 "pf Control.Q_active" as Connection707
                connect Goto46 "Bus Split1.out3" as Connection711
                connect Goto9 Junction14 as Connection599
                connect Governor_and_Engine.w_meas_in Junction23 as Connection696
                connect Governor_and_Engine.T_out Junction24 as Connection705
                connect Junction13 Exciter.Start as Connection596
                connect Junction15 Junction13 as Connection605
                connect Junction18 Exciter.Vf_out as Connection645
                connect Junction22 Goto11 as Connection674
                connect Junction23 Junction14 as Connection695
                connect Junction24 T.in as Connection704
                connect Meas_feedback "Bus Split1.in" as Connection712
                connect Start_Exciter.Start Junction13 as Connection595
                connect T_in Termination1.in as Connection166
                connect T_out Junction24 as Connection703
                connect "Unit Delay2.out" Governor_and_Engine.GCB_status as Connection702
                connect "Unit Delay3.out" Exciter.GCB_status as Connection633
                connect Vf.in Junction18 as Connection644
                connect Vf_out Junction18 as Connection646
                connect check_steady_state_w.w_meas Junction14 as Connection601
                connect "pf Control.dV_out" Exciter.Delta_V_in as Connection710
                connect "pf Control.Q_meas_in" From1 as Connection552
                connect "pf Control.Q_control_mode" From11 as Connection549
                connect "pf Control.Pref" From12 as Connection551
                connect "pf Control.enable" From47 as Connection550
                connect wmeas Junction23 as Connection694
                connect Goto35 Junction25 as Connection718
                connect Junction25 StandBy.in as Connection719
                connect read_OP_mode.StandBy Junction25 as Connection720
                connect Goto36 Junction26 as Connection721
                connect Junction26 GridFollowing.in as Connection722
                connect read_OP_mode.GridFollowing Junction26 as Connection723
                connect GridForming.in Junction27 as Connection724
                connect Junction27 Goto34 as Connection725
                connect read_OP_mode.GridForming Junction27 as Connection726
                connect read_OP_mode.enable Goto33 as Connection727
                connect read_OP_mode.GCB_status "Unit Delay1.out" as Connection728
                connect Round1.out read_OP_mode.OP_mode as Connection729
            }
            [
                position = 9088, 8056
                scale = -1, 1
                size = 208, 200
            ]

            component Subsystem Sync_Check {
                layout = dynamic
                component "core/Logical operator" not {
                    operator = "NOT"
                }
                [
                    position = 9032, 8632
                    hide_name = True
                ]

                component "core/Probe" dw_f {
                }
                [
                    position = 8744, 8096
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join2" {
                    inputs = "3"
                }
                [
                    position = 8704, 8664
                    hide_name = True
                ]

                component "core/Digital Probe" V_match {
                }
                [
                    position = 8728, 7968
                    rotation = left
                ]

                component "core/Digital Probe" Speed_ss {
                }
                [
                    position = 9160, 8280
                    rotation = left
                ]

                component "core/Digital Probe" Phase_match {
                }
                [
                    position = 8720, 8400
                    rotation = right
                ]

                component "core/Digital Probe" dw_synch_ON {
                }
                [
                    position = 9248, 8536
                ]

                component "core/Bus Split" "Bus Split1" {
                    outputs = "5"
                }
                [
                    position = 8632, 8560
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dV {
                }
                [
                    position = 8608, 7928
                    rotation = left
                ]

                component "core/Bus Join" "Bus Join" {
                    inputs = "3"
                }
                [
                    position = 9192, 8048
                    rotation = right
                    hide_name = True
                ]

                component "core/Probe" dw_phase {
                }
                [
                    position = 8744, 8256
                    rotation = left
                ]

                component "core/Digital Probe" f_match {
                }
                [
                    position = 8624, 8176
                    rotation = left
                ]

                component "core/Digital Probe" Check_phase_ON {
                }
                [
                    position = 8592, 8440
                ]

                component "core/Logical operator" and1 {
                }
                [
                    position = 8464, 8440
                    hide_name = True
                ]

                component "core/Probe" dw_synch {
                }
                [
                    position = 9056, 8168
                    rotation = left
                ]

                component "core/Logical operator" and2 {
                    inputs = "5"
                }
                [
                    position = 9120, 8576
                    rotation = left
                    hide_name = True
                ]

                component Subsystem check_V_diff {
                    layout = dynamic
                    component "core/Abs" Abs4 {
                    }
                    [
                        position = 7816, 8176
                        hide_name = True
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8144
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8264, 8216
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8432, 8160
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                    }
                    [
                        position = 8048, 8248
                        hide_name = True
                    ]

                    component "core/Gain" Volt_diff {
                        gain = "delta_V/100.0"
                    }
                    [
                        position = 8264, 8256
                    ]

                    component "core/Gain" Vgrid_lowLim {
                        gain = "0.9"
                    }
                    [
                        position = 7864, 8280
                    ]

                    component "core/Probe" V_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    component "core/Gain" Vgrid_upLim {
                        gain = "1.1"
                    }
                    [
                        position = 7864, 8224
                    ]

                    component "core/Constant" one1 {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7776, 8224
                    ]

                    component "core/Constant" one {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8200, 8256
                    ]

                    component "core/Gain" pu {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 8128, 8144
                    ]

                    component "core/Gain" pu1 {
                        gain = "1.0/(Vn/((3.0/2.0)**0.5))"
                    }
                    [
                        position = 7880, 8176
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8360, 8176
                        hide_name = True
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8144, 8064
                        hide_name = True
                    ]

                    component "core/Relational operator" less_equal {
                        relational_op = "<="
                    }
                    [
                        position = 7960, 8216
                        hide_name = True
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8336, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Relational operator" greater_equal {
                        relational_op = ">="
                    }
                    [
                        position = 7960, 8272
                        hide_name = True
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "-1"
                            limit_upper = "1"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Limit" Limit1 {
                            lower_limit = "V_lowLim"
                            upper_limit = "V_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Kp {
                            gain = "V_Kp"
                        }
                        [
                            position = 8024, 8168
                        ]

                        component "core/Gain" Ki {
                            gain = "V_Ki"
                        }
                        [
                            position = 7976, 8216
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7888, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7944, 8168
                        ]

                        connect In Junction4 as Connection58
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection59
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection60
                        connect Ki.out Sum7.in as Connection56
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8272, 8144
                        size = 64, 48
                    ]

                    port Vgrid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8136
                    ]

                    port Vgen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8152
                    ]

                    port dV {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8496, 8160
                    ]

                    port Activate {
                        position = top:auto
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8064, 8064
                    ]

                    port V_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8400, 8224
                    ]

                    port Grid_On {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8128, 8248
                    ]

                    junction Junction2 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction3 sp
                    [
                        position = 8168, 8144
                    ]

                    junction Junction4 sp
                    [
                        position = 8272, 8064
                    ]

                    junction Junction5 sp
                    [
                        position = 7776, 8136
                    ]

                    junction Junction6 sp
                    [
                        position = 7912, 8208
                    ]

                    junction Junction7 sp
                    [
                        position = 7816, 8224
                    ]

                    connect Abs3.in Junction2 as Connection202
                    connect Abs4.in Junction5 as Connection227
                    connect Abs4.out pu1.in as Connection235
                    connect Activate "Unit Delay1.in" as Connection208
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Grid_On and.out as Connection241
                    connect Junction2 pu.out as Connection201
                    connect Junction3 Junction2 as Connection216
                    connect Junction4 "Unit Delay1.out" as Connection219
                    connect Junction5 Vgrid as Connection226
                    connect Junction6 less_equal.in as Connection232
                    connect Junction7 Vgrid_upLim.in as Connection239
                    connect PI.In Junction3 as Connection217
                    connect PI.Reset Junction4 as Connection220
                    connect PI.Out "Signal switch1.in" as Connection214
                    connect "Signal switch1.in2" Junction4 as Connection218
                    connect Sum1.in Junction5 as Connection225
                    connect Sum1.in1 Vgen as Connection60
                    connect V_diff.in Junction3 as Connection215
                    connect V_match Comparator1.out as Connection187
                    connect Vgrid_lowLim.in Junction7 as Connection240
                    connect Vgrid_lowLim.out greater_equal.in1 as Connection237
                    connect Vgrid_upLim.out less_equal.in1 as Connection234
                    connect Volt_diff.out Comparator1.in1 as Connection17
                    connect dV "Signal switch1.out" as Connection181
                    connect greater_equal.in Junction6 as Connection233
                    connect greater_equal.out and.in1 as Connection229
                    connect less_equal.out and.in as Connection228
                    connect one.out Volt_diff.in as Connection14
                    connect one1.out Junction7 as Connection238
                    connect pu.in Sum1.out as Connection198
                    connect pu1.out Junction6 as Connection236
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8520, 8016
                    size = 144, 120
                ]

                component Subsystem PLLs {
                    layout = dynamic
                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8464, 8216
                        hide_name = True
                    ]

                    component "core/Probe" V_grid {
                    }
                    [
                        position = 8296, 8096
                    ]

                    component "core/Probe" wt_grid {
                    }
                    [
                        position = 8464, 8144
                    ]

                    component "core/Bus Split" split1 {
                        outputs = "3"
                    }
                    [
                        position = 8072, 8360
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Probe" wt_gen {
                    }
                    [
                        position = 8464, 8280
                    ]

                    component "core/Bus Split" split {
                        outputs = "3"
                    }
                    [
                        position = 8096, 7936
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" V_gen {
                    }
                    [
                        position = 8216, 8352
                    ]

                    component "core/Gain" Gain1 {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 8208
                        hide_name = True
                    ]

                    component Subsystem PLL_Grid {
                        layout = dynamic
                        component "core/Termination" Term1 {
                        }
                        [
                            position = 8128, 8152
                            rotation = left
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_Vt {
                            a_coeff = "[1.0/(2*np.pi*fc_vt),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8328, 8224
                        ]

                        component "core/Discrete Transfer Function" LPF_f {
                            a_coeff = "[1.0/(2*np.pi*fc_f),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8216, 8248
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 8104, 8112
                            rotation = left
                            hide_name = True
                        ]

                        component Subsystem PLL {
                            layout = dynamic
                            component "core/Gain" rads_to_Hz {
                                gain = "1/(2*np.pi)"
                            }
                            [
                                position = 8360, 8056
                            ]

                            component "core/Termination" Term {
                            }
                            [
                                position = 8008, 8216
                                rotation = right
                            ]

                            component "core/Unit Delay" "Unit Delay1" {
                            }
                            [
                                position = 8480, 8272
                                rotation = right
                            ]

                            component "core/C function" integrator {
                                global_variables = "real out;"
                                init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                                input_terminals_dimensions = "inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                output_fnc = "/*Begin code section*/
output = out+0.0;
/*End code section*/"
                                output_terminals = "inherit output;"
                                output_terminals_dimensions = "inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                parameters = "real Ts;"
                                update_fnc = "/*Begin code section*/
out += Ts*in;

if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            }
                            [
                                position = 8424, 8136
                                size = 0, 0
                            ]

                            component Subsystem Normalize {
                                layout = dynamic
                                component "core/C function" V_terminal {
                                    init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                    input_terminals = "real d;inherit q;"
                                    input_terminals_dimensions = "inherit;inherit"
                                    input_terminals_feedthrough = "[u\'\']"
                                    input_terminals_show_labels = "False;False;"
                                    output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                    output_terminals = "real t;inherit q_pu;"
                                    output_terminals_dimensions = "inherit;inherit"
                                    output_terminals_feedthrough = "[u\'\']"
                                    output_terminals_show_labels = "False;False;"
                                }
                                [
                                    position = 8192, 8192
                                    size = 0, 0
                                ]

                                port d {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8152
                                ]

                                port q {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8048, 8216
                                ]

                                port q_pu {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8352, 8200
                                ]

                                port Vt {
                                    position = top:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8280, 8104
                                    rotation = left
                                ]

                                connect V_terminal.t Vt as Connection8
                                connect V_terminal.d d as Connection1
                                connect V_terminal.q q as Connection3
                                connect q_pu V_terminal.q_pu as Connection9
                            }
                            [
                                position = 8128, 8136
                                size = 64, 64
                            ]

                            component Subsystem PI {
                                layout = dynamic
                                component "core/Sum" Sum6 {
                                    signs = "-+"
                                }
                                [
                                    position = 8304, 8304
                                    hide_name = True
                                    scale = -1, 1
                                ]

                                component "core/Gain" Ki {
                                    gain = "Ki"
                                }
                                [
                                    position = 7960, 8208
                                ]

                                component "core/Limit" Limit1 {
                                    lower_limit = "0.7*2*np.pi*f"
                                    upper_limit = "1.4*2*np.pi*f"
                                }
                                [
                                    position = 8416, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum8 {
                                }
                                [
                                    position = 8272, 8176
                                    hide_name = True
                                ]

                                component "core/Sum" Sum7 {
                                }
                                [
                                    position = 8072, 8216
                                    hide_name = True
                                ]

                                component "core/Gain" Kp {
                                    gain = "Kp"
                                }
                                [
                                    position = 8088, 8144
                                ]

                                component "core/Gain" Kb {
                                    gain = "1000"
                                }
                                [
                                    position = 8200, 8304
                                    scale = -1, 1
                                ]

                                component "core/Integrator" Integrator1 {
                                    init_value = "[2*np.pi*f]"
                                }
                                [
                                    position = 8176, 8216
                                    hide_name = True
                                ]

                                port In {
                                    position = right:auto
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7840, 8144
                                    rotation = down
                                    scale = -1, 1
                                ]

                                port Out {
                                    position = left:auto
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8544, 8176
                                    rotation = down
                                    scale = -1, 1
                                ]

                                junction Junction161 sp
                                [
                                    position = 7904, 8144
                                ]

                                junction Junction162 sp
                                [
                                    position = 8368, 8176
                                ]

                                junction Junction163 sp
                                [
                                    position = 8456, 8176
                                ]

                                connect Integrator1.out Sum8.in1 as Connection352
                                connect Junction161 In as Connection360
                                connect Junction161 Ki.in as Connection359
                                connect Junction161 Kp.in as Connection358
                                connect Junction162 Limit1.in as Connection369
                                connect Junction163 Out as Connection372
                                connect Kb.in Sum6.out as Connection50
                                connect Kp.out Sum8.in as Connection350
                                connect Limit1.out Junction163 as Connection371
                                connect Sum6.in Junction162 as Connection370
                                connect Sum6.in1 Junction163 as Connection373
                                connect Sum7.out Integrator1.in as Connection365
                                connect Sum7.in1 Kb.out as Connection53
                                connect Sum7.in Ki.out as Connection364
                                connect Sum8.out Junction162 as Connection368
                            }
                            [
                                position = 8256, 8136
                                scale = -1, -1
                                size = 48, 48
                            ]

                            component Subsystem ABC_dqz {
                                layout = dynamic
                                component "core/alpha beta to dq" "alpha beta to dq" {
                                }
                                [
                                    position = 8248, 8192
                                ]

                                component "core/abc to alpha beta" "abc to alpha beta" {
                                }
                                [
                                    position = 8024, 8192
                                ]

                                port A {
                                    position = left:1
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7952, 8104
                                    rotation = right
                                ]

                                port B {
                                    position = left:2
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7904, 8104
                                    rotation = right
                                ]

                                port C {
                                    position = left:3
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 7856, 8104
                                    rotation = right
                                ]

                                port wt {
                                    position = left:4
                                    kind = sp
                                    direction =  out
                                    sp_type {
                                        default = auto
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8176, 8288
                                    rotation = left
                                ]

                                port d {
                                    position = right:1
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8320, 8136
                                    rotation = left
                                ]

                                port q {
                                    position = right:2
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8368, 8136
                                    rotation = left
                                ]

                                port z {
                                    position = right:3
                                    kind = sp
                                    direction =  in
                                    sp_type {
                                        default = inherit
                                        readonly = True
                                    }
                                }
                                [
                                    position = 8096, 8288
                                    rotation = right
                                ]

                                connect "abc to alpha beta.A" A as Connection2685
                                connect "abc to alpha beta.B" B as Connection2686
                                connect "abc to alpha beta.C" C as Connection2687
                                connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                                connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                                connect "alpha beta to dq.wt" wt as Connection2690
                                connect d "alpha beta to dq.d" as Connection2692
                                connect q "alpha beta to dq.q" as Connection2693
                                connect z "abc to alpha beta.gamma" as Connection2691
                            }
                            [
                                position = 7912, 8152
                                size = 48, 104
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7736, 8152
                                rotation = left
                            ]

                            port B {
                                label = "B"
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7776, 8176
                                rotation = left
                            ]

                            port C {
                                label = "C"
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7816, 8200
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8008
                            ]

                            port q {
                                label = "q"
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8056, 8056
                            ]

                            port Vt {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8192, 8064
                            ]

                            port wt {
                                position = right:5
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8528, 8136
                            ]

                            port f {
                                position = right:4
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8424, 8056
                            ]

                            junction Junction4 sp
                            [
                                position = 8480, 8136
                            ]

                            junction Junction5 sp
                            [
                                position = 8320, 8136
                            ]

                            junction Junction6 sp
                            [
                                position = 8008, 8120
                            ]

                            junction Junction7 sp
                            [
                                position = 8024, 8152
                            ]

                            connect ABC_dqz.A A as Connection233
                            connect ABC_dqz.C C as Connection231
                            connect ABC_dqz.d Junction6 as Connection225
                            connect ABC_dqz.q Junction7 as Connection228
                            connect ABC_dqz.z Term.in as Connection229
                            connect B ABC_dqz.B as Connection232
                            connect Junction4 "Unit Delay1.in" as Connection213
                            connect Junction5 integrator.in as Connection218
                            connect Junction6 d as Connection224
                            [
                                position = 0, 0
                            ]
                            connect Junction7 Normalize.q as Connection227
                            [
                                position = 0, 0
                            ]
                            connect Normalize.d Junction6 as Connection223
                            connect PI.Out Junction5 as Connection219
                            connect PI.In Normalize.q_pu as Connection220
                            connect "Unit Delay1.out" ABC_dqz.wt as Connection230
                            connect Vt Normalize.Vt as Connection184
                            connect f rads_to_Hz.out as Connection199
                            connect integrator.output Junction4 as Connection214
                            connect q Junction7 as Connection226
                            connect rads_to_Hz.in Junction5 as Connection217
                            connect wt Junction4 as Connection212

                            f = "f"

                            mask {
                                description = "Simple PLL with wrapped wt"

                                Kp {
                                    label = "Proportional gain"
                                    widget = edit
                                    type = generic
                                    default_value = "100"
                                }

                                Ki {
                                    label = "Integral gain"
                                    widget = edit
                                    type = generic
                                    default_value = "3200"
                                }

                                f {
                                    label = "Target frequency"
                                    widget = edit
                                    type = generic
                                    default_value = "60"
                                    unit = "Hz"
                                }

                                Ts {
                                    label = "Execution rate"
                                    widget = edit
                                    type = generic
                                    default_value = "Ts"
                                }

                                CODE open
                                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                                
                                    dialog = RegularComponentPropertiesDialog(
                                        component=component,
                                        property_container=component.masks[-1],
                                        current_diagram=current_diagram
                                    )
                                    dialog.exec_()
                                
                                ENDCODE
                            }
                        }
                        [
                            position = 8048, 8224
                            rotation = down
                            scale = -1, -1
                            size = 64, 136
                        ]

                        port f {
                            label = "f"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8280, 8248
                        ]

                        port wt {
                            label = "wt"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8152, 8272
                        ]

                        port Va {
                            label = "Va"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8176
                        ]

                        port Vb {
                            label = "Vb"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8224
                        ]

                        port Vc {
                            label = "Vc"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7928, 8272
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8392, 8224
                        ]

                        connect LPF_Vt.in PLL.Vt as Connection12
                        connect LPF_f.in PLL.f as Connection10
                        connect PLL.A Va as Connection1
                        connect PLL.C Vc as Connection3
                        connect Term.in PLL.d as Connection7
                        connect Term1.in PLL.q as Connection8
                        connect Vb PLL.B as Connection2
                        connect Vt LPF_Vt.out as Connection11
                        connect f LPF_f.out as Connection9
                        connect wt PLL.wt as Connection6

                        fc_f = "10.0"
                        fc_vt = "10.0"

                        mask {
                            fc_vt {
                                label = "Vt channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            fc_f {
                                label = "f channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "0"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 8184, 8024
                        size = 72, 120
                    ]

                    port f_Gen {
                        label = "f_Gen"
                        position = right:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8208
                    ]

                    port f_Grid {
                        label = "f_Grid"
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 7984
                    ]

                    port Vgrid {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8064
                    ]

                    port Vgen {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8216, 8288
                    ]

                    port V_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7888
                    ]

                    port V_Gen {
                        label = "V_Gen"
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8416
                    ]

                    port "Phase diff" {
                        position = right:6
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8544, 8216
                    ]

                    tag From2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8352, 8208
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto2 {
                        value = "wt_grid"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8288, 8024
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction15 sp
                    [
                        position = 8400, 8208
                    ]

                    junction Junction23 sp
                    [
                        position = 8264, 8064
                    ]

                    junction Junction27 sp
                    [
                        position = 8400, 8248
                    ]

                    junction Junction28 sp
                    [
                        position = 8160, 8288
                    ]

                    connect From2 Junction15 as Connection270
                    connect Gain1.out f_Gen as Connection342
                    connect Gain1.in split1.out as Connection349
                    connect Junction15 Sum1.in as Connection271
                    connect Junction23 V_grid.in as Connection329
                    connect Junction27 Sum1.in1 as Connection352
                    connect Junction28 V_gen.in as Connection356
                    connect PLL_Grid.wt Goto2 as Connection294
                    connect PLL_Grid.Vt Junction23 as Connection328
                    connect PLL_Grid.Vb split.out1 as Connection324
                    connect "Phase diff" Sum1.out as Connection336
                    connect V_Grid split.in as Connection134
                    connect Vgen Junction28 as Connection355
                    connect Vgrid Junction23 as Connection330
                    connect f_Grid PLL_Grid.f as Connection327
                    connect split.out2 PLL_Grid.Vc as Connection322
                    connect split.out PLL_Grid.Va as Connection325
                    connect split1.out1 Junction27 as Connection353
                    connect split1.out2 Junction28 as Connection357
                    connect split1.in V_Gen as Connection348
                    connect wt_gen.in Junction27 as Connection351
                    connect wt_grid.in Junction15 as Connection272
                }
                [
                    position = 8288, 8136
                    size = 104, 360
                ]

                component Subsystem Calculate_dw_synch {
                    layout = dynamic
                    component "core/Discrete Transfer Function" LPF_dw {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8200, 8104
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8456, 8120
                        hide_name = True
                    ]

                    component "core/Constant" zero {
                        execution_rate = "Ts"
                        value = "0"
                    }
                    [
                        position = 8384, 8136
                    ]

                    component "core/Unit Delay" "Unit Delay1" {
                    }
                    [
                        position = 8400, 8040
                        hide_name = True
                    ]

                    component "core/Gain" dw_K {
                        gain = "dw_K"
                    }
                    [
                        position = 8272, 8104
                    ]

                    component "core/Sum" Sum4 {
                    }
                    [
                        position = 8112, 8104
                        hide_name = True
                    ]

                    port dw_f {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8048
                    ]

                    port dw_phase {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8024, 8112
                    ]

                    port dw_synch {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8528, 8120
                    ]

                    port Activate {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8328, 8040
                    ]

                    connect Sum4.out LPF_dw.in as Connection240
                    connect Sum4.in1 dw_phase as Connection231
                    connect "Unit Delay1.in" Activate as Connection180
                    connect "Unit Delay1.out" "Signal switch1.in2" as Connection181
                    connect dw_K.in LPF_dw.out as Connection241
                    connect dw_K.out "Signal switch1.in" as Connection242
                    connect dw_f Sum4.in as Connection239
                    connect dw_synch "Signal switch1.out" as Connection177
                    connect zero.out "Signal switch1.in1" as Connection179
                }
                [
                    position = 8952, 8216
                    size = 128, 208
                ]

                component Subsystem check_f_diff {
                    layout = dynamic
                    component "core/Gain" Freq_diff {
                        gain = "delta_f/100.0"
                    }
                    [
                        position = 8208, 8256
                    ]

                    component "core/Gain" toPU {
                        gain = "[1.0/(2.0*f)]"
                    }
                    [
                        position = 8216, 8152
                    ]

                    component "core/Sum" Sum1 {
                        signs = "+-"
                    }
                    [
                        position = 8056, 8152
                        hide_name = True
                    ]

                    component "core/Abs" Abs3 {
                    }
                    [
                        position = 8208, 8216
                        hide_name = True
                    ]

                    component "core/Constant" Constant1 {
                        execution_rate = "Ts"
                        value = "f"
                    }
                    [
                        position = 8120, 8256
                    ]

                    component "core/Comparator" Comparator1 {
                    }
                    [
                        position = 8280, 8224
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Discrete Transfer Function" LPF_dwf {
                        a_coeff = "[1.0/(2*np.pi*1),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8128, 8152
                    ]

                    component "core/Probe" f_diff {
                    }
                    [
                        position = 8168, 8104
                        rotation = left
                    ]

                    port dw_f {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8152
                    ]

                    port f_Grid {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8144
                    ]

                    port f_Gen {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7968, 8160
                    ]

                    port f_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8224
                    ]

                    junction Junction1 sp
                    [
                        position = 8168, 8152
                    ]

                    connect Abs3.in Junction1 as Connection7
                    connect Comparator1.in2 Abs3.out as Connection10
                    connect Comparator1.out f_match as Connection59
                    connect Constant1.out Freq_diff.in as Connection14
                    connect Freq_diff.out Comparator1.in1 as Connection17
                    connect Junction1 LPF_dwf.out as Connection61
                    connect LPF_dwf.in Sum1.out as Connection62
                    connect Sum1.in1 f_Gen as Connection60
                    connect Sum1.in f_Grid as Connection57
                    connect f_diff.in Junction1 as Connection56
                    connect toPU.in Junction1 as Connection40
                    connect toPU.out dw_f as Connection63
                }
                [
                    position = 8520, 8176
                    size = 144, 120
                ]

                component Subsystem check_phase_diff {
                    layout = dynamic
                    component "core/Abs" Abs2 {
                    }
                    [
                        position = 8064, 8096
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Probe" phase_filter {
                    }
                    [
                        position = 8112, 8040
                    ]

                    component "core/Probe" phase_diff {
                    }
                    [
                        position = 7992, 7928
                        rotation = left
                    ]

                    component "core/Discrete Transfer Function" LPF {
                        a_coeff = "[1.0/(2*np.pi*0.5),1]"
                        b_coeff = "1"
                        domain = "S-domain"
                        method = "Bilinear"
                    }
                    [
                        position = 8032, 7976
                    ]

                    component "core/Constant" One {
                        execution_rate = "Ts"
                    }
                    [
                        position = 8024, 8160
                    ]

                    component "core/Gain" Phase_diff {
                        gain = "delta_phi*np.pi/180.0"
                    }
                    [
                        position = 8088, 8160
                    ]

                    component "core/Product" Product1 {
                    }
                    [
                        position = 8384, 7968
                        hide_name = True
                    ]

                    component "core/C function" confine_phase {
                        init_fnc = "/*Begin code section*/
dtheta = 0;
dtheta_confined = 0;
/*End code section*/"
                        input_terminals = "real dtheta;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        output_fnc = "/*Begin code section*/
if (dtheta > 3.14159265359) {//confine theta to +/- 2*pi;
    dtheta_confined = dtheta - 6.28318530718;
}
else{
    if (dtheta < -3.14159265359){
        dtheta_confined = dtheta + 6.28318530718;
    }
    else{
        dtheta_confined = dtheta;
    }
}
/*End code section*/"
                        output_terminals = "real dtheta_confined;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7776, 7976
                        size = 0, 0
                    ]

                    component "core/Comparator" Comparator2 {
                    }
                    [
                        position = 8160, 8152
                        hide_name = True
                        scale = 1, -1
                    ]

                    component "core/Gain" to_pu {
                        gain = "1.0/(2*np.pi)"
                    }
                    [
                        position = 8128, 7976
                    ]

                    component "core/C function" offset_phase {
                        global_variables = "real off1;real off2;"
                        init_fnc = "/*Begin code section*/
phase_out = 0;
off1 = execution_rate*6.2831853071*f;
off2 = phaseOff*3.141592653589793/180.0;
/*End code section*/"
                        input_terminals = "inherit phase;"
                        input_terminals_dimensions = "inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "[(\'phase\', True)]"
                        output_fnc = "/*Begin code section*/
phase_out = phase - off1 + off2;
/*End code section*/"
                        output_terminals = "real phase_out;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                        output_terminals_show_labels = "[(\'phase_out\', True)]"
                        parameters = "real f;real phaseOff;"
                    }
                    [
                        position = 7888, 7976
                        size = 0, 0
                    ]

                    component Subsystem Counter {
                        layout = dynamic
                        component "core/Logical operator" not {
                            operator = "NOT"
                        }
                        [
                            position = 8104, 8248
                        ]

                        component "core/C function" c_function {
                            input_terminals = "real counter;"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
if(counter>=0.1/execution_rate){
    out = 1;
}
else{
    out = 0;
}
/*End code section*/"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8288, 8200
                            size = 0, 0
                        ]

                        component "core/Counter" Counter1 {
                        }
                        [
                            position = 8192, 8200
                            size = 48, 48
                        ]

                        port In {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8008, 8192
                        ]

                        port Out {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8368, 8200
                        ]

                        junction Junction14 sp
                        [
                            position = 8056, 8192
                        ]

                        connect Counter1.en Junction14 as Connection559
                        connect Junction14 In as Connection562
                        connect Junction14 not.in as Connection560
                        connect c_function.counter Counter1.out as Connection563
                        connect c_function.out Out as Connection564
                        connect not.out Counter1.reset as Connection88
                    }
                    [
                        position = 8256, 8152
                        size = 48, 48
                    ]

                    component Subsystem PI {
                        layout = dynamic
                        component "core/Limit" Limit1 {
                            lower_limit = "phase_lowLim"
                            upper_limit = "phase_upLim"
                        }
                        [
                            position = 8408, 8224
                        ]

                        component "core/Gain" Ki {
                            gain = "phase_Ki"
                        }
                        [
                            position = 7984, 8216
                        ]

                        component "core/Gain" Kp {
                            gain = "phase_Kp"
                        }
                        [
                            position = 8032, 8168
                        ]

                        component "core/Sum" Sum5 {
                        }
                        [
                            position = 8320, 8224
                        ]

                        component "core/Gain" Kb {
                        }
                        [
                            position = 8216, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum6 {
                            signs = "-+"
                        }
                        [
                            position = 8320, 8312
                            scale = -1, 1
                        ]

                        component "core/Sum" Sum7 {
                        }
                        [
                            position = 8088, 8224
                        ]

                        component "core/Integrator" Integrator1 {
                            limit_lower = "phase_lowLim"
                            limit_upper = "phase_upLim"
                            show_reset = "either"
                        }
                        [
                            position = 8216, 8232
                        ]

                        port Reset {
                            label = "Reset"
                            position = top:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8144, 8264
                        ]

                        port In {
                            label = "In"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7912, 8168
                        ]

                        port Out {
                            label = "Out"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8224
                        ]

                        junction Junction2 sp
                        [
                            position = 8368, 8224
                        ]

                        junction Junction3 sp
                        [
                            position = 8440, 8224
                        ]

                        junction Junction4 sp
                        [
                            position = 7952, 8168
                        ]

                        connect In Junction4 as Connection57
                        connect Integrator1.reset Reset as Connection2
                        connect Junction2 Limit1.in as Connection45
                        connect Junction3 Out as Connection48
                        connect Junction4 Kp.in as Connection58
                        connect Kb.in Sum6.out as Connection50
                        connect Ki.in Junction4 as Connection59
                        connect Ki.out Sum7.in as Connection54
                        connect Kp.out Sum5.in as Connection55
                        connect Limit1.out Junction3 as Connection47
                        connect Sum5.in1 Integrator1.out as Connection5
                        connect Sum5.out Junction2 as Connection44
                        connect Sum6.in Junction2 as Connection46
                        connect Sum6.in1 Junction3 as Connection49
                        connect Sum7.out Integrator1.in as Connection52
                        connect Sum7.in1 Kb.out as Connection53
                    }
                    [
                        position = 8240, 7976
                        size = 64, 48
                    ]

                    port phase_match {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8360, 8152
                    ]

                    port Activate {
                        position = bottom:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8240, 7864
                        rotation = left
                        scale = 1, -1
                    ]

                    port dw_phase {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8464, 7968
                    ]

                    port phase_Diff {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7688, 7976
                    ]

                    junction Junction15 sp
                    [
                        position = 8064, 7976
                    ]

                    junction Junction17 sp
                    [
                        position = 8064, 8040
                    ]

                    junction Junction21 sp
                    [
                        position = 8240, 7912
                    ]

                    junction Junction22 sp
                    [
                        position = 7992, 7976
                    ]

                    connect Abs2.in Junction17 as Connection590
                    connect Activate Junction21 as Connection622
                    connect Comparator2.in2 Abs2.out as Connection712
                    connect Comparator2.out Counter.In as Connection674
                    connect Junction15 LPF.out as Connection582
                    connect Junction17 Junction15 as Connection591
                    connect Junction21 PI.Reset as Connection693
                    connect Junction21 Product1.in as Connection623
                    connect Junction22 LPF.in as Connection732
                    connect One.out Phase_diff.in as Connection15
                    connect Phase_diff.out Comparator2.in1 as Connection49
                    connect Product1.in1 PI.Out as Connection692
                    connect confine_phase.dtheta phase_Diff as Connection721
                    connect dw_phase Product1.out as Connection714
                    connect offset_phase.phase_out Junction22 as Connection733
                    connect offset_phase.phase confine_phase.dtheta_confined as Connection734
                    connect phase_diff.in Junction22 as Connection731
                    connect phase_filter.in Junction17 as Connection592
                    connect phase_match Counter.Out as Connection673
                    connect to_pu.in Junction15 as Connection581
                    connect to_pu.out PI.In as Connection713
                }
                [
                    position = 8528, 8328
                    size = 168, 112
                ]

                component Subsystem Contactor_Control {
                    layout = dynamic
                    component "core/Digital Probe" GCB_cmd {
                    }
                    [
                        position = 8256, 8224
                        rotation = left
                    ]

                    component "core/C function" wait_to_trip {
                        global_variables = "real time_acc;"
                        init_fnc = "/*Begin code section*/
time_acc = 0;
Trip = 0;
/*End code section*/"
                        input_terminals = "inherit boolean;inherit Reset;"
                        input_terminals_dimensions = "inherit;inherit"
                        input_terminals_feedthrough = "[\'\']"
                        input_terminals_show_labels = "False;False;"
                        output_fnc = "/*Begin code section*/
if(time_acc>=3.0){
    Trip = 1;
}
else{
    time_acc += execution_rate*boolean;
}
if(Reset ==1){
    time_acc = 0;
    Trip = 0;
}
/*End code section*/"
                        output_terminals = "real Trip;"
                        output_terminals_dimensions = "inherit"
                        output_terminals_feedthrough = "[\'\']"
                    }
                    [
                        position = 7616, 8296
                        size = 48, 48
                    ]

                    component "core/Digital Probe" GCB_control {
                    }
                    [
                        position = 7848, 8248
                        rotation = left
                    ]

                    component "core/Constant" Close {
                        execution_rate = "Ts"
                    }
                    [
                        position = 7992, 8248
                    ]

                    component "core/Logical operator" not {
                        operator = "NOT"
                    }
                    [
                        position = 7968, 8368
                        hide_name = True
                    ]

                    component "core/Signal switch" "Signal switch1" {
                    }
                    [
                        position = 8072, 8280
                        hide_name = True
                    ]

                    component "core/Logical operator" or {
                        operator = "OR"
                    }
                    [
                        position = 8072, 8400
                        hide_name = True
                    ]

                    component "core/SR Flip Flop" "SR Flip Flop1" {
                    }
                    [
                        position = 8168, 8296
                        hide_name = True
                    ]

                    component "core/Logical operator" and {
                        inputs = "5"
                    }
                    [
                        position = 7792, 8296
                    ]

                    component "core/Termination" Termination12 {
                    }
                    [
                        position = 8248, 8312
                        hide_name = True
                    ]

                    component "core/Bus Split" "Bus Split1" {
                        outputs = "3"
                    }
                    [
                        position = 7488, 8032
                        rotation = right
                        hide_name = True
                    ]

                    component "core/Edge Detection" "Edge Detection1" {
                    }
                    [
                        position = 7536, 8320
                        hide_name = True
                        size = 32, 32
                    ]

                    port ss_speed {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7728, 8200
                        rotation = right
                    ]

                    port phase_match {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8232
                        rotation = right
                    ]

                    port Gen_on {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7880, 8368
                    ]

                    port f_match {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7680, 8432
                        rotation = left
                    ]

                    port GCB {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8304, 8280
                    ]

                    port GCB_Control {
                        position = top:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7488, 7960
                        rotation = right
                    ]

                    port V_match {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7712, 8408
                        rotation = left
                    ]

                    tag Goto31 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto30 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8096
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From36 {
                        value = "GridFollow"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7432, 8288
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto29 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = in
                    }
                    [
                        position = 7592, 8072
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From35 {
                        value = "StandBy"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 7888, 8432
                        hide_name = True
                        size = 0, 0
                    ]

                    tag From34 {
                        value = "GridForm"
                        scope = local
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8000, 8184
                        hide_name = True
                        size = 0, 0
                    ]

                    junction Junction32 sp
                    [
                        position = 8256, 8280
                    ]

                    junction Junction34 sp
                    [
                        position = 7848, 8296
                    ]

                    junction Junction35 sp
                    [
                        position = 7488, 8288
                    ]

                    connect "Bus Split1.in" GCB_Control as Connection541
                    connect "Bus Split1.out" Goto29 as Connection542
                    connect Close.out "Signal switch1.in" as Connection129
                    connect "Edge Detection1.In1" Junction35 as Connection559
                    connect From34 "Signal switch1.in2" as Connection534
                    connect From35 or.in1 as Connection535
                    connect GCB_cmd.in Junction32 as Connection528
                    connect Gen_on not.in as Connection517
                    connect Goto30 "Bus Split1.out1" as Connection543
                    connect Goto31 "Bus Split1.out2" as Connection544
                    connect Junction32 GCB as Connection529
                    connect Junction34 GCB_control.in as Connection551
                    connect Junction35 From36 as Connection560
                    connect "SR Flip Flop1.out" Junction32 as Connection530
                    connect "Signal switch1.in1" Junction34 as Connection550
                    connect "Signal switch1.out" "SR Flip Flop1.s_in" as Connection527
                    connect Termination12.in "SR Flip Flop1.out_n" as Connection55
                    connect V_match and.in4 as Connection557
                    connect and.out Junction34 as Connection552
                    connect f_match and.in3 as Connection556
                    connect or.out "SR Flip Flop1.r_in" as Connection501
                    connect or.in not.out as Connection499
                    connect phase_match and.in1 as Connection554
                    connect ss_speed and.in as Connection553
                    connect wait_to_trip.Reset "Edge Detection1.Out1" as Connection562
                    connect wait_to_trip.boolean Junction35 as Connection561
                    connect wait_to_trip.Trip and.in2 as Connection555
                }
                [
                    position = 9280, 8392
                    size = 176, 168
                ]

                component Subsystem Output {
                    layout = dynamic

                    port GCB_status {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8080, 8160
                    ]

                    tag Goto7 {
                        value = "GCB_status"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8200, 8160
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto7 GCB_status as Connection630
                }
                [
                    position = 9392, 8624
                    size = 48, 48
                ]

                port V_grid {
                    position = left:11
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 7976
                ]

                port GCB {
                    position = bottom:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9464, 8392
                ]

                port To_Gen_Control {
                    position = right:11
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 9248, 8104
                ]

                port From_Gen_Control {
                    position = right:12
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8512, 8512
                ]

                port V_gen {
                    position = right:13
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 8184, 8296
                ]

                tag From42 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7944
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto36 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8656, 8056
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto25 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8608
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto34 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag From52 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "ss_speed"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8328
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto32 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8664, 7976
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto28 {
                    value = "dw_synch"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9120, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From50 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8456
                    hide_name = True
                    size = 60, 20
                ]

                tag From47 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8824, 8216
                    hide_name = True
                    size = 60, 20
                ]

                tag From48 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8456, 7936
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto31 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9176, 8512
                    hide_name = True
                    size = 60, 20
                ]

                tag From44 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9280, 8240
                    rotation = right
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto29 {
                    value = "GCB_control"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8792, 8664
                    hide_name = True
                    size = 60, 20
                ]

                tag From53 {
                    value = "Activate"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8472
                    hide_name = True
                    size = 60, 20
                ]

                tag From49 {
                    value = "dV"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7992
                    hide_name = True
                    size = 60, 20
                ]

                tag From55 {
                    value = "Grid_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8744
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto33 {
                    value = "V_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8784, 8016
                    hide_name = True
                    size = 60, 20
                ]

                tag From45 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8672
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9088, 7968
                    hide_name = True
                    size = 60, 20
                ]

                tag From37 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8392
                    hide_name = True
                    size = 60, 20
                ]

                tag From46 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto30 {
                    value = "GridFollow"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8736, 8720
                    hide_name = True
                    size = 60, 20
                ]

                tag From39 {
                    value = "Gen_On"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9104, 8424
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8368, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From56 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 9296, 8624
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8920, 8632
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto20 {
                    value = "GCB_status"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 9480, 8352
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto22 {
                    value = "f_match"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8680, 8216
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction26 sp
                [
                    position = 9424, 8392
                ]

                junction Junction32 sp
                [
                    position = 9056, 8216
                ]

                junction Junction34 sp
                [
                    position = 8744, 8136
                ]

                junction Junction35 sp
                [
                    position = 8624, 8216
                ]

                junction Junction39 sp
                [
                    position = 9120, 8536
                ]

                junction Junction40 sp
                [
                    position = 8728, 8016
                ]

                junction Junction41 sp
                [
                    position = 8608, 7976
                ]

                junction Junction42 sp
                [
                    position = 9160, 8328
                ]

                junction Junction43 sp
                [
                    position = 8616, 8680
                ]

                junction Junction44 sp
                [
                    position = 8744, 8296
                ]

                junction Junction45 sp
                [
                    position = 8720, 8360
                ]

                junction Junction46 sp
                [
                    position = 8528, 8440
                ]

                connect "Bus Join2.in1" "Bus Split1.out2" as Connection601
                connect "Bus Join2.in" "Bus Split1.out1" as Connection600
                connect "Bus Join2.in2" Junction43 as Connection603
                connect "Bus Split1.in" From_Gen_Control as Connection598
                connect "Bus Split1.out" Goto25 as Connection546
                connect Check_phase_ON.in Junction46 as Connection622
                connect Contactor_Control.ss_speed Junction42 as Connection594
                connect Contactor_Control.phase_match Junction45 as Connection618
                connect From37 Contactor_Control.f_match as Connection270
                connect From39 Contactor_Control.Gen_on as Connection271
                connect From40 Junction42 as Connection596
                connect From41 "Bus Join.in1" as Connection528
                connect From42 "Bus Join.in" as Connection527
                connect From44 Contactor_Control.GCB_Control as Connection541
                connect From47 Calculate_dw_synch.Activate as Connection556
                connect From48 check_V_diff.Activate as Connection586
                connect From49 "Bus Join.in2" as Connection569
                connect From50 Contactor_Control.V_match as Connection574
                connect From52 and2.in3 as Connection584
                connect From53 and1.in1 as Connection585
                connect From55 and2.in4 as Connection609
                connect From56 Output.GCB_status as Connection625
                connect GCB Junction26 as Connection141
                connect Goto20 Junction26 as Connection143
                connect Goto28 Junction32 as Connection250
                connect Goto29 "Bus Join2.out" as Connection540
                connect Goto30 Junction43 as Connection605
                connect Goto31 Junction39 as Connection561
                connect Goto32 Junction41 as Connection575
                connect Goto33 Junction40 as Connection571
                connect Goto34 "Bus Split1.out4" as Connection606
                connect Goto36 check_V_diff.Grid_On as Connection608
                connect Junction26 Contactor_Control.GCB as Connection204
                connect Junction32 Calculate_dw_synch.dw_synch as Connection249
                connect Junction34 Calculate_dw_synch.dw_f as Connection280
                connect Junction35 Goto22 as Connection283
                connect Junction39 and2.out as Connection562
                connect Junction40 check_V_diff.V_match as Connection572
                connect Junction41 check_V_diff.dV as Connection576
                connect Junction42 Speed_ss.in as Connection595
                connect Junction43 "Bus Split1.out3" as Connection604
                connect Junction44 Calculate_dw_synch.dw_phase as Connection616
                connect Junction45 Phase_match.in as Connection619
                connect Junction46 and1.out as Connection623
                connect To_Gen_Control "Bus Join.out" as Connection259
                connect V_gen PLLs.V_Gen as Connection587
                connect V_grid PLLs.V_Grid as Connection588
                connect V_match.in Junction40 as Connection573
                connect and1.in From30 as Connection273
                connect and2.in1 From45 as Connection553
                connect and2.in2 From46 as Connection554
                connect and2.in not.out as Connection552
                connect check_V_diff.Vgen PLLs.Vgen as Connection565
                connect check_V_diff.Vgrid PLLs.Vgrid as Connection566
                connect check_f_diff.dw_f Junction34 as Connection281
                connect check_f_diff.f_match Junction35 as Connection284
                connect check_f_diff.f_Grid PLLs.f_Grid as Connection278
                connect check_f_diff.f_Gen PLLs.f_Gen as Connection277
                connect check_phase_diff.dw_phase Junction44 as Connection617
                connect check_phase_diff.phase_match Junction45 as Connection620
                connect check_phase_diff.Activate Junction46 as Connection624
                connect check_phase_diff.phase_Diff "PLLs.Phase diff" as Connection621
                connect dV.in Junction41 as Connection577
                connect dw_f.in Junction34 as Connection279
                connect dw_phase.in Junction44 as Connection615
                connect dw_synch.in Junction32 as Connection248
                connect dw_synch_ON.in Junction39 as Connection563
                connect f_match.in Junction35 as Connection282
                connect not.in From33 as Connection551
            }
            [
                position = 9448, 8056
                scale = -1, 1
                size = 144, 200
            ]

            component Subsystem Output {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "14"
                }
                [
                    position = 8008, 8216
                    rotation = down
                    hide_name = True
                    scale = -1, -1
                ]

                port Output {
                    position = right:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8112, 8216
                ]

                tag From32 {
                    value = "GCB_status"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7680, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "w_meas"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7656, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Gen_On"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7632, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7872, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7776, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7920, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7728, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7944, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From22 {
                    value = "Vc"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7752, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7704, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7896, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7800, 8384
                    rotation = left
                    hide_name = True
                    size = 60, 20
                ]

                connect "Bus Join1.out" Output as Connection4
                connect From21 "Bus Join1.in8" as Connection572
                connect From22 "Bus Join1.in5" as Connection569
                connect From23 "Bus Join1.in4" as Connection568
                connect From24 "Bus Join1.in7" as Connection571
                connect From25 "Bus Join1.in3" as Connection567
                connect From26 "Bus Join1.in9" as Connection573
                connect From27 "Bus Join1.in13" as Connection577
                connect From28 "Bus Join1.in12" as Connection576
                connect From29 "Bus Join1.in11" as Connection575
                connect From30 "Bus Join1.in10" as Connection574
                connect From31 "Bus Join1.in6" as Connection570
                connect From32 "Bus Join1.in2" as Connection578
                connect From33 "Bus Join1.in1" as Connection580
                connect From34 "Bus Join1.in" as Connection579
            }
            [
                position = 9696, 7968
                size = 104, 96
            ]

            component Subsystem Measurements {
                layout = dynamic
                component "core/Gain" Gain8 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7568
                    hide_name = True
                ]

                component "core/Probe" e_f {
                }
                [
                    position = 7760, 7776
                ]

                component "core/Gain" Gain7 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7632
                    hide_name = True
                ]

                component "core/Bus Join" "Bus Join3" {
                    inputs = "3"
                }
                [
                    position = 8080, 7792
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Bus Join" "Bus Join1" {
                    inputs = "4"
                }
                [
                    position = 8016, 7544
                    rotation = right
                    hide_name = True
                    scale = -1, -1
                ]

                component "core/Probe" pf {
                    addr = "17951"
                }
                [
                    position = 7704, 7696
                ]

                component "core/Probe" P {
                    addr = "17965"
                }
                [
                    position = 7704, 7504
                ]

                component "core/Probe" Q {
                    addr = "17938"
                }
                [
                    position = 7704, 7568
                ]

                component "core/Probe" S {
                    addr = "17951"
                }
                [
                    position = 7704, 7632
                ]

                component "core/Gain" Gain10 {
                    gain = "1.0/(2*np.pi*f)"
                }
                [
                    position = 7696, 7776
                    hide_name = True
                ]

                component "core/Gain" Gain9 {
                    gain = "1.0/Sb"
                }
                [
                    position = 7640, 7504
                    hide_name = True
                ]

                component "core/Current Measurement" Ib {
                    addr = "24"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8176
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Current Measurement" Ic {
                    addr = "26"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8272
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7944, 8336
                    rotation = right
                    size = 64, 32
                ]

                component "core/Current Measurement" Ia {
                    addr = "22"
                    execution_rate = "Ts"
                    frequency = "10000.0"
                    sig_output = "True"
                }
                [
                    position = 8096, 8080
                    scale = -1, 1
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7856, 8432
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 7904, 8384
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Output {
                    layout = dynamic

                    port Va {
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8120
                    ]

                    port Vb {
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8152
                    ]

                    port Vc {
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8192
                    ]

                    port Vt {
                        position = left:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8224
                    ]

                    port Ia {
                        position = left:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8264
                    ]

                    port Ib {
                        position = left:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8296
                    ]

                    port Ic {
                        position = left:7
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8336
                    ]

                    port P {
                        position = left:8
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8368
                    ]

                    port Q {
                        position = left:9
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8408
                    ]

                    port S {
                        position = left:10
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8160, 8440
                    ]

                    port pf {
                        position = left:11
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8112, 8480
                    ]

                    tag Goto8 {
                        value = "Vb"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8152
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto9 {
                        value = "Vc"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8192
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto10 {
                        value = "Vt"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8224
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto11 {
                        value = "Ib"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8296
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto12 {
                        value = "P"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8368
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto13 {
                        value = "Ic"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8336
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto14 {
                        value = "Ia"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8264
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto15 {
                        value = "Q"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8408
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto16 {
                        value = "S"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8440
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto17 {
                        value = "pf"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8480
                        hide_name = True
                        size = 0, 0
                    ]

                    tag Goto7 {
                        value = "Va"
                        scope = masked_subsystem
                        kind = sp
                        direction = in
                    }
                    [
                        position = 8256, 8120
                        hide_name = True
                        size = 0, 0
                    ]

                    connect Goto10 Vt as Connection4
                    connect Goto13 Ic as Connection7
                    connect Goto14 Ia as Connection5
                    connect Goto15 Q as Connection9
                    connect Goto17 pf as Connection11
                    connect Goto8 Vb as Connection2
                    connect Goto9 Vc as Connection3
                    connect Ib Goto11 as Connection6
                    connect P Goto12 as Connection8
                    connect S Goto16 as Connection10
                    connect Va Goto7 as Connection1
                }
                [
                    position = 8416, 7720
                    size = 96, 328
                ]

                component Subsystem "PQ measure" {
                    layout = dynamic
                    component "core/Power Meter" "PQ Power Meter1" {
                    }
                    [
                        position = 8096, 8192
                    ]

                    component "core/Termination" Termination2 {
                    }
                    [
                        position = 8264, 8232
                        rotation = left
                        hide_name = True
                        scale = -1, -1
                    ]

                    component "core/Termination" Termination1 {
                    }
                    [
                        position = 8264, 8152
                        rotation = left
                        hide_name = True
                        scale = -1, 1
                    ]

                    port S {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8264
                        rotation = right
                        scale = -1, 1
                    ]

                    port pf {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8288
                        rotation = right
                        scale = -1, 1
                    ]

                    port Q {
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8208, 8120
                        rotation = left
                        scale = -1, 1
                    ]

                    port P {
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8168, 8088
                        rotation = left
                        scale = -1, 1
                    ]

                    port Va {
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8088
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vb {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8120
                        rotation = right
                        scale = -1, 1
                    ]

                    port Vc {
                        position = right:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8152
                        rotation = right
                        scale = -1, 1
                    ]

                    port Ia {
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7912, 8224
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ib {
                        position = right:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7960, 8256
                        rotation = left
                        scale = -1, 1
                    ]

                    port Ic {
                        position = right:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 8016, 8288
                        rotation = left
                        scale = -1, 1
                    ]

                    connect "PQ Power Meter1.ia" Ia as Connection1
                    connect "PQ Power Meter1.ib" Ib as Connection2
                    connect "PQ Power Meter1.ic" Ic as Connection3
                    connect "PQ Power Meter1.Pdc" P as Connection4
                    connect "PQ Power Meter1.Qdc" Q as Connection5
                    connect S "PQ Power Meter1.apparent" as Connection9
                    connect Termination1.in "PQ Power Meter1.Pac" as Connection10
                    connect Termination2.in "PQ Power Meter1.Qac" as Connection11
                    connect Va "PQ Power Meter1.va" as Connection13
                    connect Vb "PQ Power Meter1.vb" as Connection14
                    connect Vc "PQ Power Meter1.vc" as Connection15
                    connect pf "PQ Power Meter1.k_factor" as Connection12
                }
                [
                    position = 7424, 7600
                    scale = -1, 1
                    size = 128, 232
                ]

                component Subsystem 3ph_PLL_Gen {
                    layout = dynamic
                    component "core/Termination" Term {
                    }
                    [
                        position = 8080, 8144
                        rotation = left
                        hide_name = True
                    ]

                    component "core/Termination" Term1 {
                    }
                    [
                        position = 8112, 8184
                        rotation = left
                        hide_name = True
                    ]

                    component Subsystem PLL {
                        layout = dynamic
                        component "core/Rate Limiter" "Rate Limiter1" {
                            falling_limit = "2*np.pi*w_fall"
                            rising_limit = "2*np.pi*w_rise"
                        }
                        [
                            position = 8304, 7984
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q1 {
                            a_coeff = "[1,2*zeta*(2*np.pi*fc_w),(2*np.pi*fc_w)**2.0]"
                            b_coeff = "(2*np.pi*fc_w)**2.0"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 8376, 7984
                            hide_name = True
                        ]

                        component "core/C function" integrator {
                            init_fnc = "/*Begin code section*/
out = 0;
in = 0;
/*End code section*/"
                            input_terminals_dimensions = "inherit"
                            input_terminals_feedthrough = "[\'\']"
                            output_fnc = "/*Begin code section*/
out += execution_rate*in;
if(in>=0.0){
    if(out >= 6.283185307179586)
    {
        out -= 6.283185307179586;
    }
}
else{
        if(out <= -6.283185307179586)
    {
        out += 6.283185307179586;
    }
}
/*End code section*/"
                            output_terminals = "inherit out;"
                            output_terminals_dimensions = "inherit"
                            output_terminals_feedthrough = "[\'\']"
                        }
                        [
                            position = 8352, 8136
                            size = 0, 0
                        ]

                        component "core/Termination" Term {
                        }
                        [
                            position = 7864, 8208
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Unit Delay" "Unit Delay1" {
                        }
                        [
                            position = 8432, 8224
                            rotation = right
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_q {
                            a_coeff = "[1.0/(2*np.pi*fc_q),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7912, 8152
                            hide_name = True
                        ]

                        component "core/Discrete Transfer Function" LPF_d {
                            a_coeff = "[1.0/(2*np.pi*fc_d),1]"
                            b_coeff = "1"
                            domain = "S-domain"
                            method = "Bilinear"
                        }
                        [
                            position = 7856, 8120
                            hide_name = True
                        ]

                        component Subsystem Normalize {
                            layout = dynamic
                            component "core/C function" V_terminal {
                                init_fnc = "/*Begin code section*/
d = 0;
q = 0;
t = 0;
/*End code section*/"
                                input_terminals = "real d;inherit q;"
                                input_terminals_dimensions = "inherit;inherit"
                                input_terminals_feedthrough = "[u\'\']"
                                input_terminals_show_labels = "False;False;"
                                output_fnc = "/*Begin code section*/
t = (powf(d,2.0)+powf(q,2.0));
t = sqrt(t);
if(t<0.1){
    q_pu = q/0.1;
}
else{
    q_pu = q/t;
}
/*End code section*/"
                                output_terminals = "real t;inherit q_pu;"
                                output_terminals_dimensions = "inherit;inherit"
                                output_terminals_feedthrough = "[u\'\']"
                                output_terminals_show_labels = "False;False;"
                            }
                            [
                                position = 8192, 8192
                                size = 0, 0
                            ]

                            port d {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8152
                            ]

                            port q {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8048, 8216
                            ]

                            port q_pu {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8352, 8200
                            ]

                            port Vt {
                                position = top:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8280, 8104
                                rotation = left
                            ]

                            connect V_terminal.t Vt as Connection8
                            connect V_terminal.d d as Connection1
                            connect V_terminal.q q as Connection3
                            connect q_pu V_terminal.q_pu as Connection9
                        }
                        [
                            position = 8096, 8136
                            size = 64, 64
                        ]

                        component Subsystem PI {
                            layout = dynamic
                            component "core/Sum" Sum7 {
                            }
                            [
                                position = 8072, 8400
                            ]

                            component "core/Limit" Limit1 {
                                lower_limit = "lowLim*2*np.pi*f/100.0"
                                upper_limit = "upLim*2*np.pi*f/100.0"
                            }
                            [
                                position = 8416, 8224
                            ]

                            component "core/Gain" Kp {
                                gain = "Kp"
                            }
                            [
                                position = 7928, 8136
                            ]

                            component "core/Integrator" Integrator2 {
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8112, 8304
                                scale = -1, 1
                            ]

                            component "core/Sum" Sum8 {
                                signs = "+-"
                            }
                            [
                                position = 8032, 8224
                            ]

                            component "core/Gain" Gain1 {
                                gain = "2*np.pi*fc_Kd"
                            }
                            [
                                position = 8152, 8224
                            ]

                            component "core/Gain" Ki {
                                gain = "Ki"
                            }
                            [
                                position = 7928, 8392
                            ]

                            component "core/Integrator" Integrator1 {
                                init_value = "2*np.pi*f"
                                limit_lower = "-1"
                                limit_upper = "1"
                            }
                            [
                                position = 8200, 8400
                            ]

                            component "core/Gain" Kb {
                            }
                            [
                                position = 8200, 8488
                                scale = -1, 1
                            ]

                            component "core/Gain" Kd {
                                gain = "Kd"
                            }
                            [
                                position = 7928, 8216
                            ]

                            component "core/Sum" Sum5 {
                                signs = "3"
                            }
                            [
                                position = 8328, 8224
                            ]

                            component "core/Sum" Sum6 {
                                signs = "-+"
                            }
                            [
                                position = 8328, 8488
                                scale = -1, 1
                            ]

                            port In {
                                label = "In"
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7752, 8216
                            ]

                            port Out {
                                label = "Out"
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8480, 8224
                            ]

                            junction Junction2 sp
                            [
                                position = 8376, 8224
                            ]

                            junction Junction3 sp
                            [
                                position = 8448, 8224
                            ]

                            junction Junction7 sp
                            [
                                position = 8224, 8224
                            ]

                            junction Junction8 sp
                            [
                                position = 7792, 8216
                            ]

                            junction Junction9 sp
                            [
                                position = 7792, 8216
                            ]

                            connect Gain1.out Junction7 as Connection85
                            connect Gain1.in Sum8.out as Connection61
                            connect In Junction9 as Connection94
                            connect Integrator1.out Sum5.in2 as Connection95
                            connect Integrator2.out Sum8.in1 as Connection66
                            connect Junction2 Limit1.in as Connection45
                            connect Junction3 Out as Connection48
                            connect Junction7 Integrator2.in as Connection86
                            connect Junction8 Kd.in as Connection90
                            connect Junction9 Junction8 as Connection93
                            connect Kb.in Sum6.out as Connection50
                            connect Kd.out Sum8.in as Connection80
                            connect Ki.in Junction9 as Connection92
                            connect Kp.in Junction8 as Connection89
                            connect Kp.out Sum5.in as Connection68
                            connect Limit1.out Junction3 as Connection47
                            connect Sum5.out Junction2 as Connection44
                            connect Sum5.in1 Junction7 as Connection87
                            connect Sum6.in Junction2 as Connection46
                            connect Sum6.in1 Junction3 as Connection49
                            connect Sum7.out Integrator1.in as Connection52
                            connect Sum7.in1 Kb.out as Connection53
                            connect Sum7.in Ki.out as Connection69
                        }
                        [
                            position = 8200, 8136
                            size = 64, 48
                        ]

                        component Subsystem ABC_dqz {
                            layout = dynamic
                            component "core/abc to alpha beta" "abc to alpha beta" {
                            }
                            [
                                position = 8024, 8192
                            ]

                            component "core/alpha beta to dq" "alpha beta to dq" {
                            }
                            [
                                position = 8248, 8192
                            ]

                            port A {
                                position = left:1
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7952, 8104
                                rotation = right
                            ]

                            port B {
                                position = left:2
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7904, 8104
                                rotation = right
                            ]

                            port C {
                                position = left:3
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 7856, 8104
                                rotation = right
                            ]

                            port wt {
                                position = left:4
                                kind = sp
                                direction =  out
                                sp_type {
                                    default = auto
                                    readonly = True
                                }
                            }
                            [
                                position = 8176, 8288
                                rotation = left
                            ]

                            port d {
                                position = right:1
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8320, 8136
                                rotation = left
                            ]

                            port q {
                                position = right:2
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8368, 8136
                                rotation = left
                            ]

                            port z {
                                position = right:3
                                kind = sp
                                direction =  in
                                sp_type {
                                    default = inherit
                                    readonly = True
                                }
                            }
                            [
                                position = 8096, 8288
                                rotation = right
                            ]

                            connect "abc to alpha beta.A" A as Connection2685
                            connect "abc to alpha beta.B" B as Connection2686
                            connect "abc to alpha beta.C" C as Connection2687
                            connect "abc to alpha beta.beta" "alpha beta to dq.beta" as Connection2689
                            connect "alpha beta to dq.alpha" "abc to alpha beta.alpha" as Connection2688
                            connect "alpha beta to dq.wt" wt as Connection2690
                            connect d "alpha beta to dq.d" as Connection2692
                            connect q "alpha beta to dq.q" as Connection2693
                            connect z "abc to alpha beta.gamma" as Connection2691
                        }
                        [
                            position = 7776, 8152
                            size = 48, 104
                        ]

                        port A {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7608, 8152
                            rotation = left
                        ]

                        port B {
                            label = "B"
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8176
                            rotation = left
                        ]

                        port C {
                            label = "C"
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7688, 8200
                            rotation = left
                        ]

                        port d {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8024
                        ]

                        port q {
                            label = "q"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8080
                        ]

                        port Vt {
                            position = right:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8160, 8072
                        ]

                        port wt {
                            position = right:5
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8472, 8072
                        ]

                        port w {
                            position = right:4
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 7984
                        ]

                        junction Junction6 sp
                        [
                            position = 8408, 8136
                        ]

                        junction Junction13 sp
                        [
                            position = 8264, 8136
                        ]

                        junction Junction14 sp
                        [
                            position = 7960, 8120
                        ]

                        junction Junction15 sp
                        [
                            position = 8000, 8152
                        ]

                        connect ABC_dqz.A A as Connection266
                        connect ABC_dqz.B B as Connection267
                        connect ABC_dqz.C C as Connection268
                        connect ABC_dqz.d LPF_d.in as Connection263
                        connect ABC_dqz.q LPF_q.in as Connection264
                        connect ABC_dqz.z Term.in as Connection265
                        connect Junction13 integrator.in as Connection246
                        connect Junction14 Normalize.d as Connection253
                        connect Junction14 d as Connection262
                        connect Junction15 q as Connection261
                        connect Junction6 integrator.out as Connection195
                        connect LPF_d.out Junction14 as Connection254
                        connect LPF_q.out Junction15 as Connection257
                        connect LPF_q1.in "Rate Limiter1.out" as Connection259
                        connect Normalize.q Junction15 as Connection255
                        connect Normalize.Vt Vt as Connection211
                        connect PI.Out Junction13 as Connection247
                        connect PI.In Normalize.q_pu as Connection244
                        connect "Rate Limiter1.in" Junction13 as Connection260
                        connect "Unit Delay1.out" ABC_dqz.wt as Connection269
                        connect "Unit Delay1.in" Junction6 as Connection194
                        connect w LPF_q1.out as Connection258
                        connect wt Junction6 as Connection196

                        f = "f"
                        lowLim = "70"
                        upLim = "140"
                        w_fall = "-f/5"
                        w_rise = "f/5"

                        mask {
                            description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Simple PLL with wrapped wt</span></p></body></html>"

                            Kp {
                                label = "Proportional gain"
                                widget = edit
                                type = generic
                                default_value = "100.0"
                            }

                            Ki {
                                label = "Integral gain"
                                widget = edit
                                type = generic
                                default_value = "3200.0"
                            }

                            Kd {
                                label = "Differential gain"
                                widget = edit
                                type = generic
                                default_value = "1.0"
                            }

                            fc_Kd {
                                label = "Derivative control LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "113.6821"
                            }

                            fc_d {
                                label = "d channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            fc_q {
                                label = "q channel LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "10.0"
                                unit = "Hz"
                            }

                            f {
                                label = "Target frequency"
                                widget = edit
                                type = generic
                                default_value = "60.0"
                                unit = "Hz"
                            }

                            upLim {
                                label = "Frequency deviation upper limit"
                                widget = edit
                                type = generic
                                default_value = "10"
                                unit = "%"
                            }

                            lowLim {
                                label = "Frequency deviation lower limit"
                                widget = edit
                                type = generic
                                default_value = "-10"
                                unit = "%"
                            }

                            zeta {
                                label = "w 2nd order LPF damping ratio"
                                widget = edit
                                type = generic
                                default_value = "0.707"
                            }

                            fc_w {
                                label = "w 2nd order LPF cut-off freq."
                                widget = edit
                                type = generic
                                default_value = "25.0"
                                unit = "Hz"
                            }

                            Ts {
                                label = "Execution rate"
                                widget = edit
                                type = generic
                                default_value = "Ts"
                            }

                            w_rise {
                                label = "w Rising rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            w_fall {
                                label = "w Falling rate"
                                widget = edit
                                type = generic
                                default_value = "0"
                                unit = "Hz/s"
                            }

                            CODE open
                                from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                            
                                dialog = RegularComponentPropertiesDialog(
                                    component=component,
                                    property_container=component.masks[-1],
                                    current_diagram=current_diagram
                                )
                                dialog.exec_()
                            
                            ENDCODE
                        }
                    }
                    [
                        position = 7984, 8240
                        rotation = down
                        scale = -1, -1
                        size = 72, 152
                    ]

                    port Va {
                        label = "Va"
                        position = left:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8184
                    ]

                    port Vb {
                        label = "Vb"
                        position = left:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8240
                    ]

                    port Vc {
                        label = "Vc"
                        position = left:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7896, 8296
                    ]

                    port Vt {
                        position = right:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8136, 8240
                    ]

                    port w {
                        position = right:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8104, 8264
                    ]

                    port wt {
                        position = right:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8072, 8288
                    ]

                    connect PLL.d Term.in as Connection4
                    connect PLL.A Va as Connection1
                    connect PLL.C Vc as Connection3
                    connect PLL.Vt Vt as Connection6
                    connect PLL.wt wt as Connection8
                    connect Term1.in PLL.q as Connection5
                    connect Vb PLL.B as Connection2
                    connect w PLL.w as Connection7
                }
                [
                    position = 7480, 7824
                    size = 72, 120
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R21 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8232, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R20 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8304, 7944
                        rotation = right
                    ]

                    component "core/Resistor" R22 {
                        resistance = "(Vn**2/(Sb*load/100.0))*1e6/(Vn**2/(Sb*load/100.0)+1e6)"
                    }
                    [
                        position = 8376, 7944
                        rotation = right
                    ]

                    port G {
                        position = bottom:3
                        kind = pe
                    }
                    [
                        position = 8304, 8112
                        rotation = left
                    ]

                    port A {
                        position = top:4
                        kind = pe
                    }
                    [
                        position = 8232, 7848
                        rotation = right
                    ]

                    port B {
                        position = top:5
                        kind = pe
                    }
                    [
                        position = 8304, 7848
                        rotation = right
                    ]

                    port C {
                        position = top:6
                        kind = pe
                    }
                    [
                        position = 8376, 7848
                        rotation = right
                    ]

                    junction Junction1516 pe
                    [
                        position = 8304, 8032
                    ]

                    junction Junction1517 pe
                    [
                        position = 8304, 8032
                    ]

                    connect A R21.p_node as Connection758
                    connect B R20.p_node as Connection759
                    connect G Junction1517 as Connection764
                    connect Junction1516 Junction1517 as Connection762
                    connect Junction1516 R21.n_node as Connection755
                    connect Junction1517 R22.n_node as Connection763
                    connect R20.n_node Junction1516 as Connection698
                    connect R22.p_node C as Connection760
                }
                [
                    position = 7664, 8384
                    size = 88, 80
                ]

                port a {
                    label = "a"
                    position = right:1
                    kind = pe
                }
                [
                    position = 8208, 8080
                    rotation = down
                ]

                port b {
                    label = "b"
                    position = right:2
                    kind = pe
                }
                [
                    position = 8208, 8176
                    rotation = down
                ]

                port c {
                    label = "c"
                    position = right:3
                    kind = pe
                }
                [
                    position = 8208, 8272
                    rotation = down
                ]

                port A {
                    label = "A"
                    position = left:1
                    kind = pe
                }
                [
                    position = 7520, 8080
                ]

                port B {
                    label = "B"
                    position = left:2
                    kind = pe
                }
                [
                    position = 7520, 8176
                ]

                port C {
                    label = "C"
                    position = left:3
                    kind = pe
                }
                [
                    position = 7520, 8272
                ]

                port Sync_fb {
                    position = top:1
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8080, 7728
                    rotation = left
                    scale = -1, 1
                ]

                port Control_fb {
                    position = top:3
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8016, 7472
                    rotation = left
                    scale = -1, 1
                ]

                tag From22 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto4 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8032
                    hide_name = True
                    size = 60, 20
                ]

                tag From40 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From11 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7608
                    hide_name = True
                    size = 60, 20
                ]

                tag From10 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7696
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8384
                    hide_name = True
                    size = 60, 20
                ]

                tag From25 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7600
                    hide_name = True
                    size = 60, 20
                ]

                tag From31 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7672
                    hide_name = True
                    size = 60, 20
                ]

                tag From7 {
                    value = "Ia"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto10 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From23 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7624
                    hide_name = True
                    size = 60, 20
                ]

                tag From5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7584
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto11 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag From43 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7656
                    hide_name = True
                    size = 60, 20
                ]

                tag From32 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7936, 7632
                    hide_name = True
                    size = 60, 20
                ]

                tag From30 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7768
                    hide_name = True
                    size = 60, 20
                ]

                tag From8 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7648
                    hide_name = True
                    size = 60, 20
                ]

                tag From6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto12 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7704, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From33 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7880
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto5 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8136
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8432
                    hide_name = True
                    size = 60, 20
                ]

                tag From34 {
                    value = "Vt"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7912
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto8 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7552
                    hide_name = True
                    size = 60, 20
                ]

                tag From41 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7824
                    hide_name = True
                    size = 60, 20
                ]

                tag From4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7520
                    hide_name = True
                    size = 60, 20
                ]

                tag From35 {
                    value = "w"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7992, 7848
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8032, 8336
                    hide_name = True
                    size = 60, 20
                ]

                tag From27 {
                    value = "pf"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7840
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto7 {
                    value = "P"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7488
                    hide_name = True
                    size = 60, 20
                ]

                tag From42 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7280, 7784
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto9 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7568, 7616
                    hide_name = True
                    size = 60, 20
                ]

                tag From26 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7744
                    hide_name = True
                    size = 60, 20
                ]

                tag From21 {
                    value = "Ib"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7720
                    hide_name = True
                    size = 60, 20
                ]

                tag From9 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7296, 7680
                    hide_name = True
                    size = 60, 20
                ]

                tag From29 {
                    value = "Q"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8296, 7792
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto6 {
                    value = "Ic"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8152, 8232
                    hide_name = True
                    size = 60, 20
                ]

                tag Goto13 {
                    value = "wt"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7608, 7864
                    hide_name = True
                    size = 60, 20
                ]

                tag From28 {
                    value = "S"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8232, 7816
                    hide_name = True
                    size = 60, 20
                ]

                junction Junction1497 pe
                [
                    position = 7856, 8080
                ]

                junction Junction1518 sp
                [
                    position = 7520, 7504
                ]

                junction Junction1519 sp
                [
                    position = 7520, 7568
                ]

                junction Junction1520 sp
                [
                    position = 7520, 7632
                ]

                junction Junction1521 sp
                [
                    position = 7520, 7696
                ]

                junction Junction1525 pe
                [
                    position = 7904, 8176
                ]

                junction Junction1528 pe
                [
                    position = 7944, 8272
                ]

                junction Junction1534 pe
                [
                    position = 7904, 8504
                ]

                junction Junction1535 pe
                [
                    position = 7856, 8504
                ]

                junction Junction1536 pe
                [
                    position = 7640, 8080
                ]

                junction Junction1537 pe
                [
                    position = 7664, 8176
                ]

                junction Junction1538 pe
                [
                    position = 7688, 8272
                ]

                junction Junction1540 sp
                [
                    position = 7648, 7824
                ]

                connect 3ph_PLL_Gen.Va From42 as Connection925
                connect 3ph_PLL_Gen.Vt Goto11 as Connection924
                connect 3ph_PLL_Gen.w Junction1540 as Connection926
                connect B Junction1537 as Connection888
                connect "Bus Join1.in" From10 as Connection911
                connect "Bus Join1.in1" From11 as Connection908
                connect "Bus Join1.in2" From32 as Connection910
                connect C Junction1538 as Connection891
                connect Control_fb "Bus Join1.out" as Connection912
                connect From21 Output.Ib as Connection914
                connect From22 Output.Vc as Connection921
                connect From23 Output.Vb as Connection913
                connect From24 Output.Ia as Connection916
                connect From25 Output.Va as Connection918
                connect From26 Output.Ic as Connection920
                connect From27 Output.pf as Connection917
                connect From28 Output.S as Connection919
                connect From29 Output.Q as Connection922
                connect From30 Output.P as Connection915
                connect From31 Output.Vt as Connection923
                connect From33 "Bus Join3.in1" as Connection783
                connect From34 "Bus Join3.in2" as Connection784
                connect From35 "Bus Join3.in" as Connection782
                connect From4 "PQ measure.Va" as Connection714
                connect From40 3ph_PLL_Gen.Vc as Connection899
                connect From41 3ph_PLL_Gen.Vb as Connection898
                connect From43 "Bus Join1.in3" as Connection909
                connect From5 "PQ measure.Vc" as Connection716
                connect From6 "PQ measure.Vb" as Connection715
                connect From7 "PQ measure.Ia" as Connection717
                connect From8 "PQ measure.Ib" as Connection718
                connect From9 "PQ measure.Ic" as Connection719
                connect Gain10.in Junction1540 as Connection904
                connect Goto1 Va.out as Connection703
                connect Goto10 Junction1521 as Connection734
                connect Goto12 Junction1540 as Connection906
                connect Goto13 3ph_PLL_Gen.wt as Connection907
                connect Goto2 Vb.out as Connection705
                connect Goto3 Vc.out as Connection707
                connect Goto4 Ia.out as Connection708
                connect Goto5 Ib.out as Connection709
                connect Goto6 Ic.out as Connection710
                connect Goto7 Junction1518 as Connection725
                connect Goto8 Junction1519 as Connection728
                connect Goto9 Junction1520 as Connection731
                connect Ia.p_node a as Connection218
                connect Ib.p_node b as Connection212
                connect Ic.p_node c as Connection217
                connect Junction1497 Ia.n_node as Connection871
                connect Junction1497 Junction1536 as Connection885
                connect Junction1518 Gain9.in as Connection724
                connect Junction1519 Gain8.in as Connection727
                connect Junction1520 Gain7.in as Connection730
                connect Junction1521 "PQ measure.pf" as Connection733
                connect Junction1525 Ib.n_node as Connection870
                connect Junction1528 Ic.n_node as Connection867
                connect Junction1534 Junction1535 as Connection882
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Va.n_node as Connection883
                connect Junction1536 A as Connection886
                connect Junction1537 Junction1525 as Connection889
                connect Junction1538 Junction1528 as Connection892
                connect P.in Gain9.out as Connection158
                connect "PQ measure.P" Junction1518 as Connection723
                connect "PQ measure.Q" Junction1519 as Connection726
                connect "PQ measure.S" Junction1520 as Connection729
                connect Q.in Gain8.out as Connection161
                connect S.in Gain7.out as Connection192
                connect Snubber.G Junction1535 as Connection884
                connect Snubber.A Junction1536 as Connection887
                connect Snubber.B Junction1537 as Connection890
                connect Snubber.C Junction1538 as Connection893
                connect Sync_fb "Bus Join3.out" as Connection781
                connect Va.p_node Junction1497 as Connection487
                connect Vb.p_node Junction1525 as Connection833
                connect Vb.n_node Junction1534 as Connection839
                connect Vc.p_node Junction1528 as Connection806
                connect e_f.in Gain10.out as Connection824
                connect pf.in Junction1521 as Connection732
            }
            [
                position = 9248, 8320
                scale = -1, 1
                size = 112, 112
            ]

            component Subsystem Ggrid_meas {
                layout = dynamic
                component "core/Bus Join" "Bus Join1" {
                    inputs = "3"
                }
                [
                    position = 8744, 7984
                    rotation = left
                ]

                component "core/Voltage Measurement" Vc {
                    addr = "5"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8336, 8168
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Va {
                    addr = "3"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8248, 8264
                    rotation = right
                    size = 64, 32
                ]

                component "core/Voltage Measurement" Vb {
                    addr = "4"
                    execution_rate = "Ts"
                    sig_output = "True"
                }
                [
                    position = 8296, 8216
                    rotation = right
                    size = 64, 32
                ]

                component Subsystem Snubber {
                    layout = dynamic
                    component "core/Resistor" R1 {
                        resistance = "1e5"
                    }
                    [
                        position = 8120, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R2 {
                        resistance = "1e5"
                    }
                    [
                        position = 8192, 8144
                        rotation = right
                    ]

                    component "core/Resistor" R3 {
                        resistance = "1e5"
                    }
                    [
                        position = 8264, 8144
                        rotation = right
                    ]

                    port G {
                        position = bottom:1
                        kind = pe
                    }
                    [
                        position = 8192, 8296
                        rotation = left
                    ]

                    port A {
                        position = top:1
                        kind = pe
                    }
                    [
                        position = 8120, 8064
                        rotation = right
                    ]

                    port B {
                        position = top:2
                        kind = pe
                    }
                    [
                        position = 8192, 8064
                        rotation = right
                    ]

                    port C {
                        position = top:3
                        kind = pe
                    }
                    [
                        position = 8264, 8064
                        rotation = right
                    ]

                    junction Junction1490 pe
                    [
                        position = 8192, 8248
                    ]

                    junction Junction1491 pe
                    [
                        position = 8192, 8248
                    ]

                    connect G Junction1491 as Connection403
                    connect Junction1490 R1.n_node as Connection395
                    connect Junction1491 Junction1490 as Connection402
                    connect R1.p_node A as Connection399
                    connect R2.p_node B as Connection397
                    connect R2.n_node Junction1490 as Connection385
                    connect R3.p_node C as Connection398
                    connect R3.n_node Junction1491 as Connection401
                }
                [
                    position = 8104, 8248
                    size = 64, 48
                ]

                port V {
                    position = top:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8744, 7912
                    rotation = left
                ]

                port A {
                    position = left:1
                    kind = pe
                }
                [
                    position = 7992, 7912
                ]

                port B {
                    position = left:2
                    kind = pe
                }
                [
                    position = 7992, 8016
                ]

                port C {
                    position = left:3
                    kind = pe
                }
                [
                    position = 7992, 8120
                ]

                port a {
                    position = right:1
                    kind = pe
                }
                [
                    position = 8504, 7912
                    rotation = down
                ]

                port b {
                    position = right:2
                    kind = pe
                }
                [
                    position = 8504, 8016
                    rotation = down
                ]

                port c {
                    position = right:3
                    kind = pe
                }
                [
                    position = 8504, 8120
                    rotation = down
                ]

                tag From1 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8040
                    hide_name = True
                    size = 0, 0
                ]

                tag From2 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8080
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto6 {
                    value = "Vb"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8216
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto4 {
                    value = "Va"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8264
                    hide_name = True
                    size = 0, 0
                ]

                tag From3 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8648, 8120
                    hide_name = True
                    size = 0, 0
                ]

                tag Goto5 {
                    value = "Vc"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8424, 8168
                    hide_name = True
                    size = 0, 0
                ]

                junction Junction1492 pe
                [
                    position = 8088, 7912
                ]

                junction Junction1493 pe
                [
                    position = 8104, 8016
                ]

                junction Junction1494 pe
                [
                    position = 8120, 8120
                ]

                junction Junction1534 pe
                [
                    position = 8296, 8336
                ]

                junction Junction1535 pe
                [
                    position = 8336, 8120
                ]

                junction Junction1536 pe
                [
                    position = 8296, 8016
                ]

                junction Junction1537 pe
                [
                    position = 8248, 7912
                ]

                junction Junction1538 pe
                [
                    position = 8248, 8336
                ]

                connect A Junction1492 as Connection402
                connect B Junction1493 as Connection405
                connect "Bus Join1.in1" From2 as Connection431
                connect "Bus Join1.in2" From3 as Connection432
                connect C Junction1494 as Connection408
                connect From1 "Bus Join1.in" as Connection430
                connect Goto4 Va.out as Connection703
                connect Goto5 Vc.out as Connection707
                connect Goto6 Vb.out as Connection705
                connect Junction1492 Junction1537 as Connection855
                connect Junction1492 Snubber.A as Connection412
                connect Junction1493 Junction1536 as Connection852
                connect Junction1493 Snubber.B as Connection410
                connect Junction1494 Snubber.C as Connection411
                connect Junction1534 Junction1538 as Connection858
                connect Junction1534 Vc.n_node as Connection838
                connect Junction1535 Junction1494 as Connection850
                connect Junction1536 b as Connection853
                connect Junction1537 a as Connection856
                connect Junction1538 Va.n_node as Connection859
                connect Snubber.G Junction1538 as Connection860
                connect V "Bus Join1.out" as Connection366
                connect Va.p_node Junction1537 as Connection857
                connect Vb.n_node Junction1534 as Connection839
                connect Vb.p_node Junction1536 as Connection854
                connect Vc.p_node Junction1535 as Connection851
                connect c Junction1535 as Connection849
            }
            [
                position = 9608, 8320
                scale = -1, 1
                size = 56, 232
            ]

            component "core/Bus Split" bus_split {
            }
            [
                position = 8888, 8112
            ]

            port A {
                position = 180.0, -96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8224
                scale = -1, 1
            ]

            port B {
                position = 180.0, -0.1
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8320
                scale = -1, 1
            ]

            port C {
                position = 180.0, 96.0
                kind = pe
                direction =  out
            }
            [
                position = 9728, 8416
                scale = -1, 1
            ]

            port Inputs {
                position = -152.0, -120.0
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 9088, 7896
                rotation = right
                scale = -1, 1
            ]

            port Outputs {
                position = 152.0, -120.0
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 9816, 7920
                rotation = left
            ]

            junction Junction118 pe
            [
                position = 8800, 8240
            ]

            junction Junction122 pe
            [
                position = 8800, 8408
            ]

            connect A Ggrid_meas.A as Connection669
            connect B Ggrid_meas.B as Connection670
            connect C Ggrid_meas.C as Connection671
            connect Control.T_out Gen.load_in as Connection611
            connect Control.To_synch_check Sync_Check.From_Gen_Control as Connection673
            connect Gen.r_2 Junction122 as Connection664
            [
                position = 0, 0
                breakpoints = 8864, 8336; 8864, 8408
            ]
            connect Gen.c_in Measurements.c as Connection323
            connect Gen.b_in Measurements.b as Connection318
            connect Gen.a_in Measurements.a as Connection324
            connect Ggrid_meas.b MCB.b_in as Connection481
            connect Ggrid_meas.c MCB.c_in as Connection483
            connect Ggrid_meas.a MCB.a_in as Connection479
            connect If.n_node Junction118 as Connection601
            connect Inputs Control.Inputs as Connection668
            connect Junction118 Gen.r_1 as Connection600
            [
                position = 0, 0
                breakpoints = 8864, 8240; 8864, 8304
            ]
            connect Junction122 Vfield.n_node as Connection665
            connect Measurements.Control_fb Control.Meas_feedback as Connection500
            connect Measurements.B MCB.b_out as Connection613
            connect Measurements.C MCB.c_out as Connection614
            connect Measurements.A MCB.a_out as Connection612
            connect Output.Output Outputs as Connection667
            connect Sync_Check.To_Gen_Control Control.From_synch_check as Connection672
            connect Sync_Check.V_grid Ggrid_meas.V as Connection638
            connect Sync_Check.GCB MCB.ctrl_in as Connection637
            connect Sync_Check.V_gen Measurements.Sync_fb as Connection636
            connect Vfd.in Control.Vf_out as Connection649
            connect Vfd.p_node If.p_node as Connection663
            connect Vfd.n_node Junction122 as Connection666
            connect Vfield.p_node Junction118 as Connection599
            connect Gen.out bus_split.in as Connection674
            [
                position = 0, 0
                breakpoints = 8848, 8232; 8848, 8160
            ]
            connect bus_split.out Control.T_in as Connection675
            connect bus_split.out1 Control.wmeas as Connection676

            Sb = "1e6"
            Ts = "Ts"
            Vn = "480"
            phaseOff = "0.0"

            mask {
                icon = "image(\'diesel_genset.svg\')"
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Diesel Genset with synchronous machine, DEGOV governor, DC4B exciter, frequency setpoint control for w and P, power factor control loop and synch check with grid to close GCB contactor.</span></p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of variable inputs to this block is 9 and they must be sent through a Bus Join in the following order: 0 - Gen_On; 1 - Vref; 2 - wref; 3 - Pref; 4 - pf_ref; 5 - Gen_OP_mode; 6 - Gen_Control_Mode; 7 - Load_share_on; 8 - Load_share.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                                                                                                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">The number of outputs of this block is 14 and they are arranged in the following order: 0 - Gen_On; 1 - wmeas; 2 - GCB_status; 3 - Va; 4 - Vb; 5 - Vc; 6 - Vt; 7 - Ia; 8 - Ib; 9 - Ic; 10 - P; 11 - Q; 12 - S; 13 - pf.</span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">                                                                                                                                                                                    </span></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\"\">Adjustment of the shunt snubber load is important for simulation stability in multiple time steps.</span></p></body></html>"
                help_file = "diesel_genset.html"

                Sb {
                    label = "Nominal Power"
                    widget = edit
                    type = generic
                    default_value = "2.2e6"
                    unit = "VA"
                    group = "1 - Basic"
                }

                Vn {
                    label = "Phase Nominal Voltage"
                    widget = edit
                    type = generic
                    default_value = "480.0"
                    unit = "V (line to line)"
                    group = "1 - Basic"
                }

                f {
                    label = "Nominal electrical frequency"
                    widget = edit
                    type = generic
                    default_value = "60.0"
                    unit = "Hz"
                    group = "1 - Basic"
                }

                load {
                    label = "Shunt snubber load percentage of nominal power"
                    widget = edit
                    type = generic
                    default_value = "5"
                    unit = "%"
                    group = "1 - Basic"
                }

                Ts {
                    label = "Execution rate"
                    widget = edit
                    type = generic
                    default_value = "200e-6"
                    unit = "s"
                    group = "1 - Basic"
                }

                Rs {
                    label = "Rs"
                    widget = edit
                    type = generic
                    default_value = "9.4035e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Lls {
                    label = "Lls"
                    widget = edit
                    type = generic
                    default_value = "1.389e-5"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmd {
                    label = "Lmd"
                    widget = edit
                    type = generic
                    default_value = "6.5282e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Lmq {
                    label = "Lmq"
                    widget = edit
                    type = generic
                    default_value = "4.778e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rf_prime {
                    label = "Rf"
                    widget = edit
                    type = generic
                    default_value = "2.1574e-4"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llfd_prime {
                    label = "Llfd"
                    widget = edit
                    type = generic
                    default_value = "1.4195e-4"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkd {
                    label = "Rkd"
                    widget = edit
                    type = generic
                    default_value = "0.0443938909091"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Rkq {
                    label = "Rkq"
                    widget = edit
                    type = generic
                    default_value = "0.00399796363636"
                    unit = "Ω"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkd {
                    label = "Llkd"
                    widget = edit
                    type = generic
                    default_value = "0.00155586168397"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Llkq {
                    label = "Llkq"
                    widget = edit
                    type = generic
                    default_value = "9.96738215238e-05"
                    unit = "H"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nfd {
                    label = "Ns/Nfd"
                    widget = edit
                    type = generic
                    default_value = "0.02512"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkd {
                    label = "Ns/Nkd"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                Ns_Nkq {
                    label = "Ns/Nkq"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "2 - Synch. mach. - Elec."
                }

                pms {
                    label = "pms"
                    widget = edit
                    type = generic
                    default_value = "2.0"
                    group = "3- Synch. mach. - Mec."
                }

                J {
                    label = "Jm"
                    widget = edit
                    type = generic
                    default_value = "42.9467"
                    unit = "kg.m²"
                    group = "3- Synch. mach. - Mec."
                }

                F {
                    label = "Friction coefficient"
                    widget = edit
                    type = generic
                    default_value = "0.572003113298"
                    unit = "Nms"
                    group = "3- Synch. mach. - Mec."
                }

                T1 {
                    label = "Electric control box time constant 1"
                    widget = edit
                    type = generic
                    default_value = "1.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T2 {
                    label = "Electric control box time constant 2"
                    widget = edit
                    type = generic
                    default_value = "1e-6"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T3 {
                    label = "Electric control box time constant 3"
                    widget = edit
                    type = generic
                    default_value = "0.5001"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                K {
                    label = "Actuator gain K"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    group = "4 - Gov. and Eng."
                }

                T4 {
                    label = "Actuator time constant 4"
                    widget = edit
                    type = generic
                    default_value = "25.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T5 {
                    label = "Actuator time constant 5"
                    widget = edit
                    type = generic
                    default_value = "9.0e-4"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                T6 {
                    label = "Actuator time constant 6"
                    widget = edit
                    type = generic
                    default_value = "5.74e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Pm0 {
                    label = "Initial mechanical power"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmax {
                    label = "Maximum torque limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Tmin {
                    label = "Minimum torque limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "4 - Gov. and Eng."
                }

                Td {
                    label = "Engine time delay"
                    widget = edit
                    type = generic
                    default_value = "24.0e-3"
                    unit = "s"
                    group = "4 - Gov. and Eng."
                }

                Tr {
                    label = "Time constant Tr"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                exc_Kp {
                    label = "Exciter PI proportional gain"
                    widget = edit
                    type = generic
                    default_value = "0.025"
                    group = "5 - Exciter"
                }

                exc_Ki {
                    label = "Exciter PI integral gain"
                    widget = edit
                    type = generic
                    default_value = "0.007"
                    group = "5 - Exciter"
                }

                Ka {
                    label = "Major regulator gain Ka"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Ta {
                    label = "Major regulator time constant Ta"
                    widget = edit
                    type = generic
                    default_value = "2.0e-3"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vrmax {
                    label = "Saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vrmin {
                    label = "Saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Te {
                    label = "Exciter time constant Te"
                    widget = edit
                    type = generic
                    default_value = "1.0e-8"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Ke {
                    label = "Exciter gain Ke"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "5 - Exciter"
                }

                Kf {
                    label = "Stabilization feedback gain Kf"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "5 - Exciter"
                }

                Tf {
                    label = "Stabilization feedback time constant Tf"
                    widget = edit
                    type = generic
                    default_value = "2.0e-6"
                    unit = "s"
                    group = "5 - Exciter"
                }

                Vt0 {
                    label = "Initial terminal voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Vf0 {
                    label = "Initial field voltage"
                    widget = edit
                    type = generic
                    default_value = "0.0"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmax {
                    label = "Exciter saturation upper limit"
                    widget = edit
                    type = generic
                    default_value = "[\'inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                Efmin {
                    label = "Exciter saturation lower limit"
                    widget = edit
                    type = generic
                    default_value = "[\'-inf\']"
                    unit = "pu"
                    group = "5 - Exciter"
                }

                delta_f {
                    label = "Synch Check - accepted frequency difference"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                delta_phi {
                    label = "Synch Check - Accepted phase difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                phase_Kp {
                    label = "Synck Check - Phase PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "6 - Adv. 1"
                }

                phase_Ki {
                    label = "Synch Check - Phase PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.00012"
                    group = "6 - Adv. 1"
                }

                phase_upLim {
                    label = "Synch Check - Phase PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "6 - Adv. 1"
                }

                phase_lowLim {
                    label = "Synch Check - Phase PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-0.1"
                    group = "6 - Adv. 1"
                }

                phaseOff {
                    label = "Synch Check - Phase calibration"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "°"
                    group = "6 - Adv. 1"
                }

                dw_K {
                    label = "Synch Check - delta w gain"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    group = "6 - Adv. 1"
                }

                V_Kp {
                    label = "Synck Check - Voltage PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.0071"
                    group = "6 - Adv. 1"
                }

                V_Ki {
                    label = "Synck Check - Voltage PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.0354"
                    group = "6 - Adv. 1"
                }

                V_upLim {
                    label = "Synck Check - Voltage PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "6 - Adv. 1"
                }

                V_lowLim {
                    label = "Synck Check - Voltage PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-1"
                    group = "6 - Adv. 1"
                }

                delta_V {
                    label = "Synck Check - Accepted voltage difference"
                    widget = edit
                    type = generic
                    default_value = "1.0"
                    unit = "%"
                    group = "6 - Adv. 1"
                }

                w_sp_Kp {
                    label = "Frequency setpoint loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_Ki {
                    label = "Frequency setpoint loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.01"
                    group = "7 - Adv. 2"
                }

                w_sp_upLim {
                    label = "Frequency setpoint loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                w_sp_lowLim {
                    label = "Frequency setpoint loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu"
                    group = "7 - Adv. 2"
                }

                P_droop {
                    label = "Frequency setpoint loop - P droop"
                    widget = edit
                    type = generic
                    default_value = "2.7"
                    group = "7 - Adv. 2"
                }

                P_rise {
                    label = "Frequency setpoint loop - P rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                P_fall {
                    label = "Frequency setpoint loop - P falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_droop {
                    label = "Frequency setpoint loop - w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                w_rise {
                    label = "Frequency setpoint loop - w rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                w_fall {
                    label = "Frequency setpoint loop - w falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                gov_Kp {
                    label = "Governor - Proportional gain Kp"
                    widget = edit
                    type = generic
                    default_value = "0.5"
                    group = "7 - Adv. 2"
                }

                delta_wn {
                    label = "Governor - Accepted nominal speed difference"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    unit = "%"
                    group = "7 - Adv. 2"
                }

                inner_w_droop {
                    label = "Governor - inner w droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "7 - Adv. 2"
                }

                inner_w_rise {
                    label = "Governor - inner w rise"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                inner_w_fall {
                    label = "Governor - inner w fall"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "7 - Adv. 2"
                }

                pf_Kp {
                    label = "Power factor loop - PI - Kp"
                    widget = edit
                    type = generic
                    default_value = "0.05"
                    group = "8 - Adv. 3"
                }

                pf_Ki {
                    label = "Power factor loop - PI - Ki"
                    widget = edit
                    type = generic
                    default_value = "0.075"
                    group = "8 - Adv. 3"
                }

                pf_upLim {
                    label = "Power factor loop - PI - Upper limit"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_lowLim {
                    label = "Power factor loop - PI - Lower limit"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                pf_rise {
                    label = "Power factor loop - pf rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    group = "8 - Adv. 3"
                }

                pf_fall {
                    label = "Power factor loop - pf falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    group = "8 - Adv. 3"
                }

                exc_dwn {
                    label = "Exciter - start speed"
                    widget = edit
                    type = generic
                    default_value = "75"
                    unit = "%"
                    group = "8 - Adv. 3"
                }

                V_rise {
                    label = "Exciter - V rising rate"
                    widget = edit
                    type = generic
                    default_value = "10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_fall {
                    label = "Exciter - V falling rate"
                    widget = edit
                    type = generic
                    default_value = "-10"
                    unit = "pu/s"
                    group = "8 - Adv. 3"
                }

                V_inner_droop {
                    label = "Exciter - V inner droop"
                    widget = edit
                    type = generic
                    default_value = "0.1"
                    group = "8 - Adv. 3"
                }

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, 'diesel_genset.svg')
                ENDCODE

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                
                ENDCODE
            }
        }
        [
            position = 7432, 7640
            size = 354, 240
        ]

        junction Junction64 pe
        [
            position = 10104, 6848
        ]

        junction Junction65 pe
        [
            position = 10104, 6848
        ]

        junction Junction71 pe
        [
            position = 8640, 6480
        ]

        junction Junction72 pe
        [
            position = 8712, 6496
        ]

        junction Junction73 pe
        [
            position = 8744, 6480
        ]

        junction Junction74 pe
        [
            position = 8848, 6496
        ]

        junction Junction75 pe
        [
            position = 8936, 6512
        ]

        junction Junction66 pe
        [
            position = 10128, 7984
        ]

        junction Junction67 pe
        [
            position = 10128, 7984
        ]

        junction Junction68 pe
        [
            position = 10032, 7616
        ]

        junction Junction69 pe
        [
            position = 10128, 7632
        ]

        junction Junction70 pe
        [
            position = 10224, 7648
        ]

        junction Junction76 pe
        [
            position = 8736, 7624
        ]

        junction Junction78 pe
        [
            position = 10000, 6480
        ]

        junction Junction79 pe
        [
            position = 10104, 6496
        ]

        junction Junction80 pe
        [
            position = 10200, 6512
        ]

        junction Junction81 pe
        [
            position = 8760, 7624
        ]

        junction Junction83 pe
        [
            position = 8944, 7656
        ]

        junction Junction84 pe
        [
            position = 8824, 7640
        ]

        junction Junction85 pe
        [
            position = 8848, 7640
        ]

        connect "Transmission Line2.a_in" Tr3.sec_1 as Connection872
        connect Tr3.sec_2 "Transmission Line2.b_in" as Connection873
        connect "Transmission Line2.c_in" Tr3.sec_3 as Connection874
        connect gnd18.node "Transmission Line2.gnd" as Connection875
        connect gnd17.node "Transmission Line3.gnd" as Connection901
        connect "Transmission Line3.a_out" "Three-phase at load 7 (area 1).A+" as Connection1092
        connect "Three-phase at load 7 (area 1).B+" "Transmission Line3.b_out" as Connection1093
        connect "Transmission Line3.c_out" "Three-phase at load 7 (area 1).C+" as Connection1094
        connect "Three-phase at load 7 (area 1).GND" gnd24.node as Connection1098
        [
            breakpoints = 9704, 6736
        ]
        connect gnd26.node Junction64 as Connection1116
        connect Junction64 "Parallel RLC Branch1.P2_neg" as Connection1117
        connect "Parallel RLC Branch1.P1_neg" Junction65 as Connection1119
        connect Junction65 Junction64 as Connection1120
        connect "Parallel RLC Branch1.P3_neg" Junction65 as Connection1121
        connect Junction71 "Transmission Line2.a_out" as Connection1137
        connect Vabat6.p_node Junction71 as Connection1138
        connect "Transmission Line2.b_out" Junction72 as Connection1139
        connect Vabat6.n_node Junction72 as Connection1141
        connect DG_in.inputs Diesel_Gen1.Inputs as Connection1158
        connect gnd1.node "Voltage gen 1.GND" as Connection1159
        [
            breakpoints = 7728, 6640; 7728, 6640
        ]
        connect "Voltage gen 1.A+" Tr3.prm_1 as Connection1160
        connect "Voltage gen 1.B+" Tr3.prm_2 as Connection1161
        connect "Voltage gen 1.C+" Tr3.prm_3 as Connection1162
        connect Diesel_Gen1.A "Voltage gen 1.A-" as Connection1163
        connect "Voltage gen 1.B-" Diesel_Gen1.B as Connection1164
        connect Diesel_Gen1.C "Voltage gen 1.C-" as Connection1165
        connect DG_in1.inputs Diesel_Gen2.Inputs as Connection1166
        connect Junction71 Junction73 as Connection1174
        [
            breakpoints = 8640, 6480
        ]
        connect Junction73 "Transmission Line3.a_in" as Connection1175
        [
            breakpoints = 8728, 6480; 8728, 6480
        ]
        connect Tr4.sec_1 Junction73 as Connection1176
        connect Junction72 Junction74 as Connection1177
        [
            breakpoints = 8712, 6496; 8824, 6496; 8824, 6496
        ]
        connect Junction74 "Transmission Line3.b_in" as Connection1178
        [
            breakpoints = 9144, 6496
        ]
        connect Tr4.sec_2 Junction74 as Connection1179
        connect "Transmission Line2.c_out" Junction75 as Connection1180
        [
            breakpoints = 8912, 6512; 8920, 6512; 8920, 6512; 8920, 6512; 8920, 6512; 8912, 6512; 8920, 6512; 8920, 6512
        ]
        connect Junction75 "Transmission Line3.c_in" as Connection1181
        [
            breakpoints = 9176, 6512
        ]
        connect Tr4.sec_3 Junction75 as Connection1182
        connect "Voltage gen 2.A-" Tr4.prm_1 as Connection1183
        connect "Voltage gen 2.B-" Tr4.prm_2 as Connection1184
        [
            breakpoints = 8848, 6776
        ]
        connect "Voltage gen 2.C-" Tr4.prm_3 as Connection1185
        connect gnd27.node "Voltage gen 2.GND" as Connection1186
        [
            breakpoints = 9104, 6888; 8976, 6888
        ]
        connect "Voltage gen 2.A+" Diesel_Gen2.A as Connection1187
        connect Diesel_Gen2.B "Voltage gen 2.B+" as Connection1188
        connect "Voltage gen 2.C+" Diesel_Gen2.C as Connection1189
        connect gnd20.node "Transmission Line6.gnd" as Connection980
        connect gnd19.node "Transmission Line7.gnd" as Connection1005
        connect gnd22.node "Transmission Line9.gnd" as Connection1084
        connect "Three-phase at load 9 (area 2).GND" gnd25.node as Connection1099
        [
            breakpoints = 9688, 7872
        ]
        connect "Transmission Line6.a_out" "Three-phase at load 9 (area 2).A+" as Connection1100
        connect "Three-phase at load 9 (area 2).B+" "Transmission Line6.b_out" as Connection1101
        [
            breakpoints = 9640, 7640; 9472, 7640
        ]
        connect "Transmission Line6.c_out" "Three-phase at load 9 (area 2).C+" as Connection1102
        connect gnd29.node Junction66 as Connection1122
        connect Junction66 "Parallel RLC Branch2.P2_neg" as Connection1123
        connect "Parallel RLC Branch2.P1_neg" Junction67 as Connection1124
        connect Junction67 Junction66 as Connection1125
        connect "Parallel RLC Branch2.P3_neg" Junction67 as Connection1126
        connect "Transmission Line9.a_in" Junction68 as Connection1127
        connect Junction68 "Three-phase at load 9 (area 2).A-" as Connection1128
        connect "Parallel RLC Branch2.P3_pos" Junction68 as Connection1129
        connect "Three-phase at load 9 (area 2).B-" Junction69 as Connection1130
        connect Junction69 "Transmission Line9.b_in" as Connection1131
        connect "Parallel RLC Branch2.P2_pos" Junction69 as Connection1132
        connect "Three-phase at load 9 (area 2).C-" Junction70 as Connection1133
        [
            breakpoints = 9736, 7728; 9736, 7648
        ]
        connect Junction70 "Transmission Line9.c_in" as Connection1134
        connect "Parallel RLC Branch2.P1_pos" Junction70 as Connection1135
        connect "Transmission Line7.a_out" Junction76 as Connection1142
        [
            breakpoints = 8664, 7624
        ]
        connect Vabat10.p_node Junction76 as Connection1144
        connect "Three-phase at load 8 (mid).GND" gnd23.node as Connection1148
        connect gnd30.node "Transmission Line10.gnd" as Connection1190
        connect "Three-phase at load 7 (area 1).A-" Junction78 as Connection1191
        [
            breakpoints = 9752, 6400; 9752, 6480
        ]
        connect Junction78 "Parallel RLC Branch1.P3_pos" as Connection1192
        [
            breakpoints = 10008, 6480
        ]
        connect "Transmission Line10.a_in" Junction78 as Connection1193
        connect "Parallel RLC Branch1.P2_pos" Junction79 as Connection1194
        connect Junction79 "Three-phase at load 7 (area 1).B-" as Connection1195
        [
            breakpoints = 10104, 6496
        ]
        connect "Transmission Line10.b_in" Junction79 as Connection1196
        connect "Parallel RLC Branch1.P1_pos" Junction80 as Connection1197
        connect Junction80 "Three-phase at load 7 (area 1).C-" as Connection1198
        [
            breakpoints = 10200, 6512; 9760, 6512; 9760, 6592; 9736, 6488; 9736, 6488
        ]
        connect "Transmission Line10.c_in" Junction80 as Connection1199
        connect "Three-phase at load 8 (mid).A+" "Transmission Line10.a_out" as Connection1200
        connect "Three-phase at load 8 (mid).A-" "Transmission Line9.a_out" as Connection1201
        connect "Three-phase at load 8 (mid).B-" "Transmission Line9.b_out" as Connection1202
        connect "Three-phase at load 8 (mid).C-" "Transmission Line9.c_out" as Connection1203
        connect "Three-phase at load 8 (mid).C+" "Transmission Line10.c_out" as Connection1204
        connect "Transmission Line10.b_out" "Three-phase at load 8 (mid).B+" as Connection1205
        connect gnd31.node "Voltage gen 3.GND" as Connection1210
        [
            breakpoints = 7752, 7784; 7752, 7784
        ]
        connect "Voltage gen 3.A+" Tr5.prm_1 as Connection1211
        connect "Voltage gen 3.B+" Tr5.prm_2 as Connection1212
        connect "Voltage gen 3.C+" Tr5.prm_3 as Connection1213
        connect Tr5.sec_1 "Transmission Line7.a_in" as Connection1217
        connect Tr5.sec_2 "Transmission Line7.b_in" as Connection1218
        connect Tr5.sec_3 "Transmission Line7.c_in" as Connection1219
        connect DG_in3.inputs Diesel_Gen4.Inputs as Connection1220
        connect "Voltage gen 4.A-" Tr6.prm_1 as Connection1221
        connect "Voltage gen 4.B-" Tr6.prm_2 as Connection1222
        [
            breakpoints = 8856, 7880
        ]
        connect "Voltage gen 4.C-" Tr6.prm_3 as Connection1223
        connect gnd32.node "Voltage gen 4.GND" as Connection1224
        [
            breakpoints = 9112, 7992; 8984, 7992
        ]
        connect "Voltage gen 4.A+" Diesel_Gen4.A as Connection1225
        connect Diesel_Gen4.B "Voltage gen 4.B+" as Connection1226
        connect "Voltage gen 4.C+" Diesel_Gen4.C as Connection1227
        connect Junction76 Junction81 as Connection1228
        [
            breakpoints = 8736, 7624
        ]
        connect Junction81 "Transmission Line6.a_in" as Connection1229
        [
            breakpoints = 8760, 7624; 8760, 7624; 9136, 7624
        ]
        connect Tr6.sec_1 Junction81 as Connection1230
        connect "Transmission Line6.c_in" Junction83 as Connection1234
        [
            breakpoints = 9176, 7656; 8952, 7656; 8952, 7656; 8952, 7656; 8952, 7656; 8952, 7656; 8952, 7656
        ]
        connect Tr6.sec_3 Junction83 as Connection1236
        connect "Transmission Line7.c_out" Junction83 as Connection1237
        [
            breakpoints = 8848, 7656; 8616, 7656
        ]
        connect Vabat10.n_node Junction84 as Connection1243
        connect Junction84 "Transmission Line7.b_out" as Connection1244
        [
            breakpoints = 8792, 7640; 8640, 7640
        ]
        connect Tr6.sec_2 Junction85 as Connection1246
        connect Junction85 Junction84 as Connection1247
        connect "Transmission Line6.b_in" Junction85 as Connection1248
        [
            breakpoints = 9184, 7640; 8848, 7640
        ]
        connect DG_in4.inputs Diesel_Gen3.Inputs as Connection1252
        connect Diesel_Gen3.A "Voltage gen 3.A-" as Connection1253
        connect Diesel_Gen3.B "Voltage gen 3.B-" as Connection1254
        connect Diesel_Gen3.C "Voltage gen 3.C-" as Connection1255
    }

    default {
        "core/Abs" {
            execution_rate = "inherit"
        }

        "core/Bus Join" {
            inputs = "2"
            execution_rate = "inherit"
        }

        "core/Bus Split" {
            outputs = "2"
            execution_rate = "inherit"
        }

        "core/C function" {
            input_terminals = "real in;"
            input_terminals_show_labels = "False;"
            input_terminals_feedthrough = "True;"
            input_terminals_dimensions = "inherit;"
            output_terminals = "real out;"
            output_terminals_show_labels = "False;"
            output_terminals_feedthrough = "True;"
            output_terminals_dimensions = "inherit;"
            output_fnc = ""
            update_fnc = ""
            init_fnc = ""
            global_variables = ""
            parameters = ""
            execution_rate = "inherit"
        }

        "core/Comparator" {
            execution_rate = "inherit"
        }

        "core/Constant" {
            value = "1"
            signal_type = "real"
            execution_rate = "100e-6"
            _tunable = "False"
        }

        "core/Digital Probe" {
            signal_access = "inherit"
            override_signal_name = "False"
            signal_name = ""
            streaming_en = "False"
            addr = "0"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        "core/Discrete Transfer Function" {
            domain = "Z-domain"
            method = "Zero-order hold"
            b_coeff = "[1,1]"
            a_coeff = "[1,1]"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        "core/Gain" {
            gain = "1"
            multiplication = "Element-wise(K.*u)"
            _tunable = "False"
            execution_rate = "inherit"
        }

        "core/Integrator" {
            show_reset = "none"
            reset_type = "asynchronous"
            show_init_condition = "internal"
            init_value = "0"
            limit_output = "False"
            limit_upper = "inf"
            limit_lower = "-inf"
            show_state = "False"
            state_port_type = "inherit"
            execution_rate = "inherit"
        }

        "core/Limit" {
            upper_limit = "[\'inf\']"
            lower_limit = "[\'-inf\']"
            execution_rate = "inherit"
        }

        "core/Logical operator" {
            operator = "AND"
            inputs = "2"
            execution_rate = "inherit"
        }

        "core/Power Meter" {
            filter_order = "first order"
            filter_cutoff_Hz = "30"
            initial_filter_input = "0"
            initial_filter_output = "0"
            enable_inst_ports = "True"
            enable_zero_ports = "False"
            execution_rate = "inherit"
        }

        "core/Probe" {
            signal_access = "inherit"
            addr = "0"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "generic"
            streaming_en = "False"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        "core/Product" {
            signs = "2"
            execution_rate = "inherit"
        }

        "core/Rate Limiter" {
            rising_limit = "1"
            falling_limit = "-1"
            execution_rate = "inherit"
        }

        "core/Relational operator" {
            relational_op = "=="
            execution_rate = "inherit"
        }

        "core/Resistor" {
            resistance = "1"
            param_set = ""
        }

        "core/Round" {
            round_fn = "floor"
            execution_rate = "inherit"
        }

        "core/SCADA Input" {
            addr = "0"
            format = "real"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "real"
            min = "-1e6"
            max = "1e6"
            def_value = "0"
            unit = " "
            execution_rate = "100e-6"
        }

        "core/SR Flip Flop" {
            init_value = "0"
            execution_rate = "inherit"
        }

        "core/Signal switch" {
            criterion = "ctrl > threshold"
            threshold = "0.5"
            execution_rate = "inherit"
        }

        "core/Sum" {
            signs = "2"
            execution_rate = "inherit"
        }

        "core/Termination" {
            execution_rate = "inherit"
        }

        "core/Transport Delay" {
            time_delay = "0.1"
            init_value = "0"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        "core/Unit Delay" {
            init_value = "0"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        "core/abc to alpha beta" {
            power_form = "variant - Clarke\'s original"
            execution_rate = "inherit"
        }

        "core/alpha beta to dq" {
            alignment = "-pi/2"
            execution_rate = "inherit"
        }

        "core/Counter" {
            ext_reset = "level"
            init_val = "0"
            state_type = "real"
            execution_rate = "inherit"
        }

        "core/Current Measurement" {
            signal_access = "inherit"
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "core/Edge Detection" {
            edge = "both"
            execution_rate = "inherit"
        }

        "core/Parallel RLC Branch" {
            num_phases = "Three-Phase"
            branch_type = "RLC"
            resistance = "10"
            inductance = "10e-3"
            initial_current = "0"
            capacitance = "10e-6"
            initial_voltage = "0"
        }

        "core/Signal Controlled Voltage Source" {
            execution_rate = "inherit"
        }

        "core/Three Phase Two Winding Transformer" {
            input = "SC and OC tests"
            Sn = "160000.0"
            f = "50.0"
            V1 = "10000.0"
            V2 = "400.0"
            usc1 = "4.0"
            Psc1 = "2350.0"
            R1 = "4.58984375"
            L1 = ".0370093710364"
            R2 = ".00734375"
            L2 = "5.92149936583e-05"
            r1 = ".00734375"
            l1 = ".0186029389059"
            r2 = ".00734375"
            l2 = ".0186029389059"
            core_model = "Linear"
            ioc1 = "0.7"
            Poc1 = "460.0"
            Rm = "217391.304348"
            Lm = "311.709196788"
            flux_vals_SI = "[0, 1910.3, 2419.7]"
            current_vals_SI = "[0, 0.66653, 277.72]"
            rm = "347.826086957"
            lm = "156.68213163"
            flux_vals_pu = "[0, 1.2, 1.52]"
            current_vals_pu = "[0, 0.0024, 1]"
            flux_vals_SCOC = "[0, 1.2, 1.52]"
            current_vals_SCOC = "[0, 0.0024, 1]"
            upper_flux_vals_pu = "[0.2, 1.2, 1.52]"
            upper_flux_vals_SI = "[318.33, 1910.3, 2419.7]"
            upper_flux_vals_SCOC = "[0.2, 1.2, 1.52]"
            hysteresis_number = "1"
            execution_rate = "100e-6"
            import_from_SI2SCOC = "Import from SI"
            import_from_pu2SCOC = "Import from PU"
            import_from_SCOC2SI = "Import from SC OC"
            import_from_pu2SI = "Import from PU"
            import_from_SCOC2pu = "Import from SC OC"
            import_from_SI2pu = "Import from SI"
            preview_flux_current = "Preview SI"
            winding_1_connection = "Y"
            winding_2_connection = "Y"
            clock_number = "0"
            embedded_cpl = "None"
            coupling_type = "core"
            ratio_type = "Automatic"
            ratio = "0.1"
            Rshunt = "inf"
        }

        "core/Three Phase Wound Rotor Synchronous Machine" {
            signal_access = "inherit"
            model_type = "linear"
            rated_speed = "1.0"
            double_q_windings = "1 damper winding on q axis"
            Rs = "1.62"
            Lls = "0.004527"
            Lmd = "0.1086"
            Lmq = "0.1086"
            curve_type = "no load curve"
            if_vector = "[0.0, 0.0]"
            vs_vector = "[0.0, 0.0]"
            imd_vector = "[0.0, 0.0]"
            imq_vector = "[0.0, 0.0]"
            psimd_table = "[[0.0, 0.0], [0.0, 0.0]]"
            psimq_table = "[[0.0, 0.0], [0.0, 0.0]]"
            Rf = "1.208"
            Llfd = "0.01132"
            Rkd = "3.142"
            Rkq = "4.772"
            Rkq2 = "1e5"
            Llkd = "0.007334"
            Llkq = "0.01015"
            Llkq2 = "1e-11"
            Ns_div_Nfd = "1.0"
            Ns_div_Nkd = "1.0"
            Ns_div_Nkq = "1.0"
            Lc = "0"
            visualize_luts = "Visualize Lookup Tables"
            pms = "2"
            star_delta = "star"
            Jm = "0.0923"
            friction_coeff = "0"
            unconstrained_angle = "disabled"
            load_src = "SCADA / external"
            ext_mdl_load_type = "torque"
            load_ai_pin_addr = "1"
            load_ai_offset = "0"
            load_ai_gain = "1"
            enc_ppr = "1024"
            encoder_Z_pulse_length = "Full period"
            res_pole_pairs = "1"
            res_carr_source = "internal"
            res_carr_source_external = "single ended"
            res_int_carr_f = "5e+3"
            res_ai_pin_addr = "1"
            res_ai_pin2_addr = "2"
            res_ai_offset = "0"
            res_ai_gain = "1"
            absenc_type = "None"
            endat_clock_di_addr = "1"
            endat_clock_di_logic = "active high"
            endat_data_di_addr = "2"
            endat_data_di_logic = "active high"
            biss_clock_di_addr = "1"
            biss_clock_di_logic = "active high"
            biss_data_di_addr = "2"
            ssi_clock_di_addr = "1"
            ssi_clock_di_logic = "active high"
            ssi_data_di_addr = "2"
            theta_ab = "-pi/2"
            field_input = "voltage"
            Rsnb_rotor = "inf"
            Rsnb_stator = "inf"
            execution_rate = "100e-6"
            el_trq_out = "False"
            mech_speed_out = "False"
            mech_angle_out = "False"
            i_als = "False"
            i_bes = "False"
            i_ds = "False"
            i_qs = "False"
            psi_als = "False"
            psi_bes = "False"
            psi_ds = "False"
            psi_qs = "False"
            machine_id = "0"
            me_speed_out_addr = "0"
            el_torque_out_addr = "0"
            me_angle_out_addr = "0"
        }

        "core/Three-phase Meter" {
            R = "1e5"
            n_cycles = "1"
            Ts = "100e-6"
            enable_probes = "True"
            enable_out = "True"
            remove_snubber = "False"
            enable_bandwidth = "False"
            bandwidth = "10e3"
            VAn = "True"
            VBn = "True"
            VCn = "True"
            VAB = "False"
            VBC = "False"
            VCA = "False"
            VN = "False"
            IA = "True"
            IB = "True"
            IC = "True"
            IN = "False"
            freq = "False"
            VLn_rms = "False"
            VLL_rms = "False"
            VLn_avg_rms = "False"
            VLL_avg_rms = "False"
            VN_rms = "False"
            I_rms = "False"
            I_avg_rms = "False"
            IN_rms = "False"
            P_method = "alpha-beta"
            enable_extra_out = "False"
            P_meas = "False"
        }

        "core/Transmission Line" {
            model = "RL coupled"
            num_of_phases = "3"
            model_def = "Geometry"
            unit_sys = "imperial"
            unit_sys_edited_flag = "0"
            Length_metric = "100.0"
            Length_miles = "62.1371"
            Frequency = "60.0"
            Earth_resistivity = "100"
            X_axis_1_metric = "-1.0668"
            Y_axis_1_metric = "8.5344"
            GMR_1_metric = "0.00743712"
            RD_1_metric = "0.009156192"
            Rs_1_metric = "0.19013958482462417"
            X_axis_1_imperial = "-3.5"
            Y_axis_1_imperial = "28.0"
            GMR_1_imperial = "0.0244"
            RD_1_imperial = "0.03004"
            Rs_1_imperial = "0.306"
            X_axis_2_metric = "-0.3048"
            Y_axis_2_metric = "8.5344"
            GMR_2_metric = "0.00743712"
            RD_2_metric = "0.009156192"
            Rs_2_metric = "0.19013958482462417"
            X_axis_2_imperial = "-1.0"
            Y_axis_2_imperial = "28.0"
            GMR_2_imperial = "0.0244"
            RD_2_imperial = "0.03004"
            Rs_2_imperial = "0.306"
            X_axis_3_metric = "1.0668"
            Y_axis_3_metric = "8.5344"
            GMR_3_metric = "0.00743712"
            RD_3_metric = "0.009156192"
            Rs_3_metric = "0.19013958482462417"
            X_axis_3_imperial = "3.5"
            Y_axis_3_imperial = "28.0"
            GMR_3_imperial = "0.0244"
            RD_3_imperial = "0.03004"
            Rs_3_imperial = "0.306"
            X_axis_4_metric = "0.1524"
            Y_axis_4_metric = "7.3152"
            GMR_4_metric = "0.00248"
            RD_4_metric = "0.00714"
            Rs_4_metric = "0.3678"
            X_axis_4_imperial = "0.5"
            Y_axis_4_imperial = "24.0"
            GMR_4_imperial = "0.00814"
            RD_4_imperial = "0.02345"
            Rs_4_imperial = "0.592"
            R_metric = "[[0.2481, 0.0579, 0.0579], [0.0579, 0.2481, 0.0579], [0.0579, 0.0579, 0.2481]]"
            R_imperial = "[[0.4, 0.093, 0.093], [0.093, 0.4, 0.093], [0.093, 0.093, 0.4]]"
            L_metric = "[[0.00233, 0.00140, 0.00140], [0.00140, 0.00233, 0.00140], [0.00140, 0.00140, 0.00233]]"
            L_imperial = "[[0.00374, 0.0022, 0.0022], [0.0022, 0.00374, 0.0022], [0.0022, 0.0022, 0.00374]]"
            C_metric = "[[8.546e-9, 0, 0], [0, 8.546e-9, 0], [0, 0, 8.546e-9]]"
            C_imperial = "[[1.471e-8, 0, 0], [0, 1.530e-8, 0], [0, 0, 1.375e-8]]"
            R_sequence_metric = "[[0.3864, 0, 0],[0, 0.01273, 0], [0, 0, 0.01273]]"
            L_sequence_metric = "[[4.1264e-3, 0, 0],[0, 0.9337e-3, 0], [0, 0, 0.9337e-3]]"
            C_sequence_metric = "[[7.751e-9, 0, 0],[0, 12.74e-9, 0], [0, 0, 12.74e-9]]"
            R_sequence_imperial = "[[0.6218, 0, 0],[0, 0.0204, 0], [0, 0, 0.0204]]"
            L_sequence_imperial = "[[0.00664, 0, 0],[0, 0.00150, 0], [0, 0, 0.00150]]"
            C_sequence_imperial = "[[1.247e-8, 0, 0],[0, 2.0503e-8, 0], [0, 0, 2.0503e-8]]"
            import_from_geometry = "Import from Geometry"
            import_from_RLC = "Import from RLC"
        }

        "core/Triple Pole Single Throw Contactor" {
            signal_access = "inherit"
            ctrl_src = "Digital input"
            Sa = "1"
            Sa_logic = "active high"
            enable_fb_out = "False"
            fb_out_type = "real"
            execution_rate = "inherit"
            initial_state = "off"
            on_delay = "0"
            off_delay = "0"
        }

        "core/Voltage Measurement" {
            signal_access = "inherit"
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }
    }

    CODE model_init
        # Numpy module is imported as 'np'
        # Scipy module is imported as 'sp'
        Ts=200e-6
        
        # Node components parametrization
        Rd=0.5719
        Rnd=0.5190
        Ld=2.969e-3
        Lnd=1.56567e-3
        Cd=7.5995e-9
        Cnd=0
        
        L_fil2=4.4e-3
        C_fil2=4.4e-6
        L_fil1=2.2e-3
        C_fil1=2.2e-6
    ENDCODE
}
